<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Google Data APIs (Beta) Developer's Guide - Authentication Overview</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="../css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="css/local_extensions.css" />
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../css/ieonly.css" />
<![endif]-->
<style type="text/css">
<!--
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
 	color: #000000;
}
-->
</style>
</head>
<body id="auth_page">
<a name="top"></a>
<!-- ########## PAGE HEADER ########## -->
<div id="header">
  <div id="logo"><a href="http://code.google.com/"><img src="http://code.google.com/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Google Data APIs (Beta) Developer's Guide</h1>
</div>
<!-- ########## END PAGE HEADER ########## -->
<div id="wrapper">
  <!-- ########## SIDE NAVIGATION ########## -->
  


  
  
  
  
  
  
  
  
  
  


<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
  _uacct = "UA-18071-1";
  urchinTracker();
</script>

<div id="sidenav">
  <ul>
    <li>
      <h1>GData documentation</h1>
      <ul>
        <!-- ID tag identifies current page -->
        <li><a href="index.html" id="index_link">Main</a></li>
        <li><a href="overview.html" id="overview_link">Overview</a></li>
        <li><a href="basics.html" id="basics_link">Protocol Basics</a></li>
        <li><a href="reference.html" id="reference_link">Protocol Reference</a></li>
        <li><a href="auth.html" id="auth_link">Authentication</a></li>
        <li><a href="elements.html" id="elements_link">Common Elements</a></li>
        <li><a href="clientlibs.html" id="clientlibs_link">Client Libraries</a></li>
        <li><a href="batch.html" id="batch_link">Batch Processing</a></li>
        <li><a href="samples.html" id="samples_link">Samples</a></li>
      </ul>
    </li>
    <li>
      <h1>Service-specific documents</h1>
      <ul>
	
        <li><a href="http://code.google.com/apis/base/">Base Data API</a></li>
	
	
        <li><a href="../blogger/overview.html" id="blogger_link">Blogger Data API</a></li>
	
        <li><a href="../calendar/overview.html" id="calendar_link">Calendar Data API</a></li>
        <li><a href="../codesearch/overview.html" id="codesearch_link">Code Search Data API</a></li>
	
	<li><a href="http://code.google.com/apis/apps/gdata_provisioning_api_v2.0_reference.html">Google Apps Provisioning API</a></li>
	
	
        <li><a href="../notebook/overview.html" id="notebook_link">Notebook Data API</a></li>
	
        <li><a href="../spreadsheets/overview.html" id="spreadsheets_link">Spreadsheets Data API</a></li>
        <li><a href="../picasaweb/overview.html" id="picasaweb_link">Picasa Web Albums Data API</a></li>
      </ul>
    </li>
    <li>
      <h1>Related links</h1>
      <ul><li><a href="http://groups.google.com/group/google-help-dataapi">Discussion Group</a></li>
        <li><a href="http://googledataapis.blogspot.com/">GData Blog</a></li>
      </ul>
    </li>
  </ul>
</div>

  <!-- ########## END SIDE NAVIGATION ########## -->
  <!-- ########## PAGE CONTENT ########## -->
  <div id="pagecontent">
    <h1 id="page_title">Google Data APIs Authentication Overview</h1> 
    <p>In most contexts, your client app will act on behalf of a particular user of a Google service. The user provides their username and password, either to your client or to the Google service; the service returns an authentication token that your client can then send to the service along with every subsequent request on behalf of that user. </p>
    <p>GData uses two different authentication systems, depending on what kind of client you're writing. If your client is a standalone single-user &quot;installed&quot; client (such as a desktop application), then you should use the &quot;ClientLogin&quot; system; if your client is a multi-user web application client, then you should use the &quot;AuthSub&quot; system.</p>
    <p>For detailed information about both kinds of authentication, see the full <a href="http://code.google.com/apis/accounts/Authentication.html">Google Account Authentication</a> documentation.</p>
    <p>Whichever authentication method you choose, you can either send raw HTTP requests or have the <a href="clientlibs.html">GData client libraries</a> handle the authentication for you.</p>
    <h1>Single-user clients: ClientLogin</h1>
    <p>To authenticate a user using ClientLogin, your client first needs to ask the user for their username and password.</p>
    <p>The client  should then send a <code>POST</code> request to the
      following URL:</p>
    <pre>https://www.google.com/accounts/ClientLogin</pre>
    <p>Include the relevant parameters in the body of the <code>POST</code> request, as described in the <a
    href="http://code.google.com/apis/accounts/AuthForInstalledApps.html">ClientLogin
      documentation</a>, including the username and password. Use the appropriate service name, as provided in the service-specific GData documentation. </p>
    <p>If the request succeeds, then the response contains an alphanumeric string labeled <code>Auth</code>. </p>
    <p>After a successful authentication request, use the <code>Auth</code> value to create an Authorization header for each GData request:</p>
    <pre>Authorization: GoogleLogin auth=<i>yourAuthValue</i></pre>
    <p>If a ClientLogin-authenticated GData request fails, you may receive any of a variety of HTTP error status codes in response. In particular, if the problem is with the account itself (rather than the authentication token as such), you'll receive one of the following errors:</p>
    <ul>
      <li> <code>403 Account disabled</code></li>
      <li><code>403 Account deleted</code></li>
    </ul>
    <p>If the problem is with the authentication token, you'll receive one of the following errors:</p>
    <ul>
      <li> <code>401 Token disabled</code></li>
      <li><code>401 Token expired</code></li>
    </ul>
    <p>Error responses may also include a WWW-Authenticate header, such as the following:</p>
    <pre>WWW-Authenticate: GoogleLogin realm=&quot;https://www.google.com/accounts/ClientLogin&quot;,
  service=&quot;cl&quot; </pre>
    <p>That header provides information about how and where to authenticate correctly. </p>
    <p>As an alternative to working with the raw HTTP and XML, you can interact
      with a Google service using a client library. If you're using the Java client library, for example, 
    you create a Service object of the appropriate class (such as <a
    href="../../java/doc/com/google/gdata/client/spreadsheets/SpreadsheetsService.html"><code>SpreadsheetService</code></a> for Google Spreadsheets), then provide the user's credentials to the Service object:</p>
    <pre>SpreadsheetService myService = new SpreadsheetService(&quot;exampleCo-exampleApp-1&quot;);
myService.setUserCredentials(&quot;fitz@gmail.com&quot;, &quot;mypassword&quot;);</pre>
    <p>From then on, the client library automatically supplies the authentication token with every request your client sends. </p>
    <h1>Web-app clients: AuthSub </h1>
<p>The AuthSub interface allows a web-based application to access a Google service on behalf of a user. To maintain a high level of security, the  AuthSub interface enables the application to get an authentication token without ever handling the user's account login information.</p>
    <p>To acquire an AuthSub token for a given  user of a Google service, your
    web app must redirect the user to the AuthSubRequest URL at Google; the URL should include a next query parameter that specifies a URL on your site for AuthSub to redirect back to after login.</p>
    <p>The AuthSub system prompts
      the user to log into their Google account. After the user logs in, the AuthSub system redirects them to the URL you
      specified in the <code>next</code> query parameter of the AuthSubRequest
      URL. The AuthSub system appends an authentication token to the <code>next</code> URL, as the
      value of the <code>token</code> query parameter. Your application then uses
      that authentication token in subsequent interactions with the service.</p>
    <p>For details, including information on registering your application with
      Google and on exchanging a one-time token for a session token, see the <a
    href="http://code.google.com/apis/accounts/AuthForWebApps.html">AuthSub
        documentation</a>.</p>
    <p>After you've acquired an  authentication token, you use that token to create an Authorization header for each request: </p>
    <pre>Authorization: AuthSub token=&quot;<i>yourAuthToken</i>&quot;</pre>
    <p>If an AuthSub-authenticated GData request fails, you may receive any of a variety of HTTP error status codes in response. In particular, if there's a problem  with the authentication token, you'll receive one of the following <code>401</code> errors:</p>
    <ul>
      <li><code>Token invalid</code></li>
      <li><code>Token disabled</code></li>
      <li><code>Token expired</code></li>
      <li><code>Token revoked</code></li>
    </ul>
    <p>Error responses may also include a WWW-Authenticate header, such as the following:</p>
    <pre>WWW-Authenticate: AuthSub realm=&quot;https://www.google.com/accounts/AuthSubRequest&quot;</pre>
    <p>That header provides information about how and where to authenticate correctly. </p>
    <p>The GData client libraries provide methods to help you use AuthSub in your web application. Specifically, there are methods for constructing the request URL, acquiring a single-use authentication token, exchanging the single-use token for a session token, and signing the request.</p>
    <p>Begin by following the instructions in the <a href="../gdata/authsub.html">AuthSub and GData client library documentation</a> to acquire a session token, using the <code>getRequestURL</code>, <code>getTokenFromReply</code>, <code>exchangeForSessionToken</code>, and <code>setAuthSubToken</code> methods. Each service's GData documentation provides the appropriate scope string to use. </p>
    <p>After you have called the <code>SpreadsheetService</code> object's <a
    href="../../java/doc/com/google/gdata/client/GoogleService.html#setAuthSubToken(java.lang.String)"><code>setAuthSubToken</code></a> method, the client library sends the token with every request, so you don't
      need to do anything further with the token.</p>
    <p>The following Java code, for example, shows how to set up the <code>SpreadsheetService</code> object after you have acquired a session token:</p>
    <pre>SpreadsheetService myService = new SpreadsheetService(&quot;exampleCo-exampleApp-1&quot;);
myService.setAuthSubToken(sessionToken);</pre>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <p class="backtotop"><a href="#top">Back to top</a></p>
  </div>
  <!-- ########## END PAGE CONTENT ########## -->
</div>
<!-- end wrapper -->
<!-- ########## PAGE FOOTER ########## -->
<div id="footer">
  <div id="footerlogo"><img src="http://www.google.com/images/art.gif" alt="" /></div>
  <div id="copyright">
    <p>&copy; Google Inc. 2007 - <a href="http://www.google.com/privacy.html">Privacy Policy</a> - <a href="http://www.google.com/terms_of_service.html">Terms and Conditions</a> - <a href="http://www.google.com/about.html">About Google</a></p>
  </div>
  <!-- end copyright -->
</div>
<!-- ########## END PAGE FOOTER ########## -->
<p id="date">Last modified:
<script type="text/javascript">
  <!--
  var lm = new Date(document.lastModified);
  document.write(lm.toDateString());
  //-->
</script>
</p>
</body>
</html>
