<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Google Data APIs (Beta) Developer's Guide - Using the Java Client Library</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="../css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="css/local_extensions.css" />
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../css/ieonly.css" />
<![endif]-->
<style type="text/css">
<!--
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
 	color: #000000;
}
-->
</style>
</head>
<body id="java_page">
<a name="top"></a>
<!-- ########## PAGE HEADER ########## -->
<div id="header">
  <div id="logo"><a href="http://code.google.com/"><img src="http://code.google.com/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Google Data APIs (Beta) Developer's Guide</h1>
</div>
<!-- ########## END PAGE HEADER ########## -->
<div id="wrapper">
  <!-- ########## SIDE NAVIGATION ########## -->
  


  
  
  
  
  
  
  
  
  
  


<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
  _uacct = "UA-18071-1";
  urchinTracker();
</script>

<div id="sidenav">
  <ul>
    <li>
      <h1>GData documentation</h1>
      <ul>
        <!-- ID tag identifies current page -->
        <li><a href="index.html" id="index_link">Main</a></li>
        <li><a href="overview.html" id="overview_link">Overview</a></li>
        <li><a href="basics.html" id="basics_link">Protocol Basics</a></li>
        <li><a href="reference.html" id="reference_link">Protocol Reference</a></li>
        <li><a href="auth.html" id="auth_link">Authentication</a></li>
        <li><a href="elements.html" id="elements_link">Common Elements</a></li>
        <li><a href="clientlibs.html" id="clientlibs_link">Client Libraries</a></li>
        <li><a href="batch.html" id="batch_link">Batch Processing</a></li>
        <li><a href="samples.html" id="samples_link">Samples</a></li>
      </ul>
    </li>
    <li>
      <h1>Service-specific documents</h1>
      <ul>
	
        <li><a href="http://code.google.com/apis/base/">Base Data API</a></li>
	
	
        <li><a href="../blogger/overview.html" id="blogger_link">Blogger Data API</a></li>
	
        <li><a href="../calendar/overview.html" id="calendar_link">Calendar Data API</a></li>
        <li><a href="../codesearch/overview.html" id="codesearch_link">Code Search Data API</a></li>
	
	<li><a href="http://code.google.com/apis/apps/gdata_provisioning_api_v2.0_reference.html">Google Apps Provisioning API</a></li>
	
	
        <li><a href="../notebook/overview.html" id="notebook_link">Notebook Data API</a></li>
	
        <li><a href="../spreadsheets/overview.html" id="spreadsheets_link">Spreadsheets Data API</a></li>
        <li><a href="../picasaweb/overview.html" id="picasaweb_link">Picasa Web Albums Data API</a></li>
      </ul>
    </li>
    <li>
      <h1>Related links</h1>
      <ul><li><a href="http://groups.google.com/group/google-help-dataapi">Discussion Group</a></li>
        <li><a href="http://googledataapis.blogspot.com/">GData Blog</a></li>
      </ul>
    </li>
  </ul>
</div>

  <!-- ########## END SIDE NAVIGATION ########## -->
  <!-- ########## PAGE CONTENT ########## -->
  <div id="pagecontent">
    <h1 id="page_title">Using the Java Client Library</h1> 
    <p>This document describes how to use the Java client library to send Google data API (&quot;GData&quot;) queries and interpret returned responses.</p> 
    <p>Google provides a set of client libraries for interacting with GData-enabled services, in a variety of programming languages. Using these libraries, you can construct GData requests, send them to a service, and receive responses.</p> 
    <p>This document provides a set of examples of common uses of the Java version of the client library, followed by other information about writing GData clients. At the end of this document is a link to the reference documentation for the Java client library, in Javadoc format.</p>
    <p>To use this client library, you must be running Java 1.5.</p>
    <p><a href="http://code.google.com/p/gdata-java-client/downloads/list" onclick="javascript:urchinTracker ('download/javapackage');">Download the Java client library.</a></p>
    <h1>Contents</h1> 
    <div class="toc">
    <ol>
      <li><a href="#Audience">Audience</a></li> 
      <li><a href="#Model">Data model overview</a></li> 
      <li><a href="#Tutorial">Tutorial and examples</a></li> 
      <li><a href="#Reference">Reference</a></li> 
    </ol> 
    </div>
    <h1><a name="Audience" id="Audience">Audience</a></h1> 
    <p>This document is intended for Java programmers who want to write client applications that can interact with GData services.</p> 
    <p>This document assumes that you understand the general ideas behind the <a href="basics.html">Google data APIs protocol</a>. It also assumes that you know how to program in Java.</p> 
    <h1><a name="Model" id="Model">Data model overview</a></h1> 
    <p>The Java client library provides a set of classes that correspond to the elements and data types used by the Google data APIs. For example, there's a Feed class, which corresponds to the <code>&lt;atom:feed&gt;</code> element; it has methods for creating an entry, getting and setting the values of various sub-elements, and so on. There's also an Entry class, which corresponds to the <code>&lt;atom:entry&gt;</code> element. Not every element defined in the Google data APIs has its own class; for details, see the <a href="../../java/doc/index.html">reference documentation</a>.</p> 
    <p>The library can automatically parse Atom content and put the values of the Atom elements into appropriate objects. For example, the <code>getFeed</code> method gets a feed, parses it, and returns a Feed object with the resulting values.</p> 
    <p>To send a feed or entry to a service, you create a Feed or Entry object, then call a library method (such as the <code>insert</code> method) to automatically translate the object into XML and send it.</p> 
    <p>You can parse and/or generate XML yourself if you prefer; the easiest way to do that is with an appropriate third-party library such as <a href="https://rome.dev.java.net/">Rome</a>.</p> 
    <p>Just as the Google data API's XML syntax is extensible, the corresponding object model is extensible. For example, the client library provides classes corresponding to the elements defined in the <a href="elements.html#gdReference">Google data namespace</a>.</p> 
    <h1><a name="Tutorial" id="Tutorial">Tutorial and examples</a></h1> 
    <p>The following examples show how to send various GData requests using the Java client library.</p> 
    <p>To make them more concrete, these examples show how to interact with a specific service: Google Calendar. We'll point out places where Calendar differs from other Google services, to help you adapt these examples for use with other services. For more information about Calendar, see the <a href="../calendar/developers_guide_protocol.html">Google Calendar Data API</a> document.</p>
    <h2>Building and running your client</h2> 
    <p>To compile the examples in this document, you'll need to use the following import statements:</p>
    <pre>import com.google.gdata.client.*;
import com.google.gdata.client.calendar.*;
import com.google.gdata.data.*;
import com.google.gdata.data.extensions.*;
import com.google.gdata.util.*;
import java.net.URL;</pre>
    <h2>Requesting a feed</h2>
    <p>As described in the <a href="../calendar/developers_guide_protocol.html">Google Calendar Data API</a> document, you can request a Calendar feed by sending the following HTTP request to Calendar:</p> 
    <pre>GET http://www.google.com/calendar/feeds/<i>userID</i>/private/full</pre> 
    <p>Of course, you have to replace <code>userID</code> with the user's email address; see the Calendar document for details. You can, instead, use the special default URL for interacting with Calendar (as described in the Calendar document), but in this document we'll use the private full feed URL, which contains the user ID.</p>
    <p>You also have to provide appropriate authentication. The main differences between this example and the first example in the Calendar document are that (1) this example includes authentication, and (2) this example uses the more general GoogleService class rather than the Calendar-specific CalendarService class.</p>
    <p>Note that the authentication system we're using here (known as &quot;Google Authentication for Installed Applications&quot;) is appropriate only for use in installed client applications such as desktop clients, not for use in web applications. For more information about authentication, see the <a href="http://code.google.com/apis/accounts/Authentication.html">Google Account Authentication</a> documentation.</p>
    <p>To request a Calendar feed using the Java client library, for a user with email address &quot;jo@gmail.com&quot; and password &quot;mypassword&quot;, use the following code:</p> 
    <pre>// Set up the URL and the object that will handle the connection:
URL feedUrl = new URL(&quot;http://www.google.com/calendar/feeds/jo@gmail.com/private/full&quot;);
GoogleService myService = new GoogleService(&quot;cl&quot;, &quot;exampleCo-exampleApp-1&quot;);
myService.setUserCredentials(&quot;jo@gmail.com&quot;, &quot;mypassword&quot;);

// Mark the feed as an Event feed:
new EventFeed().declareExtensions(myService.getExtensionProfile());

// Send the request and receive the response:
Feed myFeed = myService.getFeed(feedUrl, Feed.class);
</pre> 
    <p>The <a href="../../java/doc/com/google/gdata/client/GoogleService.html"><code>GoogleService</code></a> class represents a client connection (with authentication) to a GData service. The general procedure for sending a query to a service using the client library consists of the following steps:</p> 
    <ol>
      <li>Obtain or construct the appropriate URL.</li> 
      <li>If you're sending data to a service (for example, if you're inserting a new entry), then transform the raw data into objects using the client library classes. (This step doesn't apply if you're just requesting a feed, as we're doing in this example.)</li> 
      <li>Create a new <code>GoogleService</code> instance, setting the service name (such as <code>&quot;cl&quot;</code> for Calendar) and your application's name (in the form <code><i>companyName</i>-<i>applicationName</i>-<i>versionID</i></code>).</li> 
      <li>Set the appropriate credentials.</li> 
      <li>Indicate to the client library what extensions the feed will use, so that the library can parse returned feeds correctly.</li> 
      <li>Call a method to send the request and receive any results.</li> 
    </ol> 
    <p>The <code><a href="../../java/doc/com/google/gdata/client/GoogleService.html#setUserCredentials(java.lang.String,%20java.lang.String)">setUserCredentials</a></code> method specifies the ID and password of the user on whose behalf your client is sending the query. The examples in this document use the &quot;Authentication for Installed Applications&quot; authentication system; for more information about authentication systems, see the <a href="http://code.google.com/apis/accounts/Authentication.html">Google Account Authentication</a> documentation.</p> 
    <p>After setting credentials, you indicate which extensions the feed will use by calling the <code><a href="../../java/doc/com/google/gdata/data/extensions/EventFeed.html#declareExtensions(com.google.gdata.data.ExtensionProfile)">declareExtensions</a></code> method. In this case, we're saying that the feed is an Event feed, and thus that it will use the extensions defined by the <a href="elements.html#gdEventKind">Event kind</a>.</p> 
    <p>To request an entire feed, you call the <code><a href="../../java/doc/com/google/gdata/client/GoogleService.html#getFeed(java.net.URL,%20java.lang.Class)">getFeed</a></code> method, which takes a URL and returns the entire feed found at that URL. We'll show how to send more specific queries later in this document.</p> 
    <p>Like other methods of the <code>GoogleService</code> class, <code>getFeed</code> handles authentication and redirects as necessary.</p> 
    <h2>Inserting a new item</h2> 
    <p>To insert an item into a Calendar feed, you might use the following code:</p> 
    <pre>URL postUrl =
  new URL(&quot;http://www.google.com/calendar/feeds/jo@gmail.com/private/full&quot;);
EventEntry myEntry = new EventEntry();

myEntry.setTitle(new PlainTextConstruct("Tennis with Beth"));
myEntry.setContent(new PlainTextConstruct("Meet for a quick lesson."));

Person author = new Person("Jo March", null, "jo@gmail.com");
myEntry.getAuthors().add(author);

DateTime startTime = DateTime.parseDateTime(&quot;2006-04-17T15:00:00-08:00&quot;);
DateTime endTime = DateTime.parseDateTime(&quot;2006-04-17T17:00:00-08:00&quot;);
When eventTimes = new When();
eventTimes.setStartTime(startTime);
eventTimes.setEndTime(endTime);
myEntry.addTime(eventTimes);

// Send the request and receive the response:
EventEntry insertedEntry = myService.insert(postUrl, myEntry);</pre>
    <p>After setting the URL, we  construct an <code><a href="../../java/doc/com/google/gdata/data/extensions/EventEntry.html">EventEntry</a></code> object; <code>EventEntry</code> is derived from the abstract base class <code><a href="../../java/doc/com/google/gdata/data/BaseEntry.html">BaseEntry</a></code>, which is also the parent class for the <code><a href="../../java/doc/com/google/gdata/data/Entry.html">Entry</a></code> class, which represents an <code>&lt;atom:entry&gt;</code> element.</p>
    <p>The <code>EventEntry</code> class represents an Event kind; for more information, see the <a href="elements.html">Kinds document</a>. For services other than Calendar, you might assign the returned entry to an <code>Entry</code> object rather than an <code>EventEntry</code> object.</p>
    <p>The entry title is a <code><a href="../../java/doc/com/google/gdata/data/TextConstruct.html">TextConstruct</a></code>, a class that holds text in various forms (plain text, HTML, or XHTML). The entry content is represented by a <code><a href="../../java/doc/com/google/gdata/data/Content.html">Content</a></code> object, a class that can hold either plain text or other forms of content, including XML and binary data. (But the <code><a href="../../java/doc/com/google/gdata/data/BaseEntry.html#setContent(com.google.gdata.data.TextConstruct)">setContent</a></code> method can also accept a <code>TextConstruct</code>.)</p>
    <p>Each author is represented as a name, a URI, and an email address. (In this example, we're leaving out the URI.) You add an author to an entry by calling the entry's <code><a href="../../java/doc/com/google/gdata/data/BaseEntry.html#getAuthors()">getAuthors</a>().add</code> method.</p>
    <p>We're using the same <code>GoogleService</code> object that we created in the previous example. In this case, the method to call is <code><a href="../../java/doc/com/google/gdata/client/GoogleService.html#insert(java.net.URL,%20E)">insert</a></code>, which sends an item to the specified insertion URL.</p> 
    <p>The service returns the newly created entry, which may contain additional server-generated elements, such as an edit URL for the entry.</p>
    <p>HTTP status codes are returned as exceptions.</p>
    <p>The above code is equivalent to sending <code>POST http://www.google.com/calendar/feeds/jo@gmail.com/private/full</code> (with proper authentication) and providing an entry in the form of an Event kind.</p> 
    <h2>Requesting a specific entry</h2>
    <p>The following code lets you request the specific entry that you inserted in the previous example.</p>
    <p>In the context of this series of examples, retrieving that entry isn't really necessary, because Calendar already returned the inserted entry; but the same technique can be applied whenever you know the URL for an entry.</p>
    <pre>URL entryUrl = new URL(insertedEntry.getSelfLink().getHref());
EventEntry retrievedEntry = myService.getEntry(entryUrl, EventEntry.class);
</pre> 
    <p>The inserted entry has a method, <code><a href="../../java/doc/com/google/gdata/data/BaseEntry.html#getSelfLink()">getSelfLink</a></code>, that returns a <code><a href="../../java/doc/com/google/gdata/data/Link.html">Link</a></code> object that includes the entry's URL. The <code>Link</code> class has a <code><a href="../../java/doc/com/google/gdata/data/Link.html#getHref()">getHref</a></code> method that returns the URL as a <code>String</code>, from which we can create a URL object.</p> 
    <p>Then we just have to call the service's <code><a href="../../java/doc/com/google/gdata/client/GoogleService.html#getEntry(java.net.URL,%20java.lang.Class)">getEntry</a></code> method to get the entry.</p>
    <p>Note that we give <code>EventEntry.class</code> as a parameter to <code>getEntry</code>, indicating that we're specifically expecting the service to return an Event rather than just a plain entry. For services other than Calendar, you might just pass <code>Entry.class</code> instead.</p>
    <p>The above code is equivalent to sending <code>GET http://www.google.com/calendar/feeds/jo@gmail.com/private/full/<i>entryID</i></code>  to Calendar, with proper authentication.</p> 
    <h2>Searching for an entry</h2> 
    <p>To retrieve the first match in a full-text search, use the following code:</p> 
    <pre>Query myQuery = new Query(feedUrl);
myQuery.setFullTextQuery(&quot;Tennis&quot;);
Feed myResultsFeed = myService.query(myQuery, Feed.class);
if (myResultsFeed.getEntries().size() &gt; 0) {
  Entry firstMatchEntry = myResultsFeed.getEntries().get(0); 
  String myEntryTitle = firstMatchEntry.getTitle().getPlainText();
}</pre> 
    <p>This example starts by constructing a <code><a href="../../java/doc/com/google/gdata/client/Query.html">Query</a></code> object, which consists mostly of a URL plus associated query parameters. Each of the standard GData query parameters has a setter method. You can also set custom query parameters for a particular service, using the <code><a href="../../java/doc/com/google/gdata/client/Query.html#addCustomParameter(com.google.gdata.client.Query.CustomParameter)">addCustomParameter</a></code> method.</p> 
    <p>After constructing the <code>Query</code>, we pass it to the service's <code><a href="../../java/doc/com/google/gdata/client/Service.html#query(com.google.gdata.client.Query,%20java.lang.Class)">query</a></code> method, which returns a feed containing the query results. An alternative approach would be to construct a URL yourself (by appending query parameters to the feed URL) and then call the <code>getFeed</code> method, but the <code>query</code> method provides a useful layer of abstraction so that you don't have to construct the URL yourself.</p> 
    <p>The feed's <code><a href="../../java/doc/com/google/gdata/data/BaseFeed.html#getEntries()">getEntries</a></code> method returns a list of the entries in the feed; <code>getEntries().size</code> returns the number of entries in the feed.</p>
    <p>In this case, if the query returned any results, we assign the first matching result to an <code>Entry</code> object. Then we use the <code>Entry</code> class's <code><a href="../../java/doc/com/google/gdata/data/BaseEntry.html#getTitle()">getTitle</a>().getPlainText</code> method to retrieve the entry's title and convert it to text.</p>
    <p>The above code is equivalent to sending <code>GET http://www.google.com/calendar/feeds/jo@gmail.com/private/full?q=Tennis</code> to Calendar.</p> 
    <h2>Querying by category</h2> 
    <p class="note"><strong>Note</strong>: Google Calendar doesn't associate labels with events, so this example doesn't work with Calendar.</p>
    <p>To retrieve a feed consisting of all the entries that match the earlier full-text search and that are in a particular category or have a particular label, use the following code:</p>
    <pre>Category myCategory = new Category(&quot;by_jo&quot;);
CategoryFilter myCategoryFilter = new CategoryFilter(myCategory);
myQuery.addCategoryFilter(myCategoryFilter);
Feed myCategoryResultsFeed = myService.query(myQuery, Feed.class);</pre>
    <p>The <code><a href="../../java/doc/com/google/gdata/data/Category.html">Category</a></code> class, of course, represents a category to be used in a category filter. The <code><a href="../../java/doc/com/google/gdata/client/Query.CategoryFilter.html">Query.CategoryFilter</a></code> class can contain multiple categories, but in this case we're constructing a filter with only one category.</p> 
    <p>Then we add that filter to the existing query, which still contains the full-text query string from the previous example.</p> 
    <p>We again use the <code>query</code> method to send the query to the service.</p> 
    <p>If Calendar allowed a category search, the above code would be equivalent to sending <code>GET http://www.google.com/calendar/feeds/jo@gmail.com/private/full/-/by_jo?q=Tennis</code> to Calendar.</p>
    <h2>Updating an item</h2> 
    <p>To update an existing item, use the following code. In the following example, we're changing the previously retrieved entry's title from its old text ("Tennis with Beth") to &quot;Important meeting.&quot;</p> 
    <pre>retrievedEntry.setTitle(new PlainTextConstruct("Important meeting"));
URL editUrl = new URL(retrievedEntry.getEditLink().getHref());
EventEntry updatedEntry = myService.update(editUrl, myEntry);
</pre> 
    <p>First we set a new title for the entry we fetched earlier. Then we get the edit URL for the entry, using the <code><a href="../../java/doc/com/google/gdata/data/BaseEntry.html#getEditLink()">getEditLink</a></code> method. Then we call the service's <code><a href="../../java/doc/com/google/gdata/client/GoogleService.html#update(java.net.URL,%20E)">update</a></code> method to send the updated entry.</p> 
    <p>The service returns the updated entry, including a new URL for this entry's new version. (For more information on entry versions, see the <a href="reference.html#Optimistic-concurrency">Optimistic concurrency</a> section of the <a href="reference.html">protocol reference document</a>.)</p> 
    <p>The above code is roughly equivalent to sending <code>PUT http://www.google.com/calendar/feeds/jo@gmail.com/private/full/<i>entryID</i></code> to the service, along with the new entry (in Atom format) to replace the original entry.</p>
    <h2>Deleting an item</h2> 
    <p>To delete an existing item, use the following code:</p> 
    <pre>URL deleteUrl = new URL(updatedEntry.getEditLink().getHref());
myService.delete(deleteUrl);</pre> 
    <p>The URL to use for deletion is the same as the edit URL, so this example is very similar to the previous one, except of course that we're calling the <code><a href="../../java/doc/com/google/gdata/client/GoogleService.html#delete(java.net.URL)">delete</a></code> method instead of <code>update</code>.</p> 
    <p>The above code is roughly equivalent to sending <code>DELETE http://www.google.com/calendar/feeds/jo@gmail.com/private/full/<i>entryID</i></code> to the service.</p> 
    <h1><a name="Reference" id="Reference">Reference</a></h1>
    <p>For reference information about the Java client library, see the <a href="../../java/doc/index.html">reference documentation</a> (in Javadoc format).</p>
    <p class="backtotop"><a href="#top">Back to top</a></p>
  </div>
  <!-- ########## END PAGE CONTENT ########## -->
</div>
<!-- end wrapper -->
<!-- ########## PAGE FOOTER ########## -->
<div id="footer">
  <div id="footerlogo"><img src="http://www.google.com/images/art.gif" alt="" /></div>
  <div id="copyright">
    <p>&copy; Google Inc. 2007 - <a href="http://www.google.com/privacy.html">Privacy Policy</a> - <a href="http://www.google.com/terms_of_service.html">Terms and Conditions</a> - <a href="http://www.google.com/about.html">About Google</a></p>
  </div>
  <!-- end copyright -->
</div>
<!-- ########## END PAGE FOOTER ########## -->
<p id="date">Last modified:
<script type="text/javascript">
  <!--
  var lm = new Date(document.lastModified);
  document.write(lm.toDateString());
  //-->
</script>
</p>
</body>
</html>
