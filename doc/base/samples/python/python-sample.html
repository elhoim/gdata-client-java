<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="../../../css/google.css" />
<link rel="stylesheet" type="text/css" href="../../../css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="../../local_extensions.css" />
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../../../css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../../../css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../../../css/ieonly.css" />
<![endif]-->
<title>Google Base data API- Accessing the Google Base data API using Python</title>
</head>
<body id="sample_page">
<a name="top" id="top"></a>
<!-- ########## PAGE HEADER ########## -->
<div id="header">
  <div id="logo"><a href="http://code.google.com/"><img src="http://code.google.com/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Google Base data API</h1>
</div>
<!-- ########## END PAGE HEADER ########## -->
<div id="wrapper">
  <!-- ########## SIDE NAVIGATION ########## -->
    <div id="sidenav"> <!-- ID tag identifies current page -->

<ul>
  <li><a href="http://base.google.com/base">Base Home</a></li>
  <li><a href="../../index.html" id="index_link">Base API Home</a></li>
</ul>
<ul>
  <li>
    <h1>Getting Started</h1>
    <ul>
      <li><a href="http://www.google.com/base/api/demo/html/demo.html" id="demo_link">API Demo Page</a> </li>
      <li><a href="../../sample-apps.html" id="sample_link">Sample Applications</a></li>
      <li><a href="../../starting-out.html" id="start_link">Getting Started</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Developer's Guide</h1>
    <ul>
      <li><a href="../../attrs-queries.html" id="attsquer_link">Attributes and Queries</a></li>
      <li><a href="http://code.google.com/apis/gdata/index.html">GData Developer's Guide</a></li>
      <li><a href="../../javadevguide.html" id="javaDev_link">Java Developer's Guide</a></li>
      <li><a href="../../csharpdevguide.html" id="cSharpDev_link">C# Developer's Guide</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Reference</h1>
    <ul>
      <li><a href="http://base.google.com/base/api/itemTypeDocs" id="itemType_link">Recommended
        Attributes</a></li>
      <li><a href="../../snippets-feed.html" id="snippets_link">Snippets
        Feed</a></li>
      <li><a href="../../items-feed.html" id="items_link">Customer Items
        Feed</a></li>
      <li><a href="../../attributes-feed.html" id="attributes_link">Attributes
        Feed</a></li>
      <li><a href="../../itemtypes-feed.html" id="itemtypes_link">Item Types
        Feed</a></li>
      <li><a href="../../locales-feed.html" id="locales_link">Locales Feed</a></li>
      <li><a href="../../query-lang-spec.html" id="query_link">Query Language</a></li>
      <li><a href="../../ranking-lang-spec.html" id="ranking_link">Expression Language</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Related Links</h1>
    <ul>
      <li><a href="../../client-download.html" id="clientdownload_link">Client
        Library </a></li>
      <li><a href="../../signup.html" id="signup_link">API Key</a></li>
      <li><a href="../../terms.html" id="terms_link">Terms of Use</a></li>
      <li><a href="../../release-notes.html" id="rnotes_link">Release Notes </a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Help Center</h1>
    <ul>
      <li><a href="http://base.google.com/support/bin/topic.py?topic=9231">FAQ</a></li>
      <li><a href="http://groups.google.com/group/Google-Base-data-API">Developer Forum</a></li>
      <li><a href="http://code.google.com/support/bin/topic.py?topic=10024">Knowledge Base</a> </li>
      <li><a href="http://base.google.com/base/base_policies.html">Program Policies</a></li>
      </ul>
  </li>
</ul>
<form action="http://www.google.com/search" method="get" id="searchbox" style="font-size: 80%; margin-bottom: 0;">
  <input type="text" name="q" size="15" id="searchinput" title="Search developer's guide" style="font-size: 100%;"
		onfocus="clearDefaultValue(this);"/>
  <!-- This comment prevents 
	space-->
  <input type="submit" name="submit" value="Go" title="" style="font-size: 90%;"/>
  <input type="hidden" name="ie" value="UTF-8"/>
  <input type="hidden" name="oe" value="UTF-8"/>
  <input type="hidden" name="sitesearch" value="http://code.google.com/apis/base/"/>
  <input type="hidden" name="domains" value="http://code.google.com/apis/base/"/>
</form>
 </div>
  <!-- ########## END SIDE NAVIGATION ########## -->
<div id="pagecontent">
  <!-- ########## PAGE CONTENT ########## -->
  <h2 id="page_title">Accessing the Google Base data API using Python </h2>
  <p><strong>Select a language:</strong> |
    <a href="../java/java-sample.html">Java</a> 
    
| <a href="../javascript/javascript-sample.html">JavaScript</a> | <a href="../perl/perl-sample.html">Perl</a> | <a href="../php/php-sample-zend.html">PHP</a> |<strong><activeLang> Python </activeLang></strong>
| <a href="../csharp/csharp-sample.html">C#</a> | <a href="../vb/vb-sample.html">VB.NET</a> | <a href="../coldfusion/coldfusion-sample.html">ColdFusion</a> </p>
  <p>The <a href="gbase_python_example.zip">example Python application</a> generates a sample XML file for a specific item type. It proposes the attributes that are most commonly  used on Google Base for this item type and gives a few examples to illustrate how they're used. </p>
  <p> This application shows how to access the public Google Base feeds; in particular the <a href="../../attributes-feed.html">attributes feed</a>. </p>
  <h2>Running the application </h2>
  <p>Before you can run this application, you will need to <a href="../../signup.html">get a key for &quot;Installed applications&quot;</a>.</p>
  <h3>Usage</h3>
  <pre>python generate_template.py [options] <em>item_type</em></pre>
  <h4>Options</h4>
  <ul>
    <li><code>-h, --help            </code><br />
    show this help message and exit</li>
    <li><code>--url=BASE_URL        </code><br />
    the url of the google base server to use</li>
    <li><code>--file=FILE           </code><br />
    write output to FILE instead of standard output</li>
    <li><code>--key=KEY             </code><br />
    developer key (required)</li>
    <li><code>--attribute_count=MAX_RESULTS</code> <br />
    maximum number of attributes to include</li>
    <li> <code>--value_count=MAX_VALUES </code><br />
    maximum number of examples to include</li>
    <li><code>--include_example</code>     <br />
    include an example in the template</li>
    
  </ul>
  <h3>Examples</h3>
  <pre>python generate_template.py --key 1234 books </pre>
  <pre>python generate_template.py --key 1234 housing </pre>
  <pre>python generate_template.py --key 1234 &quot;events and activities&quot;     </pre>
  <h2>Understanding the code </h2>
  <p><a href="generate_template.py.txt" target="_blank"><code>generate_template.py</code></a> is the main entry point of the application; however, it doesn't contain much that is specific to Google Base data API.</p>
  <p>The interesting code is in <a href="googlebase.py.txt" target="_blank"><code>googlebase.py</code></a>.</p>
  <p>Everything starts with the <code>GoogleBaseService</code> object. It connects to <code>www.google.com/base</code>, passes along your developer key, and returns the feed as a DOM tree. </p>
  <p>You need to pass it the API key you got from <a href="http://code.google.com/apis/base/signup.html">http://code.google.com/apis/base/signup.html</a> to create a new instance:
  <pre>import googlebase
service = googlebase.GoogleBaseService(&quot;1234&quot;)</pre>
  <p>Once you have the service object, you can connect to any of the public feeds described in the <a href="http://code.google.com/apis/base/">Google Base data API documentation</a>. </p>
  <p>Here is how you could query the snippet feeds for books about programming:</p>
  <pre>domtree = service.run_query(&quot;snippets&quot;, bq=&quot;[item type: book] programming&quot;, max_results=20)</pre>
  <p>Any named parameter you pass to <code>run_query()</code> will be forwarded to the feed. Refer to the <a href="http://base.google.com/base/api/itemTypeDocs">feed documentation</a> for a list of the parameters that each feed accepts. </p>
  <p>If you look at how <code>run_query()</code> is implemented, you'll see that it simply builds a feed URL, reads it and passes the result to the minidom parser.</p>
  <p>Once you have the DOM tree, you can access any elements as described in the <a href="http://docs.python.org/lib/module-xml.dom.html">Python documentation</a>.</p>
  <p>For example, here is how you would display the title and author of all of the books returned by the previous query: </p>
  <pre>def textContent(domelement):
  if not domelement: return &quot;?&quot;
  return ''.join([c.toxml('utf-8') for c in domelement[0].childNodes])
for book in domtree.getElementsByTagNameNS(googlebase.ATOM_NAMESPACE_URI, &quot;entry&quot;):
  print '&quot;%s&quot; by &quot;%s&quot;' % (textContent(book.getElementsByTagNameNS(googlebase.ATOM_NAMESPACE_URI, &quot;title&quot;)),
                          textContent(book.getElementsByTagNameNS(googlebase.G_NAMESPACE_URI, &quot;author&quot;)))</pre>
  <p>This is similar to what the  <code>listMostCommonItemTypeAttributes()</code> method does when it parses the attributes feed. </p>
  <p>To wrap up, here's what <code>googlebase.py</code> does in the previous examples:</p>
  <pre>import urllib2
import xml.dom.minidom


# service = googlebase.GoogleBaseService(&quot;1234&quot;)
opener = urllib2.build_opener()
opener.addheaders = [(&quot;X-Google-Key&quot;, &quot;key=1234&quot;)]

# domtree = service.run_query(&quot;snippets&quot;, bq=&quot;[item type: book] programming&quot;, max_results=20)
handle = opener.open(&quot;http://www.google.com/base/feeds/snippets?max-results=20&amp;bq=%5Bitem+type%3A+book%5D+programming&quot;)
domtree = xml.dom.minidom.parse(handle)
handle.close()  </pre>
  <p>&nbsp;  </p>
</div>
<!-- ########## END PAGE CONTENT ########## -->
</div>
<!-- end wrapper -->
<div id="footer">
  <!-- ########## PAGE FOOTER ########## -->
  <div id="footerlogo"><img src="http://www.google.com/images/art.gif" /></div>
  <div id="copyright">
    <p>&copy;2007 Google - <a href="http://www.google.com/privacy.html">Privacy
      Policy</a> - <a href="http://www.google.com/terms_of_service.html">Terms
      and Conditions</a> - <a href="http://www.google.com/about.html">About
      Google</a></p>
  </div>
  <!-- end copyright -->
</div>
<!-- ########## END PAGE FOOTER ########## -->
<p id="date"> Updated on
  <!-- javascript to display the date this page was updated -->
  <script type="text/javascript">
<!-- hide script from old browsers
    var lm = new Date(document.lastModified);
    document.write(lm.toDateString());
//-->
</script>
  <!-- end javascript -->
</p>
<script
  src="http://www.google-analytics.com/urchin.js"
  type="text/javascript">
</script>
<script type="text/javascript">
  _uacct="UA-18071-1";
  urchinTracker();
</script>
</body>
</html>
