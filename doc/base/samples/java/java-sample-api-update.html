<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="../../../css/google.css" />
<link rel="stylesheet" type="text/css" href="../../../css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="../../local_extensions.css" />
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../../../css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../../../css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../../../css/ieonly.css" />
<![endif]-->
<title>Google Base data API- Accessing the Google Base data API using Java</title>
</head>
<body id="sample_page">
<a name="top" id="top"></a>
<!-- ########## PAGE HEADER ########## -->
<div id="header">
  <div id="logo"><a href="http://code.google.com/"><img src="http://code.google.com/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Google Base data API</h1>
</div>
<!-- ########## END PAGE HEADER ########## -->
<div id="wrapper">
  <!-- ########## SIDE NAVIGATION ########## -->
    <div id="sidenav"> <!-- ID tag identifies current page -->

<ul>
  <li><a href="http://base.google.com/base">Base Home</a></li>
  <li><a href="../../index.html" id="index_link">Base API Home</a></li>
</ul>
<ul>
  <li>
    <h1>Getting Started</h1>
    <ul>
      <li><a href="http://www.google.com/base/api/demo/html/demo.html" id="demo_link">API Demo Page</a> </li>
      <li><a href="../../sample-apps.html" id="sample_link">Sample Applications</a></li>
      <li><a href="../../starting-out.html" id="start_link">Getting Started</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Developer's Guide</h1>
    <ul>
      <li><a href="../../attrs-queries.html" id="attsquer_link">Attributes and Queries</a></li>
      <li><a href="http://code.google.com/apis/gdata/index.html">GData Developer's Guide</a></li>
      <li><a href="../../javadevguide.html" id="javaDev_link">Java Developer's Guide</a></li>
      <li><a href="../../csharpdevguide.html" id="cSharpDev_link">C# Developer's Guide</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Reference</h1>
    <ul>
      <li><a href="http://base.google.com/base/api/itemTypeDocs" id="itemType_link">Recommended
        Attributes</a></li>
      <li><a href="../../snippets-feed.html" id="snippets_link">Snippets
        Feed</a></li>
      <li><a href="../../items-feed.html" id="items_link">Customer Items
        Feed</a></li>
      <li><a href="../../attributes-feed.html" id="attributes_link">Attributes
        Feed</a></li>
      <li><a href="../../itemtypes-feed.html" id="itemtypes_link">Item Types
        Feed</a></li>
      <li><a href="../../locales-feed.html" id="locales_link">Locales Feed</a></li>
      <li><a href="../../query-lang-spec.html" id="query_link">Query Language</a></li>
      <li><a href="../../ranking-lang-spec.html" id="ranking_link">Expression Language</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Related Links</h1>
    <ul>
      <li><a href="../../client-download.html" id="clientdownload_link">Client
        Library </a></li>
      <li><a href="../../signup.html" id="signup_link">API Key</a></li>
      <li><a href="../../terms.html" id="terms_link">Terms of Use</a></li>
      <li><a href="../../release-notes.html" id="rnotes_link">Release Notes </a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Help Center</h1>
    <ul>
      <li><a href="http://base.google.com/support/bin/topic.py?topic=9231">FAQ</a></li>
      <li><a href="http://groups.google.com/group/Google-Base-data-API">Developer Forum</a></li>
      <li><a href="http://code.google.com/support/bin/topic.py?topic=10024">Knowledge Base</a> </li>
      <li><a href="http://base.google.com/base/base_policies.html">Program Policies</a></li>
      </ul>
  </li>
</ul>
<form action="http://www.google.com/search" method="get" id="searchbox" style="font-size: 80%; margin-bottom: 0;">
  <input type="text" name="q" size="15" id="searchinput" title="Search developer's guide" style="font-size: 100%;"
		onfocus="clearDefaultValue(this);"/>
  <!-- This comment prevents 
	space-->
  <input type="submit" name="submit" value="Go" title="" style="font-size: 90%;"/>
  <input type="hidden" name="ie" value="UTF-8"/>
  <input type="hidden" name="oe" value="UTF-8"/>
  <input type="hidden" name="sitesearch" value="http://code.google.com/apis/base/"/>
  <input type="hidden" name="domains" value="http://code.google.com/apis/base/"/>
</form>
 </div>
  <!-- ########## END SIDE NAVIGATION ########## -->
<div id="pagecontent">
    <!-- ########## PAGE CONTENT ########## -->
  <h2 id="page_title">Understanding the Java UpdateExample API Sample Application</h2>
  <p><strong>Select a language:</strong> |<activeLang> Java </activelang>
    | <a href="../javascript/javascript-sample.html">JavaScript</a> | <a href="../perl/perl-sample.html">Perl</a> | <a href="../php/php-sample-zend.html">PHP</a> | <a href="../python/python-sample.html">Python</a> | <a href="../csharp/csharp-sample.html">C#</a> | <a href="../vb/vb-sample.html">VB.NET</a> | <a href="../coldfusion/coldfusion-sample.html">ColdFusion</a> </p>
  <p id="langSelect"> <a href="java-sample.html">Java Sample Home</a> <a href="java-sample-api-query1.html">QueryExample1</a> <a href="java-sample-api-query2.html">QueryExample2</a> <a href="java-sample-api-query3.html">QueryExample3</a> <a href="java-sample-api-insert.html">InsertExample</a> <strong>UpdateExample</strong> </p>

  <p><code>UpdateExample</code> shows how to modify your Google Base items.</p>
<p>The previous examples demonstrated how to query the Google Base data API
  server, both for authenticated and unauthenticated feeds, and how to insert a
  new item. We will combine this knowledge here in order to demonstrate how to
  update an existing item. </p>
<p>You will need a <a href="https://www.google.com/accounts/NewAccount">Google
  Account email and password</a> in order to run this example.</p>
<p>This example does not
  introduce any new concepts. Rather, it uses all of the concepts that
  have already been presented in the previous examples. We will authenticate, insert an
  item, and then update the inserted item by adding a new label to it.</p>
<h3>Contents</h3>
<ol class="toc">
        <li><a href="#updateRun">Running UpdateExample</a>    </li>
        <li><a href="#updateStepThru">Stepping through the UpdateExample code </a></li>
</ol>

<h2><a name="updateRun" id="updateRun"></a>Running UpdateExample</h2>
<ol>
  <li><a href="http://code.google.com/apis/base/signup.html">Obtain a developer key</a> for an &quot;installed application&quot;. </li>
  <li>Edit <code><a href="UpdateExample.java" target="_blank">UpdateExample.java</a></code> and fill in the <code>DEVELOPER_KEY</code> static string with your developer key. </li>
  <pre>private static final String DEVELOPER_KEY = &quot;&quot;;</pre>
  <li>Enter your Google Accounts email address and your password in the <code>EMAIL</code> and <code>PASSWORD</code> static strings:</li>
        <pre>private static final String EMAIL = &quot;&quot;;
private static final String PASSWORD = &quot;&quot;;</pre>
  <li>Compile and run the example using your favorite editor, or the command
    line:</li>
    <pre>javac com/google/api/gbase/examples/basic/UpdateExample.java
java com/google/api/gbase/examples/basic/UpdateExample
</pre>
  </ol>
  <p>The output will be as follows:</p>
    <pre>Obtained authorization token: DQAAAGgA...dk3fA5N
Posting item:
&lt;?xml version='1.0'?&gt;
&lt;entry xmlns='http://www.w3.org/2005/Atom' xmlns:g='http://base.google.com/ns/1.0'&gt;
  &lt;category scheme='http://base.google.com/categories/itemtypes' term='Products'/&gt;
  &lt;g:item_type type='text'&gt;Products&lt;/g:item_type&gt;
  &lt;title type='text'&gt;My cool car is for sale&lt;/title&gt;
  &lt;content type='xhtml'&gt;Light pink, yellow seats.&lt;/content&gt;
&lt;/entry&gt;

Updating item: http://base.google.com/base/feeds/items/18020038538902937385  
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;entry&gt;
  &lt;id&gt;http://base.google.com/base/feeds/items/18020038538902937385&lt;/id&gt;
  &lt;updated&gt;2006-08-23T16:20:21.601Z&lt;/updated&gt;
  &lt;category scheme=&quot;http://base.google.com/categories/itemtypes&quot; term=&quot;Products&quot;/&gt;
  &lt;title type=&quot;text&quot;&gt;My cool car is for sale&lt;/title&gt;
  &lt;content type=&quot;xhtml&quot;&gt;Light pink, yellow seats.&lt;/content&gt;
  &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot; href=&quot;http://base.google.com/base/feeds/items/18020038538902937385&quot;/&gt;
  &lt;link rel=&quot;edit&quot; type=&quot;application/atom+xml&quot; href=&quot;http://base.google.com/base/feeds/items/18020038538902937385&quot;/&gt;
  &lt;g:item_type type=&quot;text&quot;&gt;Products&lt;/g:item_type&gt;
&lt;/entry&gt;</pre>
    <h2><a name="UpdateStepThru" id="UpdateStepThru"></a>Stepping through the UpdateExample code</h2>
<p>The <code>main</code> method of <code>UpdateExample.java</code> provides a good
  outline of the example's structure.</p>
<pre>public static void main(String[] args) throws MalformedURLException, IOException {
  UpdateExample updateExample = new UpdateExample();
  String token = updateExample.authenticate();
  System.out.println(&quot;Obtained authorization token: &quot; + token);
  
  System.out.println(&quot;Posting item:\n&quot; + DATA_ITEM);
  String itemUrl = updateExample.extractItemUrlFromResponse(
    updateExample.postItem(token));
    
  System.out.println(&quot;Updating item: &quot; + itemUrl);
  String updateResponse = updateExample.updateItem(token, itemUrl);
  System.out.println(updateResponse);
}
</pre>
<p>As in the previous examples, we begin by authenticating and
  obtaining an authorization token using the <code>authenticate()</code> method:
</p>
<pre>String token = updateExample.authenticate();
</pre>
<p>We then insert <code>DATA_ITEM</code> using <code>postItem()</code>:
</p>
<pre>String itemUrl = updateExample.extractItemUrlFromResponse(
        updateExample.postItem(token));
</pre>
<p>In the line above, we pass the output of the post operation
  to <code>extractItemUrlFromResponse()</code> rather than dumping it out to the
  console. This extracts the inserted item's ID:
</p>
<pre>&lt;id&gt;http://base.google.com/base/feeds/items/18020038538902937385&lt;/id&gt;
</pre>
<p>We assume that the item's ID is surrounded by the first
  <code>&lt;id&gt;&lt;/id&gt;</code> tags. This is true for the Google Base data API servers,
  but it's not enforced by the Atom protocol. Refer to the way the title gets parsed in <a href='java-sample-api-query2.html'>Query Example 2</a> for a better way to parse
  the item's title.</p>
<p>Once <code>DATA_ITEM</code> is successfully inserted, we replace it with <code>NEW_DATA_ITEM</code> using <code>updateItem()</code>. Updating an item is
  very similar to inserting a new one; in fact, it is so similar that both operations
  can be performed by the same method: <code>makeHttpRequest()</code>. <code>makeHttpRequest()</code> receives as parameters the authorization token,
  the url to connect to, the item to be inserted or posted, the HTTP method to
  use (this will be POST for an insert, and PUT for an update) and the response
  code to expect in case of a successful operation (HTTP_CREATED for an insert, HTTP_OK for an update). Thus, <code>postItem()</code> will contain
  a simple invocation to <code>makeHttpRequest()</code>:</p>
<pre>public String postItem(String token) throws IOException {
  return makeHttpRequest(token, ITEMS_FEED, NEW_DATA_ITEM, &quot;POST&quot;, HttpURLConnection.HTTP_CREATED);
}  
</pre>
<p>Similarly, <code>updateItem()</code> invokes <code>makeHttpRequest()</code> with slightly different parameters:
</p>
<pre>public String updateItem(String token, String itemUrl) throws MalformedURLException, IOException {
  return makeHttpRequest(token, itemUrl, NEW_DATA_ITEM, &quot;PUT&quot;, HttpURLConnection.HTTP_OK);
}
</pre>
</div>
  <!-- ########## END PAGE CONTENT ########## -->
</div>
<!-- end wrapper -->
<div id="footer">
  <!-- ########## PAGE FOOTER ########## -->
  <div id="footerlogo"><img src="http://www.google.com/images/art.gif" /></div>
  <div id="copyright">
    <p>&copy;2007 Google - <a href="http://www.google.com/privacy.html">Privacy
      Policy</a> - <a href="http://www.google.com/terms_of_service.html">Terms
      and Conditions</a> - <a href="http://www.google.com/about.html">About
      Google</a></p>
  </div>
  <!-- end copyright -->
</div>
<!-- ########## END PAGE FOOTER ########## -->
<p id="date"> Updated on
  <!-- javascript to display the date this page was updated -->
  <script type="text/javascript">
<!-- hide script from old browsers
    var lm = new Date(document.lastModified);
    document.write(lm.toDateString());
//-->
</script>
  <!-- end javascript -->
</p>
<script
  src="http://www.google-analytics.com/urchin.js"
  type="text/javascript">
</script>
<script type="text/javascript">
  _uacct="UA-18071-1";
  urchinTracker();
</script>
</body>
</html>
