<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="../../../css/google.css" />
<link rel="stylesheet" type="text/css" href="../../../css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="../../local_extensions.css" />
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../../../css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../../../css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../../../css/ieonly.css" />
<![endif]-->
<title>Google Base data API - Accessing the Google Base data API using PHP</title>
</head>
<body id="sample_page">
<a name="top" id="top"></a>
<!-- ########## PAGE HEADER ########## -->
<div id="header">
  <div id="logo"><a href="http://code.google.com/"><img src="http://code.google.com/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Google Base data API</h1>
</div>
<!-- ########## END PAGE HEADER ########## -->
<div id="wrapper">
  <!-- ########## SIDE NAVIGATION ########## -->
    <div id="sidenav"> <!-- ID tag identifies current page -->

<ul>
  <li><a href="http://base.google.com/base">Base Home</a></li>
  <li><a href="../../index.html" id="index_link">Base API Home</a></li>
</ul>
<ul>
  <li>
    <h1>Getting Started</h1>
    <ul>
      <li><a href="http://www.google.com/base/api/demo/html/demo.html" id="demo_link">API Demo Page</a> </li>
      <li><a href="../../sample-apps.html" id="sample_link">Sample Applications</a></li>
      <li><a href="../../starting-out.html" id="start_link">Getting Started</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Developer's Guide</h1>
    <ul>
      <li><a href="../../attrs-queries.html" id="attsquer_link">Attributes and Queries</a></li>
      <li><a href="http://code.google.com/apis/gdata/index.html">GData Developer's Guide</a></li>
      <li><a href="../../javadevguide.html" id="javaDev_link">Java Developer's Guide</a></li>
      <li><a href="../../csharpdevguide.html" id="cSharpDev_link">C# Developer's Guide</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Reference</h1>
    <ul>
      <li><a href="http://base.google.com/base/api/itemTypeDocs" id="itemType_link">Recommended
        Attributes</a></li>
      <li><a href="../../snippets-feed.html" id="snippets_link">Snippets
        Feed</a></li>
      <li><a href="../../items-feed.html" id="items_link">Customer Items
        Feed</a></li>
      <li><a href="../../attributes-feed.html" id="attributes_link">Attributes
        Feed</a></li>
      <li><a href="../../itemtypes-feed.html" id="itemtypes_link">Item Types
        Feed</a></li>
      <li><a href="../../locales-feed.html" id="locales_link">Locales Feed</a></li>
      <li><a href="../../query-lang-spec.html" id="query_link">Query Language</a></li>
      <li><a href="../../ranking-lang-spec.html" id="ranking_link">Expression Language</a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Related Links</h1>
    <ul>
      <li><a href="../../client-download.html" id="clientdownload_link">Client
        Library </a></li>
      <li><a href="../../signup.html" id="signup_link">API Key</a></li>
      <li><a href="../../terms.html" id="terms_link">Terms of Use</a></li>
      <li><a href="../../release-notes.html" id="rnotes_link">Release Notes </a></li>
    </ul>
  </li>
</ul>
<ul>
  <li>
    <h1>Help Center</h1>
    <ul>
      <li><a href="http://base.google.com/support/bin/topic.py?topic=9231">FAQ</a></li>
      <li><a href="http://groups.google.com/group/Google-Base-data-API">Developer Forum</a></li>
      <li><a href="http://code.google.com/support/bin/topic.py?topic=10024">Knowledge Base</a> </li>
      <li><a href="http://base.google.com/base/base_policies.html">Program Policies</a></li>
      </ul>
  </li>
</ul>
<form action="http://www.google.com/search" method="get" id="searchbox" style="font-size: 80%; margin-bottom: 0;">
  <input type="text" name="q" size="15" id="searchinput" title="Search developer's guide" style="font-size: 100%;"
		onfocus="clearDefaultValue(this);"/>
  <!-- This comment prevents 
	space-->
  <input type="submit" name="submit" value="Go" title="" style="font-size: 90%;"/>
  <input type="hidden" name="ie" value="UTF-8"/>
  <input type="hidden" name="oe" value="UTF-8"/>
  <input type="hidden" name="sitesearch" value="http://code.google.com/apis/base/"/>
  <input type="hidden" name="domains" value="http://code.google.com/apis/base/"/>
</form>
 </div>
    <!-- ########## END SIDE NAVIGATION ########## -->
    <div id="pagecontent">
      <!-- ########## PAGE CONTENT ########## -->
      <h2 id="page_title">Accessing the Google Base data API using PHP with the Zend Framework </h2>
      <p><strong>Select a language:</strong> <a href="../java/java-sample.html">Java</a> | <a href="../javascript/javascript-sample.html">JavaScript</a> | <a href="../perl/perl-sample.html">Perl</a> |
        <activeLang><strong> PHP </strong></activelang>
        | <a href="../python/python-sample.html">Python</a> | <a href="../csharp/csharp-sample.html">C#</a> | <a href="../vb/vb-sample.html">VB.NET</a> | <a href="../coldfusion/coldfusion-sample.html">ColdFusion</a> </p>
      <p id="langSelect"> <strong>PHP5 with Zend Framework</strong> | <a href="php-sample.html">PHP4 with libcurl</a></p>
      <p>The PHP Recipe application is a small but complete example that demonstrates the five Google Base API services: queries, insertions, deletions, updates, and batch commands. This version uses the <a href="http://framework.zend.com/download/gdata">Zend Google Data Client Library</a> to interact with the Google Base server, eliminating the need to manually construct and parse XML and HTTP interactions.</p>
     <h3>Contents</h3>
    <ol class="toc">
        <li><a href="#usingRecipe">Using the Recipe application </a></li>
        <li><a href="#RSstepThru">Stepping through the Recipe application code</a>
        <ol class="toc">
          <li><a href="#setup">Setup and token exchange</a>
          <ol class="toc">
            <li><a href="#introPage">Building the introductory page</a></li>
            <li><a href="#exchangeToken">Exchanging the single-session token</a></li>
          </ol></li>
          <li><a href="#xml">Constructing XML requests and parsing XML responses</a>
          <ol class="toc">
            <li><a href="#itemXML">Creating the item insertion request</a></li>
            <li><a href="#editXML">Creating the item edit request</a></li>
            <li><a href="#deleteXML">Creating the batch deletion request</a></li>
          </ol></li>
          <li><a href="#FeedInteract">Interacting with the Google Base feed </a>
          <ol class="toc">
            <li><a href="#queryEntries">Retrieving the user's entries</a></li>
            <li><a href="#insertEntry">Inserting new entries</a></li>
            <li><a href="#updateEntry">Updating existing entries</a> </li>
            <li><a href="#deleteEntry">Deleting existing entries</a></li>
            <li><a href="#batchCommand">Executing a batch command</a></li>
          </ol></li>
        </ol></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
      </ol>
      <h2><a name="usingRecipe" id="usingRecipe"></a>Using the Recipe application </h2>
      <p>You can <a href="demo-zend.php.txt">download the source code</a> for the sample program and host it on your own web server. You will also need to <a href="http://framework.zend.com/download/gdata">download the Zend Google Data Client Library</a> if you want to run a local copy of the demo. This sample is compatible with the 0.9.<i>x</i> series of Zend Google Data Client Library releases. You must be running <a href="http://www.php.net">PHP</a> 5.1.4 or later in order to use this client library.</p>
      <p>After installing the PHP sample application, ensure that the <code>set_include_path</code> call on line 4 points to the directory where you downloaded the Zend Google Data Client Library.</p>
      <p>When you first use the Recipe application, you will have to log in to your Google Account and grant the script permission to access your Google Base entries.</p>
      <h2><a name="RSstepThru" id="RSstepThru"></a>Stepping through the Recipe application code </h2>
      <p>The Recipe application allows users to upload new recipes to Google Base, edit or delete recipes they have already added, or delete all their recipes with a batch request. It uses GET and POST parameters to maintain two key elements of program state: the user's <b>AuthSub token</b> and <b>requested action</b> (insert, update, delete, or batch).</p>
      <h3><a name="setup" id="setup"></a>Setup and token exchange</h3>
      <p>This section describes how the Recipe application initially interacts with the user and obtains a session token from the AuthSub server.</p>
      <h4><a name="introPage" id="introPage"></a>Building the introductory page: <code>showIntroPage()</code></h4>
      <p>When a user first arrives at the Recipe application, no GET or POST parameters are provided to the form. This indicates that the user has not yet obtained a single-session token. The code below uses the <code>Zend_Gdata_AuthSub::getAuthSubTokenUri</code> method <b></b> to set up a link to the <code><a href="http://code.google.com/apis/accounts/AuthForWebApps.html#AuthSubRequest">AuthSubRequest</a></code> page. It passes these values as arguments:<br />
      <ul>
        <li><code>$next_url</code>, corresponding to the <b>next</b> AuthSubRequest parameter, indicates that the user should be returned to the Recipe application after obtaining a token;</li>
        <li><code>$itemsFeedURL</code>, corresponding to the <b>scope</b> AuthSubRequest parameter, indicates that the Recipe application will only access the items feed;</li>
        <li><code>0</code>, corresponding to the <b>secure</b> AuthSubRequest parameter, indicates a request for a non-secure token (since this is not a registered application);</li>
        <li><code>1</code>, corresponding to the <b>session</b> AuthSubRequest parameter, indicates a request for a token that can be exchanged for a multi-use (session) token.</li>
      </ul>
      <pre>
function&nbsp;showIntroPage()&nbsp;{
&nbsp;&nbsp;global&nbsp;$itemsFeedURL;

&nbsp;&nbsp;$next_url&nbsp;=&nbsp;'http://'&nbsp;.&nbsp;$_SERVER['HTTP_HOST']&nbsp;.&nbsp;$_SERVER['PHP_SELF'];
&nbsp;&nbsp;$redirect_url&nbsp;=&nbsp;Zend_Gdata_AuthSub::getAuthSubTokenUri($next_url,&nbsp;$itemsFeedURL,&nbsp;0,&nbsp;1);

&nbsp;&nbsp;...
}</pre>
      <p>The remainder of <code>showIntroPage</code> (omitted for brevity) prints the HTML tags to create a table containing this link.</p>
      <h4><a name="exchangeToken" id="exchangeToken"></a>Exchanging the single-session token: <code>exchangeToken()</code></h4>
      <p>After the user authenticates to his Google Account using AuthSub, he is redirected back to the Recipe application page (as a result of the <code>next</code> parameter to <code>AuthSubRequest</code>). The redirection URL will contain one GET parameter: the single-use token granted by AuthSub.</p>
      <p>The <code>exchangeToken()</code> function below is used to exchange the user's single-use token for a multi-use (session) token.  The resulting session token is used for all interaction with the Google Base API: queries, insertions, deletions, updates, and batch commands. <code>exchangeToken()</code> simply calls the <code>Zend_Gdata_AuthSub::getAuthSubSessionToken</code> method <b></b> provided in the Zend client library:</p>
      <pre>
function&nbsp;exchangeToken($token)&nbsp;{
&nbsp;&nbsp;return&nbsp;Zend_Gdata_AuthSub::getAuthSubSessionToken($token);
}</pre>
      <h3><a name="xml" id="xml"></a>Constructing XML requests and parsing XML responses </h3>
      <p>This section describes how the Recipe application builds XML requests to be sent to the Google Base feed for item creation, edits, and batch deletions.</p>
      <h4><a name="itemXML" id="itemXML"></a>Creating the item insertion request: <code>buildNewEntry()</code></h4>
      <p>The <code>buildNewEntry()</code> function is used to construct the XML document that is sent when the user inserts a new recipe. It uses the helper function <code>createOrEditEntry</code>, which formats the POST fields submitted by the user (<code>recipe_title</code>, <code>cuisine</code>, and so forth) into a <code>Zend_Feed_EntryAtom</code> object <b></b>:</p>
      <pre>function&nbsp;createOrEditEntry($entry)&nbsp;{
&nbsp;&nbsp;$newEntry&nbsp;=&nbsp;$entry;

&nbsp;&nbsp;$newEntry-&gt;category['scheme']&nbsp;=&nbsp;'http://base.google.com/categories/itemtypes';
&nbsp;&nbsp;$newEntry-&gt;category['term']&nbsp;=&nbsp;'Recipes';

&nbsp;&nbsp;$newEntry-&gt;title['type']&nbsp;=&nbsp;'text';
&nbsp;&nbsp;$newEntry-&gt;title&nbsp;=&nbsp;$_POST['recipe_title'];

&nbsp;&nbsp;$newEntry-&gt;{'g:cuisine'}&nbsp;=&nbsp;$_POST['cuisine'];
&nbsp;&nbsp;$newEntry-&gt;{'g:item_type'}&nbsp;=&nbsp;'Recipes';
&nbsp;&nbsp;$newEntry-&gt;{'g:item_type'}['type']&nbsp;=&nbsp;'text';

&nbsp;&nbsp;$newEntry-&gt;{'g:cooking_time'}&nbsp;=&nbsp;$_POST['time_val']&nbsp;.&nbsp;'&nbsp;'&nbsp;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_POST['time_units'];
&nbsp;&nbsp;$newEntry-&gt;{'g:cooking_time'}['type']&nbsp;=&nbsp;'intUnit';

&nbsp;&nbsp;$newEntry-&gt;{'g:main_ingredient'}&nbsp;=&nbsp;$_POST['main_ingredient'];
&nbsp;&nbsp;$newEntry-&gt;{'g:main_ingredient'}['type']&nbsp;=&nbsp;'text';

&nbsp;&nbsp;$newEntry-&gt;{'g:serving_count'}&nbsp;=&nbsp;$_POST['serves'];
&nbsp;&nbsp;$newEntry-&gt;{'g:serving_count'}['type']&nbsp;=&nbsp;'number';

&nbsp;&nbsp;$newEntry-&gt;content&nbsp;=&nbsp;$_POST['recipe_text'];

&nbsp;&nbsp;return&nbsp;$newEntry;
}</pre>
      <p><code>buildNewEntry()</code> then calls this function with a new <code>Zend_Feed_EntryAtom</code> object:</p>
      <pre>
function&nbsp;buildNewEntry()&nbsp;{
&nbsp;&nbsp;return&nbsp;createOrEditEntry(new&nbsp;Zend_Feed_EntryAtom());
}</pre>
      <h4><a name="editXML" id="editXML"></a>Creating the item edit request: <code>buildUpdatedEntry()</code></h4>
      <p>The <code>buildUpdatedEntry()</code> function is used to construct the XML document that is sent when the user updates an existing recipe. It also leverages the <code>createOrEditEntry</code> helper function, but it passes an existing <code>Zend_Feed_EntryAtom</code> object instead of a new one:</p>
      <pre>
function&nbsp;buildUpdatedEntry($entry)&nbsp;{
&nbsp;&nbsp;return&nbsp;createOrEditEntry($entry);
}</pre>
      <h4><a name="deleteXML" id="deleteXML"></a>Creating the batch deletion request: <code>buildBatchXML()</code></h4>
      <p>The <code>buildBatchXML()</code> function creates the XML document used to perform a batch deletion request. It formats the links to each item's feed URI (submitted as POST fields when the user clicks the <strong>Delete All</strong> button) into a <code>Zend_Feed_EntryAtom</code> object <b></b> using the <a href="http://code.google.com/apis/base/sample-apps.html#CTbatch">Atom format for batch processing</a>.</p>
      <pre>
function&nbsp;buildBatchXML()&nbsp;{
&nbsp;&nbsp;$counter&nbsp;=&nbsp;0;

&nbsp;&nbsp;$result&nbsp;=&nbsp;&nbsp;'&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;'&nbsp;.&nbsp;&quot;\n&quot;;
&nbsp;&nbsp;$result&nbsp;.=&nbsp;'&lt;feed&nbsp;xmlns=&quot;http://www.w3.org/2005/Atom&quot;'&nbsp;.&nbsp;&quot;\n&quot;;
&nbsp;&nbsp;$result&nbsp;.=&nbsp;'&nbsp;xmlns:g=&quot;http://base.google.com/ns/1.0&quot;'&nbsp;.&nbsp;&quot;\n&quot;;
&nbsp;&nbsp;$result&nbsp;.=&nbsp;'&nbsp;xmlns:batch=&quot;http://schemas.google.com/gdata/batch&quot;&gt;'&nbsp;.&nbsp;&quot;\n&quot;;
&nbsp;&nbsp;foreach($_POST&nbsp;as&nbsp;$key&nbsp;=&gt;&nbsp;$value)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(substr($key,&nbsp;0,&nbsp;5)&nbsp;==&nbsp;&quot;link_&quot;)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$counter++;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newEntry&nbsp;=&nbsp;new&nbsp;Zend_Feed_EntryAtom();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newEntry-&gt;{'id'}&nbsp;=&nbsp;$value;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newEntry-&gt;{'batch:operation'}['type']&nbsp;=&nbsp;'delete';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newEntry-&gt;{'batch:id'}&nbsp;=&nbsp;$counter;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result&nbsp;.=&nbsp;$newEntry-&gt;saveXMLFragment();
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;}
&nbsp;&nbsp;$result&nbsp;.=&nbsp;'&lt;/feed&gt;'&nbsp;.&nbsp;&quot;\n&quot;;

&nbsp;&nbsp;return&nbsp;$result;
}</pre>
      <h3><a name="FeedInteract" id="FeedInteract"></a>Interacting with the Google Base feeds</h3>
      <p>This section describes how the Recipe application interacts with the Google Base feed to retrieve, insert, update, and delete items.</p>
      <h4><a name="queryEntries" id="queryEntries"></a>Retrieving the user's entries</h4>
      <p>The code below, called by <code>showRecipeListPane</code> to create the array of user-entered recipes, uses the <code>Zend_Gdata_AuthSub::getHttpClient</code> method <b></b> to create an HTTP client with the user's authentication token. It then creates a <code>Zend_Gdata</code> object <b></b>, wrapped around this client, and calls <code>getFeed</code> to retrieve the user's items feed. Since <code>getFeed</code> throws an <code>Exception</code> if the feed retrieval fails, the operation is wrapped in a <code>try-catch</code> block:</p>
      <pre>
global&nbsp;$itemsFeedURL;

$client&nbsp;=&nbsp;Zend_Gdata_AuthSub::getHttpClient($token);
$gdata&nbsp;=&nbsp;new&nbsp;Zend_Gdata($client);
try&nbsp;{
&nbsp;&nbsp;$feed&nbsp;=&nbsp;$gdata-&gt;getFeed($itemsFeedURL&nbsp;.&nbsp;&quot;?&quot;);
&nbsp;&nbsp;...
}&nbsp;catch&nbsp;(Exception&nbsp;$e)&nbsp;{
&nbsp;&nbsp;...
}</pre>
      <p>The individual entries in the feed can then be accessed with a <code>foreach</code> loop; the entries' properties can be accessed with functions of the same names, as follows:</p>
      <pre>
foreach&nbsp;($feed&nbsp;as&nbsp;$feed_entry)&nbsp;{
&nbsp;&nbsp;$link_list&nbsp;=&nbsp;$feed_entry-&gt;link();
&nbsp;&nbsp;$href&nbsp;=&nbsp;$link_list[0]-&gt;getAttribute('href');

&nbsp;&nbsp;print&nbsp;&quot;&lt;tr&gt;\n&quot;;
&nbsp;&nbsp;print&nbsp;'&lt;td&nbsp;align=&quot;left&quot;&nbsp;valign=&quot;top&quot;&gt;&lt;b&gt;&lt;a&nbsp;href=&quot;'&nbsp;.&nbsp;$href&nbsp;.&nbsp;'&quot;&gt;'&nbsp;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$feed_entry-&gt;title()&nbsp;.&nbsp;'&lt;/a&gt;&lt;/b&gt;&lt;/td&gt;'&nbsp;.&nbsp;&quot;\n&quot;;
&nbsp;&nbsp;print&nbsp;'&lt;td&nbsp;style=&quot;text-align:center;vertical-align:top&quot;&gt;'&nbsp;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$feed_entry-&gt;cuisine()&nbsp;.&nbsp;'&lt;/td&gt;'&nbsp;.&nbsp;&quot;\n&quot;;
&nbsp;&nbsp;print&nbsp;'&lt;td&nbsp;style=&quot;text-align:center;vertical-align:top&quot;&gt;'&nbsp;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$feed_entry-&gt;serving_count()&nbsp;.&nbsp;'&lt;/td&gt;'&nbsp;.&nbsp;&quot;\n&quot;;
&nbsp;&nbsp;...
}</pre>
      <h4><a name="insertEntry" id="insertEntry"></a>Inserting new entries: <code>postItem()</code></h4>
      <p>The <code>postItem()</code> function inserts a new recipe by performing an HTTP POST on the user's items feed. It uses the <code>Zend_Gdata::post</code> method <b></b> to transmit the XML content of the new entry (created in <code><a href="#itemXML">buildNewEntry()</a></code>, above).</p>
      <pre>
function&nbsp;postItem()&nbsp;{
&nbsp;&nbsp;global&nbsp;$itemsFeedURL;

&nbsp;&nbsp;$client&nbsp;=&nbsp;Zend_Gdata_AuthSub::getHttpClient($_POST['token']);
&nbsp;&nbsp;$gdata&nbsp;=&nbsp;new&nbsp;Zend_Gdata($client);
&nbsp;&nbsp;$response&nbsp;=&nbsp;$gdata-&gt;post(buildNewEntry()-&gt;saveXML(),&nbsp;$itemsFeedURL);

&nbsp;&nbsp;return&nbsp;$response;
}</pre>
      <h4><a name="updateEntry" id="updateEntry"></a>Updating existing entries: <code>updateItem()</code></h4>
      <p>The <code>updateItem</code> function updates an existing recipe by performing an HTTP PUT on that recipe's feed URI. It finds the entry in the user's items feed, then uses the <code>Zend_Feed_EntryAtom::save</code> method <b></b> to transmit the XML content of the updated entry (created in <code><a href="#editXML">buildUpdatedEntry()</a></code>, above).</p>
      <pre>
function&nbsp;updateItem()&nbsp;{
&nbsp;&nbsp;global&nbsp;$itemsFeedURL;

&nbsp;&nbsp;$client&nbsp;=&nbsp;Zend_Gdata_AuthSub::getHttpClient($_POST['token']);
&nbsp;&nbsp;$gdata&nbsp;=&nbsp;new&nbsp;Zend_Gdata($client);

&nbsp;&nbsp;$feed&nbsp;=&nbsp;$gdata-&gt;getFeed($itemsFeedURL&nbsp;.&nbsp;&quot;?&quot;);
&nbsp;&nbsp;foreach&nbsp;($feed&nbsp;as&nbsp;$feed_entry)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($feed_entry-&gt;link('edit')&nbsp;==&nbsp;$_POST['link'])&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updatedEntry&nbsp;=&nbsp;buildUpdatedEntry($feed_entry);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updatedEntry-&gt;save();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;}
}</pre>
      <h4><a name="deleteEntry" id="deleteEntry"></a>Deleting existing entries: <code>deleteItem()</code></h4>
      <p>The <code>deleteItem()</code> function deletes a recipe the user has entered previously by performing an HTTP DELETE on its feed URI. It uses the <code>Zend_Gdata::delete</code> method <b></b> to transmit this request.</p>
      <pre>
function&nbsp;deleteItem()&nbsp;{

&nbsp;&nbsp;$client&nbsp;=&nbsp;Zend_Gdata_AuthSub::getHttpClient($_POST['token']);
&nbsp;&nbsp;$gdata&nbsp;=&nbsp;new&nbsp;Zend_Gdata($client);
&nbsp;&nbsp;$gdata-&gt;delete($_POST['link']);
}</pre>
      <h4><a name="batchCommand" id="batchCommand"></a>Executing a batch command: <code>batchDelete()</code></h4>
      <p>The <code>batchDelete()</code> function deletes all of the user's recipes by issuing a batch request to the Google Base API. This is accomplished by performing an HTTP POST to the batch feed URL, specifying <a href="#deleteXML">the batch XML document</a> as POST data.</p>
      <pre>
function&nbsp;batchDelete()&nbsp;{
&nbsp;&nbsp;global&nbsp;$itemsFeedURL;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;$client&nbsp;=&nbsp;Zend_Gdata_AuthSub::getHttpClient($_POST['token']);
&nbsp;&nbsp;$gdata&nbsp;=&nbsp;new&nbsp;Zend_Gdata($client);
&nbsp;&nbsp;$response&nbsp;=&nbsp;$gdata-&gt;post(buildBatchXML(),&nbsp;$itemsFeedURL&nbsp;.&nbsp;&quot;/batch&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;return&nbsp;$response;
}</pre>
      <h2>Troubleshooting<a name="troubleshooting" id="troubleshooting"></a></h2>
      <p>Can't get the PHP sample code to work on your server? Here are a few suggestions:</p>
      <ul>
        <li>Make sure that the <code>set_include_path</code> call points to the directory where you downloaded the Zend Google Data Client Library.</li>
        <li>Try the <a href="http://framework.zend.com/faq/installation">Zend Framework installation FAQ</a> for additional tips on installing the client library.</li>
      </ul>
    </div>
    <!-- ########## END PAGE CONTENT ########## -->
</div>
<!-- end wrapper -->
<div id="footer">
  <!-- ########## PAGE FOOTER ########## -->
  <div id="footerlogo"><img src="http://www.google.com/images/art.gif" /></div>
  <div id="copyright">
    <p>&copy;2007 Google - <a href="http://www.google.com/privacy.html">Privacy
      Policy</a> - <a href="http://www.google.com/terms_of_service.html">Terms
      and Conditions</a> - <a href="http://www.google.com/about.html">About
      Google</a></p>
  </div>
  <!-- end copyright -->
</div>
<!-- ########## END PAGE FOOTER ########## -->
<p id="date"> Updated on
  <!-- javascript to display the date this page was updated -->
  <script type="text/javascript">
<!-- hide script from old browsers
    var lm = new Date(document.lastModified);
    document.write(lm.toDateString());
//-->
</script>
  <!-- end javascript -->
</p>
<script
  src="http://www.google-analytics.com/urchin.js"
  type="text/javascript">
</script>
<script type="text/javascript">
  _uacct="UA-18071-1";
  urchinTracker();
</script>
</body>
</html>
