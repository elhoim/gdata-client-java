<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Google Spreadsheets Data API Developer's Guide</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="../css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="css/local_extensions.css" />
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../css/ieonly.css" />
<![endif]-->
<style type="text/css">
<!--
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
 	color: #000000;
}
-->
</style>
<script type="text/javascript">
<!--
var cancelBubble = false;

function goTo(url) {
  window.location = url;
}
//-->
</script>
</head>
<body class="t4" id="developers_guide_page">
<a name="top"></a>
<!-- ########## PAGE HEADER ########## -->
<div id="header">
  <div id="logo"><a href="/"><img src="/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Google Spreadsheets Data API </h1>
</div>
<!-- ########## END PAGE HEADER ########## -->
<div id="wrapper">
  <!-- ########## SIDE NAVIGATION ########## -->
  <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
  _uacct = "UA-18071-1";
  urchinTracker();
</script>

<div id="sidenav">
  <ul>
    <li>
      <h1>Spreadsheets </h1>
      <ul>
        <!-- ID tag identifies current page -->
        <li><a href="overview.html" id="overview_link">Overview</a></li>
        <li><a href="developers_guide_protocol.html" id="developers_guide_link">Developer's Guide</a></li>
        <li><a href="reference.html" id="reference_link">Reference Guide</a></li>
        <li><a href="http://www.google.com/google-d-s/terms.html">Terms of Service</a></li>
      </ul>
    </li>
    <li>
      <h1>Google data Protocol</h1>
      <ul>
        <li><a href="../gdata/overview.html">Overview</a></li>
        <li><a href="../gdata/clientlibs.html">Client Libraries</a></li>
        <li><a href="../gdata/auth.html">Authentication</a></li>
      </ul>
    </li>
    <li>
      <h1>Support Resources</h1>
      <ul>
        <li><a href="http://groups.google.com/group/Google-Spreadsheets-Data-API">Discussion Group</a></li>
      </ul>
    </li>
  </ul>
</div>

  <!-- ########## END SIDE NAVIGATION ########## -->
  <!-- ########## PAGE CONTENT ########## -->
<div id="pagecontent">
<h1 id="page_title">Google Spreadsheets Data API Developer's Guide: PHP</h1>

<div id="topnav">
<table id="mt" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<th class="int1" onclick="if (!cancelBubble) goTo('developers_guide_protocol.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_protocol.html">Protocol</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int2" onclick="if (!cancelBubble) goTo('developers_guide_java.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_java.html">Java</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int3" onclick="if (!cancelBubble) goTo('developers_guide_dotnet.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_dotnet.html">.NET</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int4" onclick="if (!cancelBubble) goTo('developers_guide_php.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_php.html">PHP</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int5" onclick="if (!cancelBubble) goTo('developers_guide_python.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_python.html">Python</a></div>
<td width="100%">&nbsp;</td>
</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0" class="st">
<tr>
<td height="4" align="right" style="padding:0px; vertical-align:top">
<div class="stur"></div>
</td>
</tr>
</table>
</div>


<p>The Google Spreadsheets data API allows client applications to view
and update Spreadsheets content in the form of Google data API feeds.
Your client application can request a list of a user's spreadsheets,
edit or delete content in an existing Spreadsheets worksheet, and query
the content in an existing Spreadsheets worksheet.</p>
    <p>In addition to providing some background on the capabilities of the 
Spreadsheets data API, this document provides examples for interacting with 
the API using the <a href="http://framework.zend.com/">Zend Framework PHP Client Library</a>. 
If you're interested in understanding more about the underlying protocol 
used by the PHP Client Library to interact with the Spreadsheets data API, 
please see the <a href="developers_guide_protocol.html">protocol tab</a>.</p>

<h1>Contents</h1>
<ol class="toc">
  <li><a href="#Audience">Audience</a></li>
  <li><a href="#GettingStarted">Getting started</a></li>
  <li><a href="#createSpreadsheet">Create a spreadsheet</a></li>
  <li><a href="#Auth">Authenticating to the Spreadsheets service</a>
    <ol class="toc">
      <li><a href="#AuthClientLogin">Single-user "installed" client
authentication (via HTTP)</a></li>
      <li><a href="#AuthAuthSub">Multiple-user web application client
authentication (via HTTP)</a></li>
      <li><a href="#AuthSubSessionToken">Upgrading to a session token</a></li>
    </ol>
  </li>
  <li><a href="#listSpreadsheets">Get a list of spreadsheets</a></li>
  <li><a href="#listWorksheets">Get a list of worksheets</a></li>
  <li><a href="#listFeedExample">Interacting with list-based feeds</a>
    <ol>
      <li><a href="#listFeeds">Get a list-based feed</a> </li>
      <li><a href="#reverseSortExample">Reverse-sort rows</a></li>
      <li><a href="#listQueryExample">Send a structured query</a></li>
      <li><a href="#addRow">Add a row</a></li>
      <li><a href="#updateRow">Edit a row</a></li>
      <li><a href="#deleteRow">Remove a row</a></li>
    </ol>
  </li>
  <li><a href="#cellsFeedExample">Interacting with cell-based feeds</a>
    <ol>
      <li><a href="#cellFeeds">Get a cell-based feed</a> </li>
      <li><a href="#cellsQueryExample">Send a cell range query</a></li>
      <li><a href="#updateCell">Change contents of a cell</a></li>
    </ol>
  </li>
</ol>
<h1><a name="Audience" id="Audience">Audience</a></h1>
<p>This document is intended for programmers who want to write client
applications using the Zend Gdata PHP client library that can interact
with Google Spreadsheets.</p>
<h1><a name="GettingStarted">Getting started</a></h1>
<p>To use the Zend Gdata PHP client library, you'll need the Zend Framework
1.0 RC1+. See the <a href="http://framework.zend.com/">Zend Framework</a>
for further details. After <a href="http://framework.zend.com/download">downloading
the framework</a>, you'll find the sample explained in this guide in
the <code>demos/Zend/Gdata</code> subdirectory of the distribution. </p>
<p>Run the interactive command-line sample as follows:</p>
<pre>php spreadsheet-ClientLogin.php -- --user=&lt;username&gt; --pass=&lt;password&gt;</pre>
<p>The <code>username</code> and <code>password</code> values are the
same credentials that you use to login to Google Spreadsheets.</p>
<p>The sample performs a number of operations on a worksheet of your
choice to demonstrate the use of the Spreadsheets Data API. Please see
the <code>run</code> method of the code for more details as to which
operations are performed.</p>
<p>To include the examples in this document into your own code, you'll
need to include the Zend Framework library in your include_path and use the following statements:</p>
<pre>require_once 'Zend/Loader.php';<br>Zend_Loader::loadClass('Zend_Http_Client');<br>Zend_Loader::loadClass('Zend_Gdata');<br>Zend_Loader::loadClass('Zend_Gdata_ClientLogin');<br>Zend_Loader::loadClass('Zend_Gdata_Spreadsheets');<br></pre>
<p>The <code>Zend_Gdata_Spreadsheets</code>
class represents a client connection (with optional authentication credentials) to a
Spreadsheets service. The general procedure for sending a query to a
service using the client library consists of the following steps:</p>
<ol>
  <li>Obtain or construct the appropriate feed URL.</li>
  <li>If you're sending data to a service (for example, if you're
inserting a new entry), then create objects out of the raw data using
the client library classes. (This step doesn't apply if you're just
requesting a feed, as we're doing in this example.)</li>
  <li>Create a new <code>Zend_Http_Client</code>
instance with the appropriate authentication method and credentials.  
This is done using the factory methods available in <code>Zend_Gdata_ClientLogin</code> and 
<code>Zend_Gdata_AuthSub</code>. </li>
  <li>Create a new <code>Zend_Gdata_Spreadsheets</code> instance with
the <code>Zend_Http_Client</code>
instance.</li>
  <li>Call a method to send the request and receive any results.</li>
</ol>
<h1><a name="createSpreadsheet" id="createSpreadsheet">Create a
spreadsheet</a></h1>
<p>The Spreadsheets data API does not currently provide a way to create
or delete a spreadsheet. For testing purposes, we recommend that you
create a spreadsheet manually.</p>
<h1><a name="Auth">Authenticating to the Spreadsheets service</a></h1>
<p>The Zend Gdata client library can be used to work with either public
or private feeds. Public feeds are read-only, but do not require any
authentication. Private feeds require that you authenticate to the
Spreadsheets servers. This can be done via <a href="#AuthClientLogin">ClientLogin</a>
username/password authentication or <a href="#AuthAuthSub">AuthSub</a>
proxy authentication.</p>
<p>Please see the <a href="../gdata/auth.html">authentication
documentation</a> for more information on AuthSub and ClientLogin.</p>
<h2><a name="AuthClientLogin" id="AuthClientLogin">Single-user
"installed" client authentication (via HTTP)</a></h2>
<p>To use ClientLogin (also called "Authentication for Installed
Applications"), invoke the <code>getHttpClient</code>
method of <code>Zend_Gdata_ClientLogin</code>, specifying the ID and
password of the user on whose behalf your client is sending the query,
along with the name of the Spreadsheets service. Then, use the
<code>HttpClient</code> returned by this method to construct a <code>Zend_Gdata_Spreadsheets</code>
object. For example:</p>
<pre>$authService = Zend_Gdata_Spreadsheets::AUTH_SERVICE_NAME;<br>$httpClient = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $authService);<br>$gdClient = new Zend_Gdata_Spreadsheets($httpClient);</pre>
<p>For more information about authentication systems, see the <a
 href="/apis/accounts/Authentication.html">Google
Account Authentication</a> documentation.</p>
<h2><a name="AuthAuthSub" id="AuthAuthSub">Multiple-user web
application client authentication (via HTTP)</a></h2>
<p>AuthSub proxy authentication is used by web applications which need
to authenticate their users to Google accounts. The operator does not
need access to the username and password for the Spreadsheets user -
only special AuthSub tokens are required. Please see the AuthSub
documentation for more detailed information.</p>
<p>When the user first visits your application, they have not yet been
authenticated. In this case, you need to print some text and and a link
directing the user to Google to authenticate your request for access to
their spreadsheets. The Zend Framework PHP Google data client library provides a
function to generate this URL. The code below sets up a link to the
AuthSubRequest
page.</p>
<pre>function getAuthSubUrl() {<br>    $next = 'http://www.coolspreadsheetsite.com/welcome.php';<br>    $scope = 'http://spreadsheets.google.com';<br>    $secure = false;<br>    $session = true;<br>    return Zend_Gdata_AuthSub::getAuthSubTokenUri($next, $scope, $secure, $session);<br>}<br><br>$authSubUrl = getAuthSubUrl();<br>echo '&lt;a href="' . $authSubUrl . '"&gt;Click here to authenticate&lt;/a&gt;'; </pre>
<p>Notice the parameters sent to the <code>getAuthSubTokenUri</code>
method:</p>
<ul>
  <li><b>$next</b>, the URL of the page that Google should redirect the
user to after authentication.</li>
  <li><b>$scope</b>, indicating that the application will only access
Spreadsheets feeds.</li>
  <li><b>$secure</b>, indicating that the token returned will not be a
secure token.</li>
  <li><b>$session</b>, indicating this token can be exchanged for a
multi-use (session) token.</li>
</ul>
<p>The URL will look something like this:</p>
<p> </p>
<pre>https://www.google.com/accounts/AuthSubRequest?scope=http%3A%2F%2Fspreadsheets.google.com%2Ffeeds%2F&amp;session=1&amp;secure=0&amp;next=http%3A%2F%2Fwww.coolspreadsheetsite.com%2Fwelcome.php</pre>
<p>The user will then follow the link to Google's site and authenticate
to their Google account.</p>
<p>After the user authenticates, they will be redirected back to the <code>next</code>
URL. The URL will have a single-use token value appended to it as a
query parameter. The URL the user will be redirected to will look
something like this: </p>
<pre>http://www.coolspreadsheetsite.com/welcome.php?token=14a87fe98219731acd516</pre>
<h2><a name="AuthSubSessionToken" id="AuthSubSessionToken">Upgrading to a session token</a></h2>
<p>For security, this token is single-use only, so now we need to
exchange this single-use token for a session token. The following code
snippet shows how to upgrade the token.</p>
<pre>$sessionToken = Zend_Gdata_AuthSub::getAuthSubSessionToken($_GET['token']);</pre>
<p>In this snippet, the <code>$_GET['token']</code> <code></code>
variable contains
the value from the <code>token</code> query parameter in the
URL.&nbsp; This token value represents a single-use AuthSub token.
Since we
specified <code>$</code><code>session = true</code> above, this token
can be
exchanged for an AuthSub session token, as is being done above.</p>
<h1><a name="listSpreadsheets" id="listSpreadsheets">Get a list of
spreadsheets</a></h1>
<p>You can get a feed containing a list of the currently authenticated
user's spreadsheets by using the <code>Zend_Gdata_Spreadsheets-&gt;getSpreadsheetFeed()</code> method.
<p>The result is a "meta-feed," a feed that lists all of that user's
spreadsheets; each entry in the feed represents a spreadsheet
associated with the user. This feed is accessible only when using
an authenticated client.</p>
<p>The following method from the sample code retrieves the list of spreadsheets, prints out the names of the spreadsheets and prompts the user to select a spreadsheet from the list:</p>
<pre>public function promptForSpreadsheet()<br>{<br>    $feed = $this-&gt;gdClient-&gt;getSpreadsheetFeed();<br>    $this-&gt;printFeed($feed);<br>    $input = getInput("\nSelection");<br>    $currKey = split('/', $feed-&gt;entries[$input]-&gt;id-&gt;text);<br>    $this-&gt;currKey = $currKey[5];<br>}</pre>
<p>The resulting <code>Zend_Gdata_Spreadsheets_SpreadsheetFeed</code>
object <code>feed</code> represents a response from the server. Among
other things, this feed contains a list of <code>Zend_Gdata_Spreadsheets_SpreadsheetEntry</code>
objects (<code>$feed-&gt;entries</code>), each of which represents a
single
spreadsheet. <code>Zend_Gdata_Spreadsheets_SpreadsheetEntry</code>
encapsulates the
information shown in <a
 href="developers_guide_protocol.html#listSpreadsheets">the protocol
document</a>.</p>
<p>The <code>printFeed</code> definition is as follows:</p>
<pre>public function printFeed($feed)<br>{<br>    $i = 0;<br>    foreach($feed-&gt;entries as $entry) {<br>        if ($entry instanceof Zend_Gdata_Spreadsheets_CellEntry) {<br>            print $entry-&gt;title-&gt;text .' '. $entry-&gt;content-&gt;text . "\n";<br>        } else if ($entry instanceof Zend_Gdata_Spreadsheets_ListEntry) {<br>            print $i .' '. $entry-&gt;title-&gt;text .' '. $entry-&gt;content-&gt;text . "\n";<br>        } else {<br>            print $i .' '. $entry-&gt;title-&gt;text . "\n";<br>        }<br>        $i++;<br>    }<br>}</pre>
<p>The value returned from <code>promptForSpreadsheet</code> is the <i>key</i>
of the spreadsheet at the selected index. The <i>key</i> is the
permanent unique ID of a specific worksheet within the spreadsheet. The
<i>key</i> is the last value in the path of the <code>id</code>
(corresponding to the &lt;id&gt; element in the spreadsheet entry)
attribute of the <code>Zend_Gdata_Spreadsheets_SpreadsheetEntry</code>
object.</p>
<p>
These methods would be equivalent to performing a HTTP request for the following URL, parsing the response and outputting the value of the <code>&lt;title&gt;</code> elements.
</p>
<pre>http://spreadsheets.google.com/feeds/spreadsheets/private/full</pre>
<h1><a name="listWorksheets" id="listWorksheets">Get a list of
worksheets</a></h1>
<p>A given spreadsheet may contain multiple worksheets. For each
spreadsheet, there's a <code>worksheets</code> metafeed listing all
the worksheets in that spreadsheet.</p>
<p>Given a <i>key</i> from the <code>&lt;id&gt;</code> of
<code>Zend_Gdata_Spreadsheets_SpreadsheetEntry</code> object you've
already
retrieved, you can print a list of all worksheets
and prompt for a selection as follows:</p>
<pre>public function promptForWorksheet()<br>{<br>    $query = new Zend_Gdata_Spreadsheets_DocumentQuery();<br>    $query-&gt;setSpreadsheetKey($this-&gt;currKey);<br>    $feed = $this-&gt;gdClient-&gt;getWorksheetFeed($query);<br>    $this-&gt;printFeed($feed);<br>    $input = getInput("\nSelection");<br>    $currWkshtId = split('/', $feed-&gt;entries[$input]-&gt;id-&gt;text);<br>    $this-&gt;currWkshtId = $currWkshtId[8];<br>}</pre>
<p>The resulting <code>Zend_Gdata_Spreadsheets_WorksheetFeed</code>
object <code>feed</code> represents a response from the server. Among
other things, this feed contains a list of
<code>Zend_Gdata_Spreadsheets_WorksheetEntry</code>
objects (<code>$feed-&gt;entries</code>), each of which represents a
single worksheet. <code>Zend_Gdata_Spreadsheets_WorksheetEntry</code>
encapsulates
the
information shown in <a
 href="developers_guide_protocol.html#listWorksheets">the protocol
document</a>.</p>
<p>The rertieval of the "meta-feed" is equivalent to sending an
authenticated <code>GET</code> request to the URL:</p>
<pre>http://spreadsheets.google.com/feeds/worksheets/<i>worksheetId</i>/private/full</pre>
<p>The value returned from <code>promptForWorksheet</code> is the <i>worksheetId</i>
of the worksheet at the selected index. The <i>worksheetId</i> is the
permanent unique ID of a specific worksheet within the spreadsheet. The
<i>worksheetId</i> is the last value in the path of the <code>id</code>
(corresponding to the &lt;id&gt; element in the worksheet entry)
attribute of the <code>Zend_Gdata_Spreadsheets_WorksheetEntry</code>
object.</p>
<h1><a name="listFeedExample" id="listFeedExample">Interacting with
list-based feeds</a></h1>
<p>A given worksheet generally contains multiple rows, each containing
multiple cells. You can request data from the worksheet either as a
list-based feed, in which each entry represents a row, or as a
cell-based feed, in which each entry represents a single cell. For
information on cell-based feeds, see <a href="#cellsFeedExample">Interacting
with cell-based feeds</a>.</p>
<p>The following sections describe how to get a list-based feed, add a
row to a worksheet, and send queries with various query parameters.</p>
<p>The list feed makes some assumptions about how the data is laid out
in the spreadsheet.</p>
<p>In particular, the list feed treats the first row of the worksheet
as a header row; Spreadsheets dynamically creates XML elements named
after the contents of header-row cells. Users who want to provide GData
feeds should not put any data other than column headers in the first
row of a worksheet.</p>
<p>The list feed contains all rows after the first row up to the first
blank row. The first blank row terminates the data set. If expected
data isn't appearing in a feed, check the worksheet manually to see
whether there's an unexpected blank row in the middle of the data. In
particular, if the second row of the spreadsheet is blank, then the
list feed will contain no data.</p>
<p>A row in a list feed is as many columns wide as the worksheet itself.</p>
<h2><a name="listFeeds" id="listFeeds">Get a list-based feed</a></h2>
<p>To retrieve a worksheet's list feed, you might do the following.
Here, we are assuming that the $this-&gt;gdClient<code></code> is an
authenticated <code>Zend_Gdata_Spreadsheets</code> object,
$this-&gt;currKey is a valid unique ID for a spreadhseet that the user
has access to, and $this-&gt;currWkshtId <code></code> is a valid
unique ID for a worksheet in the
spreadsheet corresponding to the provided $this-&gt;currKey.</p>
<pre>public function listGetAction()<br>{<br>    $query = new Zend_Gdata_Spreadsheets_ListQuery();<br>    $query-&gt;setSpreadsheetKey($this-&gt;currKey);<br>    $query-&gt;setWorksheetId($this-&gt;currWkshtId);<br>    $this-&gt;listFeed = $this-&gt;gdClient-&gt;getListFeed($query);<br>    $this-&gt;printFeed($this-&gt;listFeed);<br>}</pre>
<p>The resulting <code>Zend_Gdata_Spreadsheets_ListFeed</code> object
$this-&gt;listfeed represents a response from the server. Among other
things, this feed
contains an array of <code>Zend_Gdata_Spreadsheets_ListEntry</code>
objects (<code>$this-&gt;listFeed-&gt;entries</code>),
each of which represents a single row in a worksheet. The
<code>Zend_Gdata_Spreadsheets_ListEntry</code> encapsulates the
information shown in
<a href="">the protocol document</a>.
</p>
<p>This code is equivalent to sending an authenticated <code>GET</code>
request to the URL:</p>
<pre>http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full</pre>
<h2><a name="reverseSortExample" id="reverseSortExample">Reverse-sort
rows</a></h2>
<p>By default, rows in the feed appear in the same order as the
corresponding rows in the GUI; that is, they're in order by row number.
To get rows in reverse order, set the <code>reverse</code> properties
of the <code>Zend_Gdata_Spreadsheets_ListQuery</code> object to <code>true</code>:</p>
<pre>$query-&gt;reverse = 'true';</pre>
<p>This is equivalent to sending an authenticated <code>GET</code>
request to the URL:</p>
<pre>http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full?reverse=true</pre>
<p>Note that if you want to order (or reverse sort) by a particular
column, rather than by position in the worksheet, you can set the <code>orderby</code>
value of the <code>Zend_Gdata_Spreadsheets_ListQuery</code><code></code>
object to <code>column:</code><i>&lt;the
header of that column&gt;</i>. This is analogous to adding an <code>orderby</code>
query parameter in the outbound <code>GET</code> request. </p>
<h2><a name="listQueryExample" id="listQueryExample">Send a structured
query</a></h2>
<p>You can set a <code>Zend_Gdata_Spreadsheets_ListQuery</code><code></code>'s
<code>sq</code>
value to produce a feed with entries that meet the specified criteria.
For example, suppose you have a worksheet containing personnel data, in
which each row represents information about a single person. You wish
to retrieve all rows in which the person's name is "John" and the
person's age is over 25. To do so, you would set <code>sq</code> as
follows:</p>
<pre>$query-&gt;spreadsheetQuery = 'name=John and age&gt;25';</pre>
<p>This is equivalent to sending an authenticated <code>GET</code>
request to the URL:</p>
<pre>http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full?sq=name%3DJohn%20and%20age%3E25</pre>
<p>For more information about the structured query syntax, see the <a
 href="reference.html#list_Parameters">List-feed query parameters</a>
reference section.</p>
<h2><a name="addRow" id="addRow">Add a row</a></h2>
<p>To insert a new row in a list feed, assuming that the <code>$this-&gt;gdClient</code>
is an authenticated <code>Zend_Gdata_Spreadsheets</code><code></code>
object, $this-&gt;currKey is a valid unique ID for a spreadsheet that
the user has access to, and $this-&gt;currWkshtId<code></code> is a
valid unique ID
for a worksheet in the spreadsheet corresponding to the provided
$this-&gt;currKey,
do the following:</p>
<pre>public function listInsertAction($rowData)<br>{<br>    $rowArray = $this-&gt;stringToArray($rowData);<br>    $entry = $this-&gt;gdClient-&gt;insertRow($rowArray, $this-&gt;currKey, $this-&gt;currWkshtId);<br>    if ($entry instanceof Zend_Gdata_Spreadsheets_ListEntry) {<br>        echo "Success!\n";<br>    }<br>}</pre>
<p>Notice that the <code>insertRow</code> definition takes a
dictionary where the <i>key</i> corresponds to the column name and the
<i>value</i> corresponds to the value of that column in the new row.</p>
<p>To parse the input string into a map the following <code>stringToArray</code>
definition is used.</p>
<pre>public function stringToArray($rowData)<br>{<br>    $arr = array();<br>    foreach ($rowData as $row) {<br>        $temp = split('=', $row);<br>        $arr[$temp[0]] = $temp[1];<br>    }<br>    return $arr;<br>}</pre>
<p>Spreadsheets inserts the new row immediately after the last row that
appears in the list-based feed, which is to say immediately before the
first entirely blank row. This code is equivalent to sending an
authenticated <code>POST</code> request to the URL:</p>
<pre>http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full</pre>
<p>with the corresponding XML document in the <code>POST</code> body.</p>
<h2><a name="updateRow" id="updateRow">Edit a row</a></h2>
<p>To update an existing row in a list feed, assuming that <code>gd_client</code>
is an authenticated <code>Zend_Gdata_Spreadsheets</code>
object, <code>$this-&gt;currKey</code> is a valid unique ID for a
spreadsheet that
the user has access to, and <code>$this-&gt;currWkshtId</code> is a
valid unique ID
for a worksheet in the corresponding to the provided <code>$this-&gt;currKey,
</code>do the following:</p>
<pre>public function listUpdateAction($index, $rowData)<br>{<br>    $query = new Zend_Gdata_Spreadsheets_ListQuery();<br>    $query-&gt;setSpreadsheetKey($this-&gt;currKey);<br>    $query-&gt;setWorksheetId($this-&gt;currWkshtId);<br>    $this-&gt;listFeed = $this-&gt;gdClient-&gt;getListFeed($query);<br>    $rowArray = $this-&gt;stringToArray($rowData);<br>    $entry = $this-&gt;gdClient-&gt;updateRow($this-&gt;listFeed-&gt;entries[$index], $rowArray);<br>    if ($entry instanceof Zend_Gdata_Spreadsheets_ListEntry) {<br>        echo "Success!\n";<br>    }<br>}</pre>
<p>Notice that the <code>updateRow</code> definition takes a <code>Zend_Gdata_Spreadsheets_SpreadsheetEntry</code>
object which corresponds to an existing list entry, and an array where
the <i>key</i> corresponds to the column name and the <i>value</i>
corresponds to the value of that column in the new row.</p>
<p>This is equivalent to sending an authenticated <code>PUT</code>
request to the entry's edit link with the updated XML as <code>PUT</code>
data.</p>
<h2><a name="deleteRow" id="deleteRow">Remove a row</a></h2>
<p>To delete a row, simply invoke <code>deleteRow</code>
on the <code>Zend_Gdata_Spreadsheets</code> object with the existing
entry
to be deleted:</p>
<pre>public function listDeleteAction($index)<br>{<br>    $query = new Zend_Gdata_Spreadsheets_ListQuery();<br>    $query-&gt;setSpreadsheetKey($this-&gt;currKey);<br>    $query-&gt;setWorksheetId($this-&gt;currWkshtId);<br>    $this-&gt;listFeed = $this-&gt;gdClient-&gt;getListFeed($query);<br>    $this-&gt;gdClient-&gt;deleteRow($this-&gt;listFeed-&gt;entries[$index]);<br>}</pre>
<p>To delete a row, perform a DELETE request on the edit URL after
obtaining it as described above.</p>
<p class="note"><strong>Note</strong>: If you delete a row, that row is
completely removed from the worksheet.</p>
<h1><a name="cellsFeedExample" id="cellsFeedExample">Interacting with
cell-based feeds</a></h1>
<p>In a cell-based feed, each entry represents a single cell.</p>
<p>Note that we don't recommend interacting with both a cell-based feed
and a list-based feed for the same worksheet at the same time.</p>
<h2><a name="cellFeeds" id="cellFeeds">Get a cell-based feed</a></h2>
<p>To retrieve a worksheet's cell-based feed, you might do the
following. Again, we are assuming that <code>$this-&gt;gdClient</code>
is an authenticated <code>Zend_Gdata_Spreadsheets</code><code></code>
object, <code>$this-&gt;currKey </code>is a valid unique ID for a
spreadsheet that
the user has access to, and <code>$this-&gt;currWkshtId</code><code></code>
is a valid unique ID
for a worksheet in the spreadsheet corresponding to the provided <code>$this-&gt;currKey.</code></p>
<pre>public function cellsGetAction()<br>{<br>    $query = new Zend_Gdata_Spreadsheets_CellQuery();<br>    $query-&gt;setSpreadsheetKey($this-&gt;currKey);<br>    $query-&gt;setWorksheetId($this-&gt;currWkshtId);<br>    $feed = $this-&gt;gdClient-&gt;getCellFeed($query);<br>    $this-&gt;printFeed($feed);<br>}</pre>
<h2><a name="cellsQueryExample" id="cellsQueryExample">Send a cell
range query</a></h2>
<p>Suppose you wanted to retrieve the cells in the first column of a
worksheet. You can request a cell feed containing only this column as
follows:</p>
<pre>$query = new Zend_Gdata_Spreadsheets_CellQuery();<br>$query-&gt;setSpreadsheetKey($this-&gt;currKey);<br>$query-&gt;setWorksheetId($this-&gt;currWkshtId);<br>$query-&gt;setMinCol(1);<br>$query-&gt;setMaxCol(1);<br>$query-&gt;setMinRow(2);<br>$feed = $gdClient-&gt;getCellFeed($query);</pre>
<p>This requests all the data in column 1, starting with row 2.</p>
<p>Setting the <code>'MinCol', 'MaxCol', 'MinRow',</code> and <code>'MaxRow'</code>
values of a <code>Zend_Gdata_Spreadsheets_CellQuery</code> object is
equivalent to providing values for the paramaeters <code>min-col,
max-col, min-row,</code> and <code>max-row</code> (respectively) in
the HTTP GET request.</p>
<h2><a name="updateCell" id="updateCell">Change contents of a cell</a></h2>
<p>To modify the contents of a cell, call updateCell with the row,
column, and new value of the cell.<br>
</p>
<pre>public function cellsUpdateAction($row, $col, $inputValue)<br>{<br>    $entry = $this-&gt;gdClient-&gt;updateCell($row, $col, $inputValue, <br>            $this-&gt;currKey, $this-&gt;currWkshtId);<br>    if ($entry instanceof Zend_Gdata_Spreadsheets_CellEntry) {<br>        echo "Success!\n";<br>    }<br>}</pre>
<p>This is equivalent to sending an authenticated <code>PUT</code>
request with the updated cell's XML representation to the URL:</p>
<pre>PUT http://spreadsheets.google.com/feeds/cells/<i>key</i>/<i>worksheetId</i>/private/full/<i>cell</i>/<i>version</i></pre>
<p>The new data is placed in the specified cell in the worksheet. If
the specified cell contains data already, it will be overwritten.</p>
<p class="note"><strong>Note</strong>: Use <code>updateCell</code>
(ie., HTTP PUT) to change the data in a cell, even if it is empty; the
use of <code>POST</code> on empty cells is no longer recommended. To
clear a cell, send an empty string as the inputValue instead of using a
DELETE.</p>
<p class="backtotop"><a href="#top">Back to top</a></p>
</div>
  <!-- ########## END PAGE CONTENT ########## -->
</div>
<!-- end wrapper -->
<!-- ########## PAGE FOOTER ########## -->
<div id="footer">
  <div id="footerlogo"><img src="http://www.google.com/images/art.gif" alt="" /></div>
  <div id="copyright">
    <p>&copy; Google Inc. 2006 - <a href="http://www.google.com/privacy.html">Privacy Policy</a> - <a href="http://www.google.com/terms_of_service.html">Terms and Conditions</a> - <a href="http://www.google.com/about.html">About Google</a></p>

  </div>
  <!-- end copyright -->
</div>
<!-- ########## END PAGE FOOTER ########## -->
<p id="date">Last modified:
<script type="text/javascript">
  <!--
  var lm = new Date(document.lastModified);
  document.write(lm.toDateString());
  //-->
</script>
</p>
</body>
</html>
