<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Google Spreadsheets Data API Developer's Guide</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="../css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="css/local_extensions.css" />
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../css/ieonly.css" />
<![endif]-->
<style type="text/css">
<!--
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
 	color: #000000;
}
-->
</style>
<script type="text/javascript">
<!--
var cancelBubble = false;

function goTo(url) {
  window.location = url;
}
//-->
</script>
</head>
<body class="t3" id="developers_guide_page">
<a name="top"></a>
<!-- ########## PAGE HEADER ########## -->

<div id="header">
  <div id="logo"><a href="http://code.google.com/"><img src="http://code.google.com/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Google Spreadsheets Data API</h1>
</div>
<!-- ########## END PAGE HEADER ########## -->
<div id="wrapper"> 
  <!-- ########## SIDE NAVIGATION ########## -->
  <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
  _uacct = "UA-18071-1";
  urchinTracker();
</script>

<div id="sidenav">
  <ul>
    <li>
      <h1>Spreadsheets </h1>
      <ul>
        <!-- ID tag identifies current page -->
        <li><a href="overview.html" id="overview_link">Overview</a></li>
        <li><a href="developers_guide_protocol.html" id="developers_guide_link">Developer's Guide</a></li>
        <li><a href="reference.html" id="reference_link">Reference Guide</a></li>
        <li><a href="http://www.google.com/google-d-s/terms.html">Terms of Service</a></li>
      </ul>
    </li>
    <li>
      <h1>Google data Protocol</h1>
      <ul>
        <li><a href="../gdata/overview.html">Overview</a></li>
        <li><a href="../gdata/clientlibs.html">Client Libraries</a></li>
        <li><a href="../gdata/auth.html">Authentication</a></li>
      </ul>
    </li>
    <li>
      <h1>Support Resources</h1>
      <ul>
        <li><a href="http://groups.google.com/group/Google-Spreadsheets-Data-API">Discussion Group</a></li>
      </ul>
    </li>
  </ul>
</div>

  <!-- ########## END SIDE NAVIGATION ########## -->
  <!-- ########## PAGE CONTENT ########## -->
<div id="pagecontent"> 
    <h1 id="page_title">Google Spreadsheets Data API Developer's Guide: .NET</h1>

<div id="topnav">
<table id="mt" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<th class="int1" onclick="if (!cancelBubble) goTo('developers_guide_protocol.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_protocol.html">Protocol</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int2" onclick="if (!cancelBubble) goTo('developers_guide_java.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_java.html">Java</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int3" onclick="if (!cancelBubble) goTo('developers_guide_dotnet.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_dotnet.html">.NET</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int4" onclick="if (!cancelBubble) goTo('developers_guide_php.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_php.html">PHP</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int5" onclick="if (!cancelBubble) goTo('developers_guide_python.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_python.html">Python</a></div>
<td width="100%">&nbsp;</td>
</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0" class="st">
<tr>
<td height="4" align="right" style="padding:0px; vertical-align:top">
<div class="stur"></div>
</td>
</tr>
</table>
</div>


    <p>The Google Spreadsheets data API allows client applications to view and update Spreadsheets content in the form of Google data API feeds. Your client application can request a list of a user's spreadsheets, edit or delete content in an existing Spreadsheets worksheet, and query the content in an existing Spreadsheets worksheet.</p>
    <p>In addition to providing some background on the capabilities of the Spreadsheets data API, this document provides examples for interacting with the API using the <a href="http://code.google.com/p/google-gdata/">.NET client library</a>. If you're interested in understanding more about the underlying protocol used by the .NET Client Library to interact with the Spreadsheets data API, please see the <a href="developers_guide_protocol.html">protocol tab</a>.</p>

    <h1>Contents</h1>
    <div class="toc">
    <ol>
      <li><a href="#Audience">Audience</a></li>
      <li><a href="#GettingStarted">Getting started</a></li>
      <li><a href="#createSpreadsheet">Create a spreadsheet</a></li>
      <li><a href="#Auth">Authenticating to the Spreadsheets service</a> 
        <ol class="toc">
          <li><a href="#AuthClientLogin">Single-user "installed" client authentication</a></li>
          <li><a href="#AuthAuthSub">Multiple-user web application client authentication</a></li>
          <li><a href="#AuthSubSessionToken">Upgrading to a session token</a></li>
        </ol>
      </li>
      <li><a href="#listSpreadsheets">Get a list of spreadsheets</a></li>
      <li><a href="#listWorksheets">Get a list of worksheets</a></li>
      <li><a href="#listFeedExample">Interacting with list-based feeds</a>
        <ol>
          <li><a href="#listFeeds">Get a list-based feed</a> </li>
          <li><a href="#reverseSortExample">Reverse-sort rows</a></li>
          <li><a href="#listQueryExample">Send a structured query</a></li>
          <li><a href="#addRow">Add a row</a></li>
          <li><a href="#updateRow">Edit a row</a></li>
          <li><a href="#deleteRow">Remove a row</a></li>
        </ol>

      </li>
      <li><a href="#cellsFeedExample">Interacting with cell-based feeds</a>
        <ol>
          <li><a href="#cellFeeds">Get a cell-based feed</a> </li>
          <li><a href="#cellsQueryExample">Send a cell range query</a></li>
          <li><a href="#updateCell">Change contents of a cell</a></li>
        </ol>
      </li>
    </ol>
    </div>
    <h1><a name="Audience" id="Audience">Audience</a></h1>
    <p>This document is intended for programmers who want to write client applications using the Google data .NET client library that can interact with Google Spreadsheets.</p>
    <h1><a name="GettingStarted">Getting started</a></h1>
    <p>To use the .NET client library, you'll need the .NET 1.1 runtime, and you should also be current on all patches. After <a href="http://code.google.com/p/google-gdata/downloads/list">downloading the client library</a>, you'll find the DLLs you need to get started in the <code>lib/Release</code> subdirectory of the distribution.
    <p>A full working copy of this sample is available in the <a href="http://code.google.com/p/google-gdata/">Google data project</a> in the project hosting section of code.google.com. The sample is located at <a href="http://google-gdata.googlecode.com/svn/trunk/clients/cs/samples/spreadsheets/console/SpreadsheetDemo.cs">/trunk/clients/cs/samples/spreadsheets/console/SpreadsheetDemo.cs</a> in the SVN repository accessible from the Source tab.</p>
    <p>After compiling the sample, run it as follows:</p>
    <pre>SpreadsheetDemo &lt;userName&gt; &lt;password&gt;</pre>
    <p>The <code>userName</code> and <code>password</code> values are the same credentials that you use to login to Google Spreadsheets.</p>
    <p>The sample performs a number of operations on a worksheet of your choice to demonstrate the use of the Spreadsheets Data API.  Please see the <code>RunSample</code> method of the code for more details as to which operations are performed.</p>
    <p>To compile the examples in this document into your own code, you'll need the following <code>using</code> statements:</p>
    <pre>using Google.GData.Client;
using Google.GData.Extensions;
using Google.GData.Spreadsheets;</pre>
    <p>The <a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.SpreadsheetsService.html"><code>SpreadsheetsService</code></a> class represents a client connection (with authentication) to a Spreadsheets service. The general procedure for sending a query to a service using the client library consists of the following steps:</p> 
    <ol>
      <li>Obtain or construct the appropriate URL.</li> 
      <li>If you're sending data to a service (for example, if you're inserting a new entry), then transform the raw data into objects using the client library classes. (This step doesn't apply if you're just requesting a feed, as in this example.)</li> 
      <li>Create a new <code>SpreadsheetsService</code> instance, setting your application's name (in the form <code><i>companyName</i>-<i>applicationName</i>-<i>versionID</i></code>).</li> 
      <li>Set the appropriate credentials.</li> 
      <li>Call a method to send the request and receive any results.</li> 
    </ol> 
    <h1><a name="createSpreadsheet" id="createSpreadsheet">Create a spreadsheet</a></h1>
    <p>The Spreadsheets data API does not currently provide a way to create or delete a spreadsheet. For testing purposes, you'll need to create a spreadsheet manually.</p>
    <h1><a name="Auth">Authenticating to the Spreadsheets service</a></h1>
    <p>The .NET client library can be used to work with either public or private feeds.  Public feeds are read-only, but do not require any authentication.  Private feeds require that you authenticate to the spreadsheets servers.  This can be done via <a href="#AuthClientLogin">ClientLogin</a> username/password authentication or <a href="#AuthAuthSub">AuthSub</a> proxy authentication.</p>
    <p>Please see the <a href="../gdata/auth.html">authentication documentation</a> for more information on AuthSub and ClientLogin.</p>
    <h2><a name="AuthClientLogin" id="AuthClientLogin">Single-user "installed" client authentication</a></h2>
    <p>To use ClientLogin (also called &quot;Authentication for Installed Applications&quot;), invoke the <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Client.Service.setUserCredentials.html">setUserCredentials</a></code> method of <code>SpreadsheetsService</code>, specifying the ID and password of the user on whose behalf your client is sending the query. For example:</p>
    <pre>SpreadsheetsService myService = new SpreadsheetsService("exampleCo-exampleApp-1");
myService.setUserCredentials("jo@gmail.com", "mypassword");</pre>
    <p>For more information about authentication systems, see the <a href="http://code.google.com/apis/accounts/Authentication.html">Google Account Authentication</a> documentation.</p>
    <h2><a name="AuthAuthSub" id="AuthAuthSub">Multiple-user web application client authentication</a></h2>
    <p>As of version 1.09 of the .NET client library, it is possible for applications to authenticate using the AuthSub login protocol.  This is useful, for example, if you have an ASP application that requires Spreadsheets authentication.</p>
    <p>To acquire an AuthSub token for a given user and a given service, your application must redirect the user to the AuthSubRequest URL, which prompts them to log into their Google account. (For more information on the AuthSubRequest URL, see the <a href="http://code.google.com/apis/accounts/AuthForWebApps.html">AuthSub documentation</a>.)</p>
    <p>Suppose the following ASP hyperlink is defined in our page:</p>
    <pre>&lt;asp:HyperLink ID="GotoAuthSubLink" runat="server"/&gt;</pre>
    <p>To construct the AuthSubRequest URL for your application, make a .NET client library call as follows:</p>
    <pre>GotoAuthSubLink.Text = "Login to your Google Account";
GotoAuthSubLink.NavigateUrl = AuthSubUtil.getRequestUrl("http://www.example.com/RetrieveToken",
                                                        "http://spreadsheets.google.com/feeds/",
                                                        false,
                                                        true);</pre>
     <p>The <code>getRequestUrl</code> method takes several parameters (corresponding to the query parameters used by the AuthSubRequest handler): the &quot;next&quot;  URL (which is the URL that Google  will redirect to after the user logs into their account and grants access); the scope (as determined in the previous section); and two Booleans, one to indicate whether the token will be used in registered mode or not, and one to indicate whether the token will later be exchanged for a session token or not. The above example shows a call in unregistered mode (the first Boolean is <code>false</code>), for a token that will be exchanged for a session token later (the second Boolean is <code>true</code>); adjust the Booleans appropriately for your application.</p>

    <p>After the user follows the link to the AuthSub page at Google and logs in, the AuthSub system then redirects the user back to your application, using the &quot;next&quot; URL you provided.</p>
    <p>When Google redirects back to your application, the token is appended to the &quot;next&quot; URL as a query parameter. So in the case of the above &quot;next&quot; URL, after the user logs in, Google redirects to a URL like <code>http://www.example.com/RetrieveToken?token=DQAADKEDE</code>. Therefore, the token is accessible as a variable in the ASP page's <code>Request.QueryString</code> object.</p>
    <h2><a name="AuthSubSessionToken" id="AuthSubSessionToken">Upgrading to a session token</a></h2>
    <p>The token you initially retrieve is always a one-time use token. You can exchange this token for a session token using the AuthSubSessionToken URL, as described in the <a href="http://code.google.com/apis/accounts/AuthForWebApps.html">AuthSub documentation</a>. Your application can make this exchange using the .NET client library as follows:</p>
    <pre>SessionsessionToken = AuthSubUtil.exchangeForSessionToken(Request.QueryStringtoken, null);</pre>
    <p>You pass your one-time use token to the <code>exchangeForSessionToken</a></code> method, along with either <code>null</code> (for unregistered mode) or a private key (for registered mode), and the AuthSub interface returns a session token. For more information about registered applications and private keys, refer to the <a href="http://code.google.com/apis/accounts/AuthForWebApps.html#signingrequests">Signing requests</a> section of the AuthSub documentation</a>.</p>
    <p>Now you are ready to use the session token to authenticate requests to the Spreadsheets server by placing the token in the Authorization header. To tell the .NET client library to automatically send the Authorization header (containing the session token) with each request, do the following:</p>
    <pre>GAuthSubRequestFactory authFactory = new GAuthSubRequestFactory("wise", "SpreadsheetsSampleApp");
authFactory.Token = SessionsessionToken.ToString();
SpreadsheetsService service = new SpreadsheetsService(authFactory.ApplicationName);
service.RequestFactory = authFactory;</pre>
    <h1><a name="listSpreadsheets" id="listSpreadsheets">Get a list of spreadsheets</a></h1>
    <p>You can get a feed containing a list of the currently authenticated user's spreadsheets by sending an authenticated <code>GET</code> request to the following URL:</p>
    <pre>http://spreadsheets.google.com/feeds/spreadsheets/private/full</pre>
    <p>The result is a "meta-feed," a feed that lists all of that user's spreadsheets; each entry in the feed represents a spreadsheet associated with the user. This feed is accessible only using an authentication token.</p>
    <p>To request the feed using the .NET client library, do the following:</p>
    <pre>SpreadsheetQuery query = new SpreadsheetQuery();
SpreadsheetFeed feed = service.Query(query);

Console.WriteLine("Your spreadsheets:");
foreach (SpreadsheetEntry entry in feed.Entries)
{
    Console.WriteLine(entry.Title.Text);
}</pre>
    <p>The <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.SpreadsheetQuery.html">SpreadsheetQuery</a></code> class encapsulates a query to the meta-feed URL shown above, and the resulting <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.SpreadsheetFeed.html">SpreadsheetFeed</a></code> object represents a response from the server. Among other things, this feed contains a list of <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.SpreadsheetEntry.html">SpreadsheetEntry</a></code> objects (<code>feed.Entries</code>), each of which represents a single spreadsheet. <code>SpreadsheetEntry</code> encapsulates the information shown in <a href="developers_guide_protocol.html#listSpreadsheets">the protocol document</a>.</p>
    <h1><a name="listWorksheets" id="listWorksheets">Get a list of worksheets</a></h1>
    <p>A given spreadsheet may contain multiple worksheets. For each spreadsheet, there's a <code>worksheets</code> metafeed listing all the worksheets in that spreadsheet.</p>
    <p>Given a <code>SpreadsheetEntry</code> you've already retrieved, you can print a list of all worksheets in this spreadsheet as follows:</p>
    <pre>AtomLink link = entry.Links.FindService(GDataSpreadsheetsNameTable.WorksheetRel, null);

WorksheetQuery query = new WorksheetQuery(link.HRef.ToString());
WorksheetFeed feed = service.Query(query);

foreach (WorksheetEntry worksheet in feed.Entries)
{
    Console.WriteLine(worksheet.Title.Text);
}</pre>
    <p>First find the <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Client.AtomLink.html">AtomLink</a></code> (corresponding to a <code>&lt;link&gt;</code> element in the spreadsheet entry) that has <code>rel="http://schemas.google.com/spreadsheets/2006#worksheetsfeed"</code>.  That link's <code>href</code> value provides the URL for the spreadsheet's <code>worksheets</code> metafeed. Next, construct a <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.WorksheetQuery.html">WorksheetQuery</a></code> to query this URL. The <code>SpreadsheetsService</code> returns a <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.WorksheetFeed.html">WorksheetFeed</a></code>, which contains a list of all the worksheets in this spreadsheet; each <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.WorksheetEntry.html">WorksheetEntry</a></code> in the feed is a single worksheet.</p>
    <p>This code is equivalent to sending an authenticated <code>GET</code> request to the URL:</p>
    <pre>http://spreadsheets.google.com/feeds/worksheets/<i>key</i>/private/full</pre>
    <p>where <i>key</i> is the permanent unique ID of a specific worksheet within the spreadsheet.</p>
    <h1><a name="listFeedExample" id="listFeedExample">Interacting with list-based feeds</a></h1>
    <p>A given worksheet generally contains multiple rows, each containing multiple cells. You can request data from the worksheet either as a list-based feed, in which each entry represents a row, or as a cell-based feed, in which each entry represents a single cell. For information on cell-based feeds, see <a href="#cellsFeedExample">Interacting with cell-based feeds</a>.</p>
    <p>The following sections describe how to get a list-based feed, add a row to a worksheet, and send queries with various query parameters.</p>
    <p>The list feed makes some assumptions about how the data is laid out in the spreadsheet.</p>
    <p>In particular, the list feed treats the first row of the worksheet as a header row; Spreadsheets dynamically creates XML elements named after the contents of header-row cells. Users who want to provide Google data feeds should not put any data other than column headers in the first row of a worksheet.</p>
    <p>The list feed contains all rows after the first row up to the first  blank row.  The first blank row terminates the data set. If expected data isn't appearing in a feed, check the worksheet manually to see whether there's an unexpected blank row in the middle of the data. In particular, if the second row of the spreadsheet is blank, then the list feed will contain no data.</p>

    <p>A row in a list feed is as many columns wide as the worksheet itself.</p>
    <h2><a name="listFeeds" id="listFeeds">Get a list-based feed</a></h2>
    <p>To retrieve a worksheet's list feed, you might do the following.  Here, are assuming that <code>service</code> is an authenticated <code>SpreadsheetsService</code> object, and <code>entry</code> is a <code>WorksheetEntry</code>.</p>
    <pre>AtomLink listFeedLink = entry.Links.FindService(GDataSpreadsheetsNameTable.ListRel, null);

ListQuery query = new ListQuery(listFeedLink.HRef.ToString());
ListFeed feed = service.Query(query);

Console.WriteLine("Worksheet has {0} rows:", feed.Entries.Count);
foreach (ListEntry worksheetRow in feed.Entries)
{
    ListEntry.CustomElementCollection elements = worksheetRow.Elements;
    foreach (ListEntry.Custom element in elements) {
        Console.Write(element.Value + "\t");
    }
    Console.WriteLine();
}</pre>
    <p>First find the <code>AtomLink</code> (corresponding to a <code>&lt;link&gt;</code> element in the worksheet entry) that has</pre> <pre>rel="http://schemas.google.com/spreadsheets/2006#listfeed"</pre>.
    <p>That link's <code>href</code> value provides the URL for the worksheet's list feed. Next, construct a <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListQuery.html">ListQuery</a></code> to query this URL. The <code>SpreadsheetsService</code> returns a <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListFeed.html">ListFeed</a></code>, which contains a list of all the rows in this worksheet; each <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListEntry.html">ListEntry</a></code> in the feed is a single row.</p>
    <p>To retrieve the contents of a single row, iterate over the <code>ListEntry</code>'s <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListEntry.Elements.html">Elements</a></code> member. This is a <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListEntry.CustomElementCollection.html">ListEntry.CustomElementCollection</a></code> object; each element in the collection (of the <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListEntry.Custom.html">ListEntry.Custom</a></code> class) is a cell in that row. Finally, <code>ListEntry.Custom</code> has the <code>string</code> properties <code>LocalName</code>, which stores the header of that cell's column, and <code>ListEntry.Value</code>, which stores the text in the cell.</p>
    <p>This code is equivalent to sending an authenticated <code>GET</code> request to the URL:</p>
    <pre>http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full</pre>
    <h2><a name="reverseSortExample" id="reverseSortExample">Reverse-sort rows</a></h2>
    <p>By default, rows in the feed appear in the same order as the corresponding rows in the GUI; that is, they're in order by row number. To get rows in reverse order, set the <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListQuery.OrderByPosition.html">OrderByPosition</a></code> and <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListQuery.Reverse.html">Reverse</a></code> properties of the <code>ListQuery</code> object to <code>true</code>:</p>
    <pre>ListQuery query = new ListQuery(listFeedLink.HRef.ToString());

query.OrderByPosition = true;
query.Reverse = true;</pre>
    <p>This is equivalent to sending an authenticated <code>GET</code> request to the URL:</p>
    <pre>http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full?reverse=true</pre>
    <p>Note that if you want to order (or reverse sort) by a particular column, rather than by position in the worksheet, you can set the <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListQuery.OrderByColumn.html">OrderByColumn</a></code> property of the <code>ListQuery</code> object to the header of that column.  This is analogous to adding an <code>orderby</code> query parameter in the outbound <code>GET</code> request. Setting <code>OrderByColumn</code> automatically sets <code>OrderByPosition</code> to <code>false</code>. Similarly, setting <code>OrderByPosition</code> to <code>true</code> automatically sets <code>OrderByColumn</code> to <code>null</code>.
    <h2><a name="listQueryExample" id="listQueryExample">Send a structured query</a></h2>
    <p>You can set a <code>ListQuery</code>'s <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.ListQuery.SpreadsheetQuery.html">SpreadsheetQuery</a></code> property to produce a feed with entries that meet the specified criteria. For example, suppose you have a worksheet containing personnel data, in which each row represents information about a single person. You wish to retrieve all rows in which the person's name is "John" and the person's age is over 25. To do so, you would set <code>SpreadsheetQuery</code> as follows:</p>
<pre>ListQuery query = new ListQuery(listFeedLink.HRef.ToString());

query.SpreadsheetQuery = "name=John and age>25";</pre>
    <p>This is equivalent to sending an authenticated <code>GET</code> request to the URL:</p>
    <pre>http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full?sq=<i>yourQuery</i></pre>
    <p>For more information about the structured query syntax, see the <a href="reference.html#list_Parameters">List-feed query parameters</a> reference section.</p>
    <h2><a name="addRow" id="addRow">Add a row</a></h2>
    <p>To insert a new row in a list-based feed, first construct a new <code>ListEntry</code> and set its <code>Elements</code> property to contain the cells in the row.  For example, given the <code>ListEntry</code> that represents an existing row, you might prompt the user for the values of each column as follows:</p>
    <pre>ListEntry newRow = new ListEntry();

foreach (ListEntry.Custom element in existingRow.Elements)
{
    Console.Write("Enter the value of column {0}: ", element.LocalName);
    String elementValue = Console.ReadLine();

    ListEntry.Custom curElement = new ListEntry.Custom();
    curElement.LocalName = element.LocalName;
    curElement.Value = elementValue;

    newRow.Elements.Add(curElement);
}</pre>
    <p>Then insert the new row in the <code>ListFeed</code> as follows:</p>
    <pre>ListEntry insertedRow = feed.Insert(newRow) as ListEntry;</pre>
    <p>Spreadsheets inserts the new row immediately after the last row that appears in the list-based feed, which is to say immediately before the first entirely blank row. This code is equivalent to sending an authenticated <code>POST</code> request to the URL:</p>
    <pre>http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full</pre>
    <p>with the corresponding XML document in the <code>POST</code> body.</p>
    <h2><a name="updateRow" id="updateRow">Edit a row</a></h2>
    <p>To change the contents of a row, first modify the desired <code>ListEntry.Custom</code> objects corresponding to cells in that row. For example, to change the cell in the first column to "John" and the cell in the second column to "Doe", do the following:</p>
    <pre>ListEntry.Custom firstColumn = entry.Elements[0];
firstColumn.Value = "John";

ListEntry.Custom secondColumn = entry.Elements[1];
secondColumn.Value = "Doe";</pre>
    <p>Then call the <code>ListEntry</code>'s <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Client.AtomEntry.Update.html">Update</a></code> method to perform the update:</p>
    <pre>ListEntry updatedRow = entry.Update() as ListEntry;</pre>
    <p>This is equivalent to sending an authenticated <code>PUT</code> request to the entry's edit link, with the updated XML as <code>PUT</code> data.</p>
    <h2><a name="deleteRow" id="deleteRow">Remove a row</a></h2>
    <p>To delete a row, simply invoke the <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Client.AtomEntry.Delete.html">Delete</a></code> method on the corresponding <code>ListEntry</code> object:</p>
    <pre>entry.Delete();</pre>
    <p>This is equivalent to performing an HTTP <code>DELETE</code> request on the row's edit URL.</p>
    <p class="note"><strong>Note</strong>: If you delete a row, that row is completely removed from the worksheet.</p>
    <h1><a name="cellsFeedExample" id="cellsFeedExample">Interacting with cell-based feeds</a></h1>
    <p>In a cell-based feed, each entry represents a single cell.</p>
    <p>Note that it isn't recommended to interact with both a cell-based feed and a list-based feed for the same worksheet at the same time.</p>
    <h2><a name="cellFeeds" id="cellFeeds">Get a cell-based feed</a></h2>
    <p>To retrieve a worksheet's cell-based feed, you might do the following.  Again, this assumes that <code>service</code> is an authenticated <code>SpreadsheetsService</code> object, and <code>entry</code> is a <code>WorksheetEntry</code>.</p>
    <pre>AtomLink cellFeedLink = entry.Links.FindService(GDataSpreadsheetsNameTable.CellRel, null);

CellQuery query = new CellQuery(cellFeedLink.HRef.ToString());
CellFeed feed = service.Query(query);

Console.WriteLine("Cells in this worksheet:");
foreach (CellEntry curCell in feed.Entries)
{
    Console.WriteLine("Row {0}, column {1}: {2}", curCell.Cell.Row,
        curCell.Cell.Column, curCell.Cell.Value);
}</pre>
    <p>First find the <code>AtomLink</code> (corresponding to a <code>&lt;link&gt;</code> element in the worksheet entry) that has</pre> <pre>rel="http://schemas.google.com/spreadsheets/2006#cellsfeed"</pre>.
    <p>That link's <code>href</code> value provides the URL for the worksheet's list feed. Next, construct a <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellQuery.html">CellQuery</a></code> to query this URL. The <code>SpreadsheetsService</code> returns a <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellFeed.html">CellFeed</a></code>, which contains a list of all the cells in this worksheet; each <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellEntry.html">CellEntry</a></code> in the feed is a single cell. Given a <code>CellEntry</code>, you can easily find the cell's row, column and value by accessing its <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellEntry.CellElement.Row.html">Cell.Row</a></code>, <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellEntry.CellElement.Column.html">Cell.Column</a></code>, and <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellEntry.CellElement.Value.html">Cell.Value</a></code> properties, respectively.</p>
    <p>This code is equivalent to sending an authenticated <code>GET</code> request to the URL:</p>
    <pre>http://spreadsheets.google.com/feeds/cells/<i>key</i>/<i>worksheetId</i>/private/full</pre>
    <h2><a name="cellsQueryExample" id="cellsQueryExample">Send a cell range query</a></h2>
    <p>Suppose you only want to retrieve the cells in the first column of a worksheet.  You can request a cell feed containing only this column as follows:</p>
    <pre>CellQuery query = new CellQuery(cellFeedLink.HRef.ToString());
query.MinimumColumn = 1;
query.MaximumColumn = 1;
query.MinimumRow = 2;

CellFeed feed = service.Query(query);</pre>
    <p>That requests all the data in column 1, starting with row 2 (because in our example, row 1 contains the column names).</p>
    <p>Setting the <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellQuery.MinimumColumn.html">MinimumColumn</a></code>, <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellQuery.MaximumColumn.html">MaximumColumn</a></code>, <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellQuery.MinimumRow.html">MinimumRow</a></code>, and <code><a href="http://code.google.com/apis/gdata/csdoc/Google.GData.Spreadsheets.CellQuery.MaximumRow.html">MaximumRow</a></code> properties of a <code>CellQuery</code> object is equivalent to providing values for the parameters <code>min-col</code>, <code>max-col</code>, <code>min-row</code>, and <code>max-row</code> (respectively) in the HTTP <code>GET</code> request.</p>
    <h2><a name="updateCell" id="updateCell">Change contents of a cell</a></h2>
    <p>To modify the contents of an existing <code>CellEntry</code> that you have retrieved from a feed, first change its <code>InputValue</code> property.  Then execute the update request as follows:</p>
    <pre>cellEntry.Cell.InputValue = "Jane";
AtomEntry updatedCell = cellEntry.Update();</pre>
    <p>This is equivalent to sending an authenticated <code>PUT</code> request, with the updated cell's XML representation, to the URL:</p>
    <pre>http://spreadsheets.google.com/feeds/cells/<i>key</i>/<i>worksheetId</i>/private/full/cell/<i>version</i></pre>
    <p class="note"><strong>Note</strong>: Use <code>Update()</code> (i.e., HTTP <code>PUT</code>) to change the data in a cell, even if it is empty; the use of <code>POST</code> on empty cells is no longer recommended. To clear a cell, send an empty string as the value instead of using a <code>DELETE</code>.</p>
    <p class="backtotop"><a href="#top">Back to top</a></p>
</div>
  <!-- ########## END PAGE CONTENT ########## -->
</div>
<!-- end wrapper -->
<!-- ########## PAGE FOOTER ########## -->
<div id="footer">
  <div id="footerlogo"><img src="http://www.google.com/images/art.gif" alt="" /></div>
  <div id="copyright">
    <p>&copy; Google Inc. 2006 - <a href="http://www.google.com/privacy.html">Privacy Policy</a> - <a href="http://www.google.com/terms_of_service.html">Terms and Conditions</a> - <a href="http://www.google.com/about.html">About Google</a></p>
  </div>
  <!-- end copyright -->
</div>
<!-- ########## END PAGE FOOTER ########## -->
<p id="date">Last modified:
<script type="text/javascript">
  <!--
  var lm = new Date(document.lastModified);
  document.write(lm.toDateString());
  //-->
</script>
</p>
</body>
</html>
