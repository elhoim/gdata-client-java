<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Google Spreadsheets Data API Developer's Guide</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="../css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="css/local_extensions.css" />
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../css/ieonly.css" />
<![endif]-->
<style type="text/css">
<!--
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
     color: #000000;
}

.q {
  font-weight: bold;
  color: red;
  font-style: italic;
}
-->
</style>
</head>
<body class="t1" id="developers_guide_page">
<a name="top"></a>
<!-- ########## PAGE HEADER ########## -->
<div id="header">
  <div id="logo"><a href="http://code.google.com/"><img src="http://code.google.com/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Google Spreadsheets Data API </h1>
</div>
<!-- ########## END PAGE HEADER ########## -->
<div id="wrapper">
  <!-- ########## SIDE NAVIGATION ########## -->
  <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
  _uacct = "UA-18071-1";
  urchinTracker();
</script>

<div id="sidenav">
  <ul>
    <li>
      <h1>Spreadsheets </h1>
      <ul>
        <!-- ID tag identifies current page -->
        <li><a href="overview.html" id="overview_link">Overview</a></li>
        <li><a href="developers_guide_protocol.html" id="developers_guide_link">Developer's Guide</a></li>
        <li><a href="reference.html" id="reference_link">Reference Guide</a></li>
        <li><a href="http://www.google.com/google-d-s/terms.html">Terms of Service</a></li>
      </ul>
    </li>
    <li>
      <h1>Google data Protocol</h1>
      <ul>
        <li><a href="../gdata/overview.html">Overview</a></li>
        <li><a href="../gdata/clientlibs.html">Client Libraries</a></li>
        <li><a href="../gdata/auth.html">Authentication</a></li>
      </ul>
    </li>
    <li>
      <h1>Support Resources</h1>
      <ul>
        <li><a href="http://groups.google.com/group/Google-Spreadsheets-Data-API">Discussion Group</a></li>
      </ul>
    </li>
  </ul>
</div>

  <!-- ########## END SIDE NAVIGATION ########## -->
  <!-- ########## PAGE CONTENT ########## -->
<div id="pagecontent">
    <h1 id="page_title">Google Spreadsheets Data API Developer's Guide: Protocol </h1>

<div id="topnav">
<table id="mt" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<th class="int1" onclick="if (!cancelBubble) goTo('developers_guide_protocol.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_protocol.html">Protocol</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int2" onclick="if (!cancelBubble) goTo('developers_guide_java.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_java.html">Java</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int3" onclick="if (!cancelBubble) goTo('developers_guide_dotnet.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_dotnet.html">.NET</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int4" onclick="if (!cancelBubble) goTo('developers_guide_php.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_php.html">PHP</a></div>
</th><td>&nbsp;&nbsp;</td>
<th class="int5" onclick="if (!cancelBubble) goTo('developers_guide_python.html');">
<div class="tc1"><div class="tc2"><div class="tc3"></div></div></div>
<div class="tT"><a onclick="cancelBubble=true;" href="developers_guide_python.html">Python</a></div>
<td width="100%">&nbsp;</td>
</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0" class="st">
<tr>
<td height="4" align="right" style="padding:0px; vertical-align:top">
<div class="stur"></div>
</td>
</tr>
</table>
</div>


    <p>The Google Spreadsheets data API allows client applications to view and update Spreadsheets content in the form of Google data API feeds. 
       Your client application can request a list of a user's spreadsheets, edit or delete content in an existing Spreadsheets worksheet, 
       and query the content in an existing Spreadsheets worksheet.</p>
    <h1>Contents</h1>
    <div class="toc">
    <ol>
      <li><a href="#Audience">Audience</a></li>
      <li><a href="#GettingStarted">Getting started</a></li>
      <!--<li><a href="#Example">Interacting with Spreadsheets: examples</a>-->
      <!--  <ol> -->
      <li><a href="#createSpreadsheet">Create a spreadsheet</a></li>
      <li><a href="#authenticationToken">Authenticating to the Spreadsheets service</a>
      <ol>
              <li><a href="#ClientLoginHTTP">Single-user "installed" client
                authentication</a></li>
              <li><a href="#AuthSubHTTP">Multiple-user web application client
                authentication</a></li>
                <ol>
                  <li><a href="#AuthSubMultiUse">Upgrading to a session token</a></li>
                </ol>
      </ol>
      </li>
          <li><a href="#listSpreadsheets">Get a list of spreadsheets</a></li>
          <li><a href="#listWorksheets">Get a list of worksheets</a></li>
          <li><a href="#listFeedExample">Interacting with list-based feeds</a>
            <ol>
              <li><a href="#listFeeds">Get a list-based feed</a> </li>
              <li><a href="#reverseSortExample">Reverse-sort rows</a></li>
              <li><a href="#listQueryExample">Send a structured query</a></li>
              <li><a href="#addRow">Add a row</a></li>
              <li><a href="#updateRow">Edit a row</a></li>
              <li><a href="#deleteRow">Remove a row</a></li>
            </ol>
          </li>
          <li><a href="#cellsFeedExample">Interacting with cell-based feeds</a>
            <ol>
              <li><a href="#cellFeeds">Get a cell-based feed</a> </li>
              <li><a href="#cellsQueryExample">Send a cell range query</a></li>
              <li><a href="#updateCell">Change contents of a cell</a></li>
            </ol>
          </li>
        <!--</ol>-->
      </li>
    </ol>
    </div>
    <h1><a name="Audience" id="Audience">Audience</a></h1>
    <p>This document is intended for programmers who want to write client applications that can interact with Google Spreadsheets. It provides a series of examples of basic data API interactions using raw XML/HTTP, with explanations. After reading this document, you may wish to learn more about interacting with the API using our
<a href="../gdata/clientlibs.html">client libraries</a> by reading the language-specific examples found on the other tabs at the top of this document.
</p>
    <p>For Spreadsheets data API reference information, see the <a href="reference.html">reference guide</a>.</p>
    <p>This document assumes that you understand the general ideas behind the <a href="../gdata/basics.html">Google data APIs protocol</a>. 
       Each example in this document first shows how to use the bare protocol to interact with Spreadsheets.</p>
    <h1><a name="GettingStarted" id="GettingStarted">Getting started</a></h1>
    <p>Assume you're creating a client application that needs to communicate with Spreadsheets. You want your client to be able to get a list of rows or a collection of individual cells from a worksheet, and to be able to add a row or cell to that worksheet. This developer guide will walk you through these actions.</p>
    <p class="note"><strong>Note</strong>: If you don't already have a Spreadsheets account, you may want to create one for testing purposes. To follow the examples in this document, you'll also have to manually create a sample spreadsheet, as described in the <a href="#createSpreadsheet">Create a spreadsheet</a> section.</p>
    <p>You can, of course, interact with Spreadsheets in other ways too: update an entry, delete an entry, and so on, all using the Google data protocol or the client libraries.</p>
    <p class="note"><strong>Note</strong>: The size limits described in  <a href="http://docs.google.com/support/spreadsheets/bin/answer.py?answer=37603&amp;query=limit&amp;topic=&amp;type=">How big can each document/spreadsheet be?</a> (in the Google Docs &amp; Spreadsheets Help Center) also apply to spreadsheets that you interact with using the Google data protocol. For example, you can't have more than 10,000 rows or more than 50,000 cells total in all the worksheets of a given spreadsheet. In addition, Google data imposes a usage limit: you can't send more than twenty data updates per second.</p>
    <p>For general information about Google data APIs and more example code that you can adapt for use with Spreadsheets, see the list of <a href="../gdata/clientlibs.html">Client Libraries</a>.</p>
    <h1><a name="createSpreadsheet" id="createSpreadsheet">Create a spreadsheet</a></h1>
    <p>The Spreadsheets data API does not currently provide a way to create or delete a spreadsheet. For testing purposes, you'll need to create a spreadsheet manually.</p>
    <p>The examples in this document use a spreadsheet containing the following data. Note that the Items Per Minute (IPM) row  uses a formula: <code>=FLOOR(R[0]C[-1]/(R[0]C[-2]*60),.0001)</code>.</p>
    <table>
      <tr>
        <th></th>
        <th>A</th>
        <th>B</th>
        <th>C</th>
        <th>D</th>
      </tr>
      <tr>
        <th>1</th>
        <td><b>Name</b></td>
        <td><b>Hours</b></td>
        <td><b>Items</b></td>
        <td><b>IPM</b></td>
      </tr>
      <tr>
        <th>2</th>
        <td>Bingley</td>
        <td>10</td>
        <td>2</td>
        <td>0.0033</td>
      </tr>
      <tr>
        <th>3</th>
        <td>Captain Carter</td>
        <td>200</td>
        <td>75360</td>
        <td>6.28</td>
      </tr>
      <tr>
        <th>4</th>
        <td>Dawson</td>
        <td>200</td>
        <td>100000</td>
        <td>8.3333</td>
      </tr>
      <tr>
        <th>5</th>
        <td>Colonel Forster</td>
        <td>50</td>
        <td>300</td>
        <td>0.1</td>
      </tr>
      <tr>
        <th>6</th>
        <td>William Goulding</td>
        <td>100</td>
        <td>25842</td>
        <td>4.307</td>
      </tr>
      <tr>
        <th>7</th>
        <td>Lady Lucas</td>
        <td>100</td>
        <td>25670</td>
        <td>4.2783</td>
      </tr>
      <tr>
        <th>8</th>
        <td>Sir William</td>
        <td>190</td>
        <td>98765</td>
        <td>8.6635</td>
      </tr>
      <tr>
        <th>9</th>
        <td>Charlotte</td>
        <td>60</td>
        <td>18000</td>
        <td>5</td>
      </tr>
    </table>
    <h1><a name="authenticationToken" id="authenticationToken">Authenticating with the Spreadsheets Service</a></h1>
    <p>To request or edit spreadsheet data for an unpublished spreadsheet, your client needs an authentication token. The following sections explain how to authenticate for different types of client applications.</p>
    <p class="note"><strong>Note</strong>: You don't need to authenticate to request data from a published spreadsheet. (A published spreadsheet is one that the user has marked as published using the Spreadsheets GUI.)</p>
    <p>Your choice of authentication method should be determined by the kind of client you're writing: single-user desktop applications should use the ClientLogin system, while multi-user web apps should use the AuthSub system. For a more detailed discussion of these authentication systems, see the <a href="http://code.google.com/apis/accounts/Authentication.html">Google Account Authentication</a> document.</p>
    <p>Whichever method you choose, you can either send raw HTTP requests, or have Google's client libraries handle the authentication for you.</p>
    <h2><a name="ClientLoginHTTP" id="ClientLoginHTTP">Single-user "installed" client authentication</a></h2>
    <p>To authenticate the user, send a <code>POST</code> request to the following URL:</p>
    <pre>https://www.google.com/accounts/ClientLogin</pre>
    <p>Include the relevant parameters in the body of the <code>POST</code> request, as described in the <a href="http://code.google.com/apis/accounts/AuthForInstalledApps.html">ClientLogin documentation</a>. The service name for Spreadsheets is <a href="http://code.google.com/support/bin/answer.py?answer=62712&topic=10711"><i>wise</i></a>.</p>
    <p>If the request succeeds, then the response contains an alphanumeric string labeled <code>Auth</code>.</p>
    <p class="note"><strong>Note</strong>: As described in the ClientLogin documentation, the authentication request may fail and request a CAPTCHA challenge. If you want Google to issue and handle the CAPTCHA challenge, then send the user to <code>https://www.google.com/accounts/DisplayUnlockCaptcha?service=wise</code> (rather than to the CAPTCHA-handling URL given in the ClientLogin documentation).</p>
    <p>After a successful authentication request, use the <code>Auth</code> value to create an Authorization header for each request:</p>
    <pre>Authorization: GoogleLogin auth=<i>yourAuthValue</i></pre>
    <h2><a name="AuthSubHTTP" id="AuthSubHTTP">Multiple-user web application client authentication</a></h2>
    <p>To acquire an AuthSub token for a given Spreadsheets user, your application must redirect the user to the AuthSubRequest URL at Google, which prompts them to log into their Google account.</p>
    <p>After the user logs in, the AuthSub system redirects them to the URL you specified in the <code>next</code> query parameter of the AuthSubRequest URL. The AuthSub system appends an authentication token to the <code>next</code> URL, as the value of the <code>token</code> query parameter. Your application then uses that authentication token in subsequent interactions with Spreadsheets.</p>
    <p>The below example shows a request to authorize foo.com</p>   
    <pre>https://www.google.com/accounts/AuthSubRequest?scope=http%3A%2F%2Fspreadsheets.google.com%2Ffeeds%2F&session=1&secure=0&next=http%3A%2F%2Fwww.foo.com%2Fhandletoken.pyc</pre>
    <h2 id="AuthSubMultiUse">Upgrading to a session token</h2>
    <p>By default, the AuthSub token can only be used for one request. To receive a token which can be used for multiple requests it must be upgraded 
    by making an HTTP <code>GET</code> request which contains the single use token as an Authorization header. A token may only be upgraded if the initial AuthSub 
    request included session=1 as a URL parameter.</p>
    <pre>GET /accounts/AuthSubSessionToken HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Authorization: AuthSub token="<i>yourAuthToken</i>"
User-Agent: Java/1.5.0_06
Host: https://www.google.com
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive</pre>
    <p>If the token was upgraded successfully, the server's response contains the new token information in the HTTP headers. Here's an example response:</p>
    <pre>Token=DQAA...7DCTN
Expiration=20061004T123456Z</pre>    
    <p>Use the authentication token to create an Authorization header for each request:</p>
    <pre>Authorization: AuthSub token="<i>yourAuthToken</i>"</pre>
    <p>For details, including information on registering your application with Google and other topics, see the <a href="http://code.google.com/apis/accounts/AuthForWebApps.html">AuthSub documentation</a>.</p>
    <p class="note"><strong>Note</strong>: The <code>token</code> value in the Authorization header should be surrounded by quotation marks.</p>
    <h1><a name="listSpreadsheets" id="listSpreadsheets">Get a list of spreadsheets</a></h1>
    <p>You can get a feed listing the spreadsheets for a particular user by sending an authenticated <code>GET</code> request to the following URL:</p>
    <pre>GET http://spreadsheets.google.com/feeds/spreadsheets/private/full</pre>
    <p>The result is a &quot;metafeed,&quot; a feed that lists all of that user's feeds of a particular type; in this case, each entry in the feed represents a spreadsheet associated with the user.</p>
    <p>This feed is accessible only using an authentication token.</p>
    <p>An entry in the spreadsheets metafeed might resemble the following. The following example has been edited a little to make it a little more readable by humans; in particular, a real spreadsheets metafeed contains actual spreadsheet IDs where the following listing says <i>key</i>.</p>
    <pre>&lt;entry&gt;
  &lt;id&gt;http://spreadsheets.google.com/feeds/spreadsheets/private/full/<i>key</i>&lt;/id&gt;
  &lt;updated&gt;2006-11-17T18:24:18.231Z&lt;/updated&gt;
  &lt;title type=&quot;text&quot;&gt;Groceries R Us&lt;/title&gt;
  &lt;content type=&quot;text&quot;&gt;Groceries R Us&lt;/content&gt;
  &lt;link rel=&quot;http://schemas.google.com/spreadsheets/2006#worksheetsfeed&quot;
    type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/worksheets/<i>key</i>/private/full&quot;/&gt;
  &lt;link rel=&quot;alternate&quot; type=&quot;text/html&quot;
    href=&quot;http://spreadsheets.google.com/ccc?key=<i>key</i>&quot;/&gt;
  &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/spreadsheets/private/full/<i>key</i>&quot;/&gt;
  &lt;author&gt;
    &lt;name&gt;Fitzwilliam Darcy&lt;/name&gt;
    &lt;email&gt;fitz@gmail.com&lt;/email&gt;
  &lt;/author&gt;
&lt;/entry&gt;</pre>
    <p>Note that the <code>key</code> value that appears here is the same as the key value that appears in the URL displayed in the address bar of your browser window when you open the spreadsheet manually.</p>
    <p>The URI given in the <code>&lt;link&gt;</code> element with <code>rel=&quot;http://schemas.google.com/spreadsheets/2006#worksheetsfeed&quot;</code> is the URI of the <code>worksheets</code> metafeed for that spreadsheet, which lists all the worksheets the user has access to in that spreadsheet. If that URI ends with <code>/private/values</code>, that indicates that the current authenticated user can only view the spreadsheet, not edit it. If it ends with <code>/private/full</code>, that indicates that the current authenticated user is authorized to add and edit data in the worksheets.</p>
    <p class="note"><strong>Note</strong>: User access levels are set in the GUI. If a user owns a given worksheet or is listed as an editor, then they have read/write access; if they're listed only as a viewer, then they have read-only access. In addition, if the worksheet is published then even unauthenticated users and users not listed as viewers have read access.</p>
    <p>For further information about the <code>spreadsheets</code> metafeed, see the <a href="reference.html#spreadsheets_Feed">Spreadsheet metafeed reference</a> documentation.</p>
    <p>If the metafeed contains no entries, it means there are no spreadsheets created or shared by this account. <a href="#createSpreadsheet">Create a spreadsheet manually</a> and request the metafeed again.</p>
    <h1><a name="listWorksheets" id="listWorksheets">Get a list of worksheets</a></h1>
    <p>A given spreadsheet may contain multiple worksheets. For each spreadsheet, there's a <code>worksheets</code> metafeed listing all the worksheets in that spreadsheet.</p>
    <p>To determine the URL of a given spreadsheet's <code>worksheets</code> metafeed, find that spreadsheet's entry in the <code>spreadsheets</code> metafeed, as described in the previous section. Then examine the <code>&lt;link&gt;</code> element that has <code>rel=&quot;http://schemas.google.com/spreadsheets/2006#worksheetsfeed&quot;</code>. That element's <code>href</code> value provides the URL for that spreadsheet's <code>worksheets</code> metafeed.</p>
    <p>To request a list of worksheets in a given spreadsheet, issue a <code>GET</code> request to that  URL, with an appropriate authentication token:</p>
    <pre>GET http://spreadsheets.google.com/feeds/worksheets/<i>key</i>/private/full</pre>
    <p>There are several other  visibility and projection values that you can use instead of <code>private</code> and <code>full</code>; for more information, see <a href="reference.html#Feeds">Spreadsheets feed types</a> in the reference document.</p>
    <p>Spreadsheets returns  an Atom feed resembling the following. This example has been edited a little to make it a little more readable by humans; in particular, a real worksheets metafeed contains actual spreadsheet IDs where the following listing says <i>key</i>. Note that the string <code>od6</code>, which appears several times in the example, is the permanent unique ID of a specific worksheet within the  spreadsheet.</p>
    <pre>&lt;feed xmlns=&quot;http://www.w3.org/2005/Atom&quot;
    xmlns:openSearch=&quot;http://a9.com/-/spec/opensearchrss/1.0/&quot;
    xmlns:gs=&quot;http://schemas.google.com/spreadsheets/2006&quot;&gt;
  &lt;id&gt;http://spreadsheets.google.com/feeds/worksheets/<i>key</i>/private/full&lt;/id&gt;
  &lt;updated&gt;2006-11-17T18:23:45.173Z&lt;/updated&gt;
  &lt;title type=&quot;text&quot;&gt;Groceries R Us&lt;/title&gt;
  &lt;link rel=&quot;alternate&quot; type=&quot;text/html&quot;
    href=&quot;http://spreadsheets.google.com/ccc?key=<i>key</i>&quot;/&gt;
  &lt;link rel=&quot;http://schemas.google.com/g/2005#feed&quot;
    type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/worksheets/<i>key</i>/private/full&quot;/&gt;
  &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/worksheets/<i>key</i>/private/full&quot;/&gt;
  &lt;author&gt;
    &lt;name&gt;Fitzwilliam Darcy&lt;/name&gt;
    &lt;email&gt;fitz@gmail.com&lt;/email&gt;
  &lt;/author&gt;
  &lt;openSearch:totalResults&gt;1&lt;/openSearch:totalResults&gt;
  &lt;openSearch:startIndex&gt;1&lt;/openSearch:startIndex&gt;
  &lt;openSearch:itemsPerPage&gt;1&lt;/openSearch:itemsPerPage&gt;
  &lt;entry&gt;
    &lt;id&gt;http://spreadsheets.google.com/feeds/worksheets/<i>key</i>/private/full/od6&lt;/id&gt;
    &lt;updated&gt;2006-11-17T18:23:45.173Z&lt;/updated&gt;
    &lt;title type=&quot;text&quot;&gt;Sheet1&lt;/title&gt;
    &lt;content type=&quot;text&quot;&gt;Sheet1&lt;/content&gt;
    &lt;link rel=&quot;http://schemas.google.com/spreadsheets/2006#listfeed&quot;
      type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full&quot;/&gt;
    &lt;link rel=&quot;http://schemas.google.com/spreadsheets/2006#cellsfeed&quot;
      type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full&quot;/&gt;
    &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/worksheets/<i>key</i>/private/full/od6&quot;/&gt;
    &lt;gs:rowCount&gt;100&lt;/gs:rowCount&gt;
    &lt;gs:colCount&gt;20&lt;/gs:colCount&gt;
  &lt;/entry&gt;
&lt;/feed&gt;</pre>
    <p>For further information about the <code>worksheets</code> metafeed, see the <a href="reference.html#worksheets_Feed">Worksheet metafeed</a> section of the reference document.</p>
    <h1><a name="listFeedExample" id="listFeedExample">Interacting with list-based feeds</a></h1>
    <p>A given worksheet generally contains multiple rows, each containing multiple cells. You can request data from the worksheet either as a list-based feed, in which each entry represents a row, or as a cell-based feed, in which each entry represents a single cell. For information on cell-based feeds, see <a href="#cellsFeedExample">Interacting with cell-based feeds</a>.</p>
    <p>The following sections describe how to get a list-based feed, add a row to a worksheet, and send queries with various query parameters.</p>
    <p>The  list feed makes some assumptions about how the data is laid out in the spreadsheet.</p>
    <p>In particular, the list feed treats the first row of the worksheet as a header row; Spreadsheets dynamically creates XML elements named after the contents of header-row cells. Users who want to provide Google data feeds should not put any data other than column headers in the first row of a worksheet.</p>
    <p>The list feed contains  all rows after the first row up to the first  blank row.  The first blank row terminates the data set. If expected data isn't appearing in a feed, check the worksheet manually to see whether there's an unexpected blank row in the middle of the data. In particular, if the second row of the spreadsheet is blank, then the list feed will contain no data.</p>
    <p>A row in a list feed is as many columns wide as the worksheet itself.</p>
    <h2><a name="listFeeds" id="listFeeds">Get a list-based feed</a></h2>
    <p>To determine the URL of a list-based feed for a given worksheet, get the <code>worksheets</code> metafeed and examine   the <code>&lt;link&gt;</code> element in which <code>rel</code> is <code>http://schemas.google.com/spreadsheets/2006#listfeed</code>. The <code>href</code> value in that element is the list feed's URI.</p>
    <p>To retrieve a  list-based feed, send the following <code>GET</code> request, using the list feed's URI and an appropriate authentication token:</p>
    <pre>GET http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full</pre>
    <p>Google Spreadsheets returns  an Atom feed resembling the following:</p>
    <pre>&lt;feed xmlns=&quot;http://www.w3.org/2005/Atom&quot;
    xmlns:openSearch=&quot;http://a9.com/-/spec/opensearchrss/1.0/&quot;
    xmlns:gsx=&quot;http://schemas.google.com/spreadsheets/2006/extended&quot;&gt;
  &lt;id&gt;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full&lt;/id&gt;
  &lt;updated&gt;2006-11-17T18:23:45.173Z&lt;/updated&gt;
  &lt;title type=&quot;text&quot;&gt;Sheet1&lt;/title&gt;
  &lt;link rel=&quot;alternate&quot; type=&quot;text/html&quot;
    href=&quot;http://spreadsheets.google.com/ccc?key=<i>key</i>&quot;/&gt;
  &lt;link rel=&quot;http://schemas.google.com/g/2005#feed&quot;
    type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full&quot;/&gt;
  &lt;link rel=&quot;http://schemas.google.com/g/2005#post&quot;
    type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full&quot;/&gt;
  &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full&quot;/&gt;
  &lt;author&gt;
    &lt;name&gt;Fitzwilliam Darcy&lt;/name&gt;
    &lt;email&gt;fitz@gmail.com&lt;/email&gt;
  &lt;/author&gt;
  &lt;openSearch:totalResults&gt;8&lt;/openSearch:totalResults&gt;
  &lt;openSearch:startIndex&gt;1&lt;/openSearch:startIndex&gt;
  &lt;openSearch:itemsPerPage&gt;8&lt;/openSearch:itemsPerPage&gt;
  &lt;entry&gt;
    &lt;id&gt;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full/cokwr&lt;/id&gt;
    &lt;updated&gt;2006-11-17T18:23:45.173Z&lt;/updated&gt;
    &lt;category scheme=&quot;http://schemas.google.com/spreadsheets/2006&quot;
      term=&quot;http://schemas.google.com/spreadsheets/2006#list&quot;/&gt;
    &lt;title type=&quot;text&quot;&gt;Bingley&lt;/title&gt;
    &lt;content type=&quot;text&quot;&gt;Hours: 10, Items: 2, IPM: 0.0033&lt;/content&gt;
    &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full/cokwr&quot;/&gt;
    &lt;link rel=&quot;edit&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full/cokwr/2ehkc2oh7d&quot;/&gt;
    &lt;gsx:name&gt;Bingley&lt;/gsx:name&gt;
    &lt;gsx:hours&gt;10&lt;/gsx:hours&gt;
    &lt;gsx:items&gt;2&lt;/gsx:items&gt;
    &lt;gsx:ipm&gt;0.0033&lt;/gsx:ipm&gt;
  &lt;/entry&gt;

  ...

  &lt;entry&gt;
    &lt;id&gt;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full/cyevm&lt;/id&gt;
    &lt;updated&gt;2006-11-17T18:23:45.173Z&lt;/updated&gt;
    &lt;category scheme=&quot;http://schemas.google.com/spreadsheets/2006&quot;
      term=&quot;http://schemas.google.com/spreadsheets/2006#list&quot;/&gt;
    &lt;title type=&quot;text&quot;&gt;Charlotte&lt;/title&gt;
    &lt;content type=&quot;text&quot;&gt;Hours: 60, Items: 18000, IPM: 5&lt;/content&gt;
    &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full/cyevm&quot;/&gt;
    &lt;link rel=&quot;edit&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/list/<i>key</i>/od6/private/full/cyevm/64rl27px3zyn&quot;/&gt;
    &lt;gsx:name&gt;Charlotte&lt;/gsx:name&gt;
    &lt;gsx:hours&gt;60&lt;/gsx:hours&gt;
    &lt;gsx:items&gt;18000&lt;/gsx:items&gt;
    &lt;gsx:ipm&gt;5&lt;/gsx:ipm&gt;
  &lt;/entry&gt;
&lt;/feed&gt;</pre>
    <p>Each entry represents a row in the worksheet. The <code>&lt;title&gt;</code> element contains the contents of the first cell in the row, and the <code>&lt;content&gt;</code> element contains a textual representation of the data from all the other cells in the row.</p>
    <p> Each item in the <code>gsx</code> namespace represents the contents of a cell in the row, with elements in the <code>gsx</code> namespace named after the contents of the header cells&mdash;that is, the cells in the first row of the worksheet. If a particular header cell is empty, then a unique column ID is used for the <code>gsx</code> element name. If the header cell's content contains a space, it will be removed in the <code>gsx</code> element name. For more information, see the <a href="reference.html#gsx_reference">gsx namespace elements</a> section of the reference document.</p>
    <p class="note"><strong>Note</strong>: In a column with an empty header cell, empty cells don't appear as <code>gsx</code> elements; in such a column, only cells that contain data appear as <code>gsx</code> elements.</p>
    <p>The entries are ordered in the same order in which they appear in the worksheet GUI, unless the query includes the <code>orderby</code> query parameter.</p>
    <p>For further information about the list feed, see the <a href="reference.html#list_Feed">List-based feed</a> reference section.</p>
    <h2><a name="reverseSortExample" id="reverseSortExample">Reverse-sort rows</a></h2>
    <p>By default, rows in the feed appear in the same order as the corresponding rows in the GUI; that is, they're in order by row number. To get  rows in reverse order, send the following request, using the <code>reverse</code> query parameter to specify the sort order:</p>
    <pre>GET http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full?reverse=true</pre>
    <p>To sort by the values in a particular column, rather than by row number,  use the <code>orderby</code> query parameter.</p>
    <p>For more information about <code>orderby</code> and <code>reverse</code>, see the <a href="reference.html#list_Parameters">List-feed query parameters</a> reference section.</p>
    <h2><a name="listQueryExample" id="listQueryExample">Send a structured query</a></h2>
    <p>You can use the  structured query parameter <code>sq</code> to produce a feed with entries that meet the specified criteria. Suppose in our example you wanted to determine which workers at Groceries R Us are not meeting the minimum of 4 items per minute, but you realize it is unfair to consider new employees (those with no more than 40 hours). The HTTP request would be as follows:</p>
    <pre>
GET http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full?sq=ipm&lt;4%20and%20hours&gt;40</pre>
    <p>For more information about the structured query syntax, see the <a href="reference.html#list_Parameters">List-feed query parameters</a> reference section.</p>
    <h2><a name="addRow" id="addRow">Add a row </a></h2>
    <p>To add a row to the table, start by creating an <code>&lt;entry&gt;</code> element containing the relevant data:</p>
    <pre>&lt;entry&gt;
  &lt;gsx:hours&gt;1&lt;/gsx:hours&gt;
  &lt;gsx:ipm&gt;1&lt;/gsx:ipm&gt;
  &lt;gsx:items&gt;60&lt;/gsx:items&gt;
  &lt;gsx:name&gt;Elizabeth Bennet&lt;/gsx:name&gt;
&lt;/entry&gt;</pre>
    <p>Then determine the appropriate URL to send the entry to, known as the <code>POST</code> URL. You can find the <code>POST</code> URL in the  list feed's <code>&lt;link&gt;</code> element that has <code>rel=&quot;http://schemas.google.com/g/2005#post&quot;.</code></p>
    <p>Next, do any necessary authentication, and create an Authorization header for a new <code>POST</code> request as described in the authentication sections of this document.</p>
    <p>In the body of the <code>POST</code> request, place the Atom <code>&lt;entry&gt;</code> element you created above, using the <code>application/atom+xml</code> content type.</p>
    <p>Now send the request to the <code>POST</code> URL:</p>
    <pre>POST http://spreadsheets.google.com/feeds/list/<i>key</i>/<i>worksheetId</i>/private/full</pre>
    <p>Spreadsheets inserts the new row immediately after the last row that appears in the list-based feed, which is to say immediately before the first entirely blank row.</p>
    <h2><a name="updateRow" id="updateRow">Edit a row</a></h2>
    <p>To change the contents of a row, begin by getting the desired row from the list feed. Send a <code>PUT</code> request with the desired entry contents to the URL provided in an edit link. The edit URL is highlighted in the XML below.</p>
    <pre>&lt;entry&gt;
  &lt;id&gt;http://spreadsheets.google.com/feeds/list/key/od6/private/full/cokwr&lt;/id&gt;
  &lt;updated&gt;2006-11-17T18:23:45.173Z&lt;/updated&gt;
  &lt;category scheme=&quot;http://schemas.google.com/spreadsheets/2006&quot;
    term=&quot;http://schemas.google.com/spreadsheets/2006#list&quot;/&gt;
  &lt;title type=&quot;text&quot;&gt;Bingley&lt;/title&gt;
  &lt;content type=&quot;text&quot;&gt;Hours: 10, Items: 2, IPM: 0.0033&lt;/content&gt;
  &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/list/key/od6/private/full/cokwr&quot;/&gt;
  &lt;link rel=&quot;edit&quot; type=&quot;application/atom+xml&quot;
    href=&quot;<b>http://spreadsheets.google.com/feeds/list/key/od6/private/full/cokwr/2ehkc2oh7d</b>&quot;/&gt;
  &lt;gsx:name&gt;Bingley&lt;/gsx:name&gt;
  &lt;gsx:hours&gt;10&lt;/gsx:hours&gt;
  &lt;gsx:items&gt;2&lt;/gsx:items&gt;
  &lt;gsx:ipm&gt;0.0033&lt;/gsx:ipm&gt;
&lt;/entry&gt;</pre>
    <h2><a name="deleteRow" id="deleteRow">Remove a row</a></h2>
    <p>To delete a row, perform a <code>DELETE</code> request on the edit URL after obtaining it as described above.</p>
    <p class="note"><strong>Note</strong>: If you delete a row, that row is completely removed from the worksheet.</p>
    <h1><a name="cellsFeedExample" id="cellsFeedExample">Interacting with cell-based feeds</a></h1>
    <p>In a cell-based feed,  each entry represents a single cell.</p>
    <p>Note that it isn't recommended to interact with both a cell-based feed and a list-based feed for the same worksheet at the same time.</p>
    <h2><a name="cellFeeds" id="cellFeeds">Get a cell-based feed</a></h2>
    <p>To determine the URL of a cell-based feed for a given worksheet, get the <code>worksheets</code> metafeed and examine   the <code>&lt;link&gt;</code> element in which <code>rel</code> is <code>http://schemas.google.com/spreadsheets/2006#cellsfeed</code>. The <code>href</code> value in that element is the cell feed's URI.</p>
    <p>To retrieve a  cell-based feed, send the following <code>GET</code> request, using the cell feed's URI and an appropriate authentication token:</p>
    <pre>GET http://spreadsheets.google.com/feeds/cells/<i>key</i>/<i>worksheetId</i>/private/full</pre>
    <p>Google Spreadsheets returns  an Atom feed resembling the following:</p>
    <pre>&lt;feed xmlns=&quot;http://www.w3.org/2005/Atom&quot;
    xmlns:openSearch=&quot;http://a9.com/-/spec/opensearchrss/1.0/&quot;
    xmlns:gs=&quot;http://schemas.google.com/spreadsheets/2006&quot;&gt;
  &lt;id&gt;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full&lt;/id&gt;
  &lt;updated&gt;2006-11-17T18:27:32.543Z&lt;/updated&gt;
  &lt;title type=&quot;text&quot;&gt;Sheet1&lt;/title&gt;
  &lt;link rel=&quot;alternate&quot; type=&quot;text/html&quot;
    href=&quot;http://spreadsheets.google.com/ccc?key=<i>key</i>&quot;/&gt;
  &lt;link rel=&quot;http://schemas.google.com/g/2005#feed&quot; type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full&quot;/&gt;
  &lt;link rel=&quot;http://schemas.google.com/g/2005#post&quot; type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full&quot;/&gt;
  &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
    href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full&quot;/&gt;
  &lt;author&gt;
    &lt;name&gt;Fitzwilliam Darcy&lt;/name&gt;
    &lt;email&gt;fitz@gmail.com&lt;/email&gt;
  &lt;/author&gt;
  &lt;openSearch:startIndex&gt;1&lt;/openSearch:startIndex&gt;
  &lt;openSearch:itemsPerPage&gt;36&lt;/openSearch:itemsPerPage&gt;
  &lt;gs:rowCount&gt;100&lt;/gs:rowCount&gt;
  &lt;gs:colCount&gt;20&lt;/gs:colCount&gt;
  &lt;entry&gt;
    &lt;id&gt;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R1C1&lt;/id&gt;
    &lt;updated&gt;2006-11-17T18:27:32.543Z&lt;/updated&gt;
    &lt;category scheme=&quot;http://schemas.google.com/spreadsheets/2006&quot;
      term=&quot;http://schemas.google.com/spreadsheets/2006#cell&quot;/&gt;
    &lt;title type=&quot;text&quot;&gt;A1&lt;/title&gt;
    &lt;content type=&quot;text&quot;&gt;Name&lt;/content&gt;
    &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R1C1&quot;/&gt;
    &lt;link rel=&quot;edit&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R1C1/bgvjf&quot;/&gt;
    &lt;gs:cell row=&quot;1&quot; col=&quot;1&quot; inputValue=&quot;Name&quot;&gt;Name&lt;/gs:cell&gt;
  &lt;/entry&gt;
  &lt;entry&gt;
    &lt;id&gt;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R1C2&lt;/id&gt;
    &lt;updated&gt;2006-11-17T18:27:32.543Z&lt;/updated&gt;
    &lt;category scheme=&quot;http://schemas.google.com/spreadsheets/2006&quot;
      term=&quot;http://schemas.google.com/spreadsheets/2006#cell&quot;/&gt;
    &lt;title type=&quot;text&quot;&gt;B1&lt;/title&gt;
    &lt;content type=&quot;text&quot;&gt;Hours&lt;/content&gt;
    &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R1C2&quot;/&gt;
    &lt;link rel=&quot;edit&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R1C2/1pn567&quot;/&gt;
    &lt;gs:cell row=&quot;1&quot; col=&quot;2&quot; inputValue=&quot;Hours&quot;&gt;Hours&lt;/gs:cell&gt;
  &lt;/entry&gt;

  ...

  &lt;entry&gt;
    &lt;id&gt;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R9C4&lt;/id&gt;
    &lt;updated&gt;2006-11-17T18:27:32.543Z&lt;/updated&gt;
    &lt;category scheme=&quot;http://schemas.google.com/spreadsheets/2006&quot;
      term=&quot;http://schemas.google.com/spreadsheets/2006#cell&quot;/&gt;
    &lt;title type=&quot;text&quot;&gt;D9&lt;/title&gt;
    &lt;content type=&quot;text&quot;&gt;5&lt;/content&gt;
    &lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R9C4&quot;/&gt;
    &lt;link rel=&quot;edit&quot; type=&quot;application/atom+xml&quot;
      href=&quot;http://spreadsheets.google.com/feeds/cells/<i>key</i>/od6/private/full/R9C4/srevc&quot;/&gt;
    &lt;gs:cell row=&quot;9&quot; col=&quot;4&quot; inputValue=&quot;=FLOOR(R[0]C[-1]/(R[0]C[-2]*60),.0001)&quot;
      numericValue=&quot;5.0&quot;&gt;5&lt;/gs:cell&gt;
  &lt;/entry&gt;
&lt;/feed&gt;</pre>
    <h2><a name="cellsQueryExample" id="cellsQueryExample">Send a cell range query</a></h2>
    <p>Suppose you want the employees to see how everyone is doing, but you do not want to post the employee names. You can request a cell feed containing only the IPM column:</p>
    <pre>GET http://spreadsheets.google.com/feeds/cells/<i>key</i>/<i>worksheetId</i>/private/full?min-row=2&amp;min-col=4&amp;max-col=4</pre>
    <p>That requests all the data in column 4, which in our example is the IPM column, starting with row 2 (because in our example, row 1 contains the column names).</p>
    <p>The request explicitly specifies <code>max-col</code> in case more columns are added after column 4. Note that if any columns are inserted before column 4, the numbering here will no longer be accurate.</p>
    <p>For further information about the cell feed, see the <a href="reference.html#cells_Feed">Cell-based feed</a> reference section.</p>
    <h2><a name="updateCell" id="updateCell">Change contents of a cell</a></h2>
    <p>Suppose you want to find out the total hours that the employees of Groceries R Us have worked. You can create a formula for calculating that value, and then add the formula to a cell in the worksheet using a Google data <code>PUT</code> request.</p>
    <p class="note"><strong>Note</strong>: Use <code>PUT</code> change the data in a cell, even if it is empty; the use of <code>POST</code> on empty cells is no longer recommended. To clear a cell, send an entry with an empty content element in your <code>PUT</code> request instead of using <code>DELETE</code>.</p>
    <p>To add data to the worksheet, start by creating an <code>&lt;entry&gt;</code> element containing the relevant data, which in this case is a formula:</p>
    <pre>
&lt;entry&gt;
  &lt;gs:cell row=&quot;11&quot; col=&quot;5&quot; inputValue=&quot;=SUM(r2c2:r2c10)&quot; /&gt;
&lt;/entry&gt;</pre>
    <p>Find the edit URL for the desired cell by performing a <code>GET</code> request. The edit URL is in the href attribute of a &lt;link&gt; element which has a rel attribute set to "edit". </p>
    <p>Next, do any necessary authentication, and create an Authorization header for a new <code>PUT</code> request as described in the authentication sections of this document.</p>
    <p>In the body of the <code>PUT</code> request, place the Atom <code>&lt;entry&gt;</code> element you created above, using the <code>application/atom+xml</code> content type.</p>
    <p>Now send the <code>PUT</code> request to the appropriate Spreadsheets edit URL:</p>
    <pre>PUT http://spreadsheets.google.com/feeds/cells/<i>key</i>/<i>worksheetId</i>/private/full/<i>cell</i>/<i>version</i></pre>
    <p>The new data is placed in the specified  cell in the worksheet. If the specified cell contains data already, it will be overwritten.</p>
    <p class="backtotop"><a href="#top">Back to top</a></p>
  </div>
  <!-- ########## END PAGE CONTENT ########## -->
</div>
<!-- end wrapper -->
<!-- ########## PAGE FOOTER ########## -->
<div id="footer">
  <div id="footerlogo"><img src="http://www.google.com/images/art.gif" alt="" /></div>
  <div id="copyright">
    <p>&copy; Google Inc. 2007 - <a href="http://www.google.com/privacy.html">Privacy Policy</a> - <a href="http://www.google.com/terms_of_service.html">Terms and Conditions</a> - <a href="http://www.google.com/about.html">About Google</a></p>
  </div>
  <!-- end copyright -->
</div>
<!-- ########## END PAGE FOOTER ########## -->
<p id="date">Last modified:
<script type="text/javascript">
  <!--
  var lm = new Date(document.lastModified);
  document.write(lm.toDateString());
  //-->
</script>
</p>
</body>
</html>
