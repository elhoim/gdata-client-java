<html>
<head>
<title>Static Demo of SAML-based SSO for Google Apps</title><link rel=stylesheet href=http://www.google.com/google.css>
<style>
body,td,font,a{font-family:arial,sans-serif}
p{font-family:arial,sans-serif;padding-left:15px}
table {margin-left:4px}
td {font-family:arial,sans-serif;font-size:83%}
.i { margin-left: 1em; margin-right: 2em; }
pre{font-family:arial,sans-serif; font-size:100%;padding:0px 25px }
pre.box {background:#eee;border:1px solid #bbb;color:#000;font-family:Courier,monospace;font-size:110%;margin:1em 0 0 25px;padding:15px 5px 15px 10px;text-align:left;overflow:auto}
pre.codesample {font-family:monospace;font-size:110%}
table.bt {width:100%}
td.padbold {font-size:100%;vertical-align:top;font-weight:bold;padding:6px;}
td.padplain {font-size:100%;vertical-align:middle;padding:6px;}
td.padboldst {font-size:100%;vertical-align:top;font-weight:bold;padding:6px;}
td.padplainst {font-size:100%;vertical-align:middle;padding:6px;}
td.t {font-size:12px;}
th.t {font-size:12px;}
a:link{color:#00c}
a:visited{color:#551a8b}
a:active{color:#f00}
a.code {font-family:monospace;font-size:110%}
.topnav {line-height:130%}
.indent {line-height:130%; margin-left:.75em;}
.activelink {line-height:130%; margin-left:0; color:#2F63B0; font-weight:bold}
.inactivelink {line-height:130%; margin-left:0;}
.footer {color:#666666; font-size:73%}
.codeSample {font-size:100%;color:#000000;padding:0px 40px}
.codeSampleNP {font-size:100%;color:#000000}
.showvar {font-weight:bold;color:#3366cc}
tr.t1tth {font-family: monospace; font-size:12pt; font-weight:bold; color: #000000;}
.indentsidenav {margin-top:0px;margin-left:10px;margin-bottom:4px;font-size:10pt}
.indentsidenavtoc {margin-top:0px;margin-left:10px;margin-bottom:4px;color:#ddad08;font-weight:bold;font-size:10pt}
.sidenavnolink {margin-top:15px;margin-bottom:4px;font-weight:bold;font-size:10pt}
.sidenavlink {margin-top:15px;margin-bottom:4px;font-size:10pt}
.l1 {vertical-align:middle;padding:4px;width:100%;background:#e5ecf9;font-size:120%;border-top:1px solid #3a7bcb;color:#000;font-weight:bold}
.l2 {vertical-align:middle;padding:4px;width:100%;background:#e5ecf9;font-size:105%;border-bottom:1px solid #3a7bcb;color:#000;font-weight:bold}
.l3 {width:100%;font-size:95%;padding:4px;background:#fff;border-bottom:1px solid #3a7bcb;font-weight:bold}
th.reportl {vertical-align:middle;text-align:left;width:20%;padding:8px 10px;background:#ddf8cc;color:#000;font-weight:bold;font-size:95%}
th.reportr {vertical-align:middle;text-align:center;width:80%;padding:8px 10px;background:#ddf8cc;color:#000;font-weight:bold;font-size:95%}
td.reportl {vertical-align:top;width:20%;padding:8px 10px;background:#ddf8cc;color:#00723d;font-weight:bold;font-size:83%}
td.reportr {vertical-align:top;width:80%;padding:8px 10px;font-size:83%}
th.left {text-align:left;background:#E5ECF9;font-size:83%;padding:4px 10px 4px 4px}
th.middle {text-align:center;background:#E5ECF9;font-size:83%;padding:4px 10px}
th.right {text-align:center;background:#E5ECF9;font-size:83%;padding:4px 10px}
td.left {padding:4px;vertical-align:top;font-size:83%;font-weight:bold}
td.middle {font-size:83%;font-weight:bold;color:#505050;padding:4px 6px;vertical-align:top}
td.right {padding:4px;font-size:83%;vertical-align:top}
th.attrheader {padding:4px 6px;font-size:83%;font-weight:bold;vertical-align:middle;text-align:center;background:#E5ECF9}
th.attrheaderl {text-align:left;padding:4px 6px;font-size:95%;font-weight:bold;vertical-align:middle;background:#E5ECF9}
td.attrname {padding:4px;font-size:83%;font-weight:bold;vertical-align:top;text-align:left}
td.attrtype {padding:4px;font-size:83%;vertical-align:top;text-align:left}
td.tagname {width:20%;padding:4px;font-size:83%;font-weight:bold;vertical-align:top;text-align:left}
td.tagtype {width:80%;padding:4px;font-size:83%;vertical-align:top;text-align:left}
.l4 {width:100%;background:#fff;border-bottom:1px solid #3a7bcb;font-size:100%;font-weight:bold}

#pagecontent{
  padding-bottom:5em;
  border-left:thin dotted #bbb ;
  margin:0 10px 0 170px;
  padding-left:15px;
}

#header {
  position: relative;
  margin:0;
  height:60px;
  padding-top: 12px;
}

#wrapper{
  width:100%;
}

#logo{  /* in header */
  float:left;
  width: 175px;
  top:0;
  left:0;
  padding:0;
  margin:0;
  position:absolute;
}
  
#logo img{border:none;}
  
#doc_title{  /* in header */
  font-size:135%;
  font-weight:bold;
  background-color: #e5ecf9;
  border-color: #3a7bcb; 
  border-top: 1px solid;
  margin:0 0 0 170px;
  padding:.1em 0 .1em 3px;
}

#sidenav {
  float:left;
  width:160px;
  margin:0 0 0 3px;
  background:#fff;
  padding:0;
  left:0;
}
#sidenav ul{
  padding:0;
  margin:0;
  }
  
#sidenav ul li ul, #sidenav ul li ul li ul{
  padding:0;
  margin:0 0 0 .6em;
}
  
#sidenav ul li{
  list-style:none;
  padding:0;
  margin:.4em 0 0 0;
}
  
#sidenav ul li ul li{
  list-style:none;
  padding:0;
  margin:.4em 0 0 0;
}
  
#sidenav ul li ul li ul li{
  list-style:none;
  padding:1px;
  margin:.4em 0 0 0;
}
  
#sidenav p {
  margin: 0 .3em 0 0;
  padding:1em 0 0 0;
}
    
#sidenav ul li a, #sidenav ul ul li a, #sidenav ul ul ul li a{
  color: #0000cc;
  display:block;
  width:92%;
  padding:0;
}
  
#sidenav ul li a:hover{
  color: #0000cc;
}
    
#sidenav h1{
  font-weight:bold;
  font-size:100%;
  color:#000;
  position:relative;
  background-color:#fff;
  border:none;
  margin:1em 0 0 0;
  padding:0 2px 0 2px;
  width:100%;
  left:-4px;
}
  
.other{  /* little box for side nav */
  border-top:thin dotted #bbb;
  border-bottom:thin dotted #bbb;
  margin:3em 0 3em 0;
  padding: 0 0 10px 0;
}
    
.line{  /* dotted line for division */
  border-top:thin dotted #bbb;
  margin:1em 0 0 0;
  padding:0;
  height:5px;
}
  @media screen {
    body {
      font-family: arial, sans-serif;
      font-size: 83%;
    }
    
    .dontprint {
        padding:0px;
        margin:0px;
    }

    .leftcontent {
      float:left;
      width:175px;
      background:#fff;
    }
    
    .topimage {
      margin-left:13px;
      margin-top:0px;
      padding:0px;
    }
    
    .footerimage {
      margin-left:15px;
      margin-top:20px;
      padding:0px;
    }
    
    .toc { 
      color: #ddad08; 
      font-weight:bold;
    }
    
    .rightcontent {
      background:#fff;
      margin-left: 179px;
      margin-right:10px
    }

    .content {
    }

    .title {
    background-color: #FEFADE;
    border-top:1px solid #ddad08;
    font-weight:bold;
    font-size:120%;
    text-align:left;
    margin-left:0;
    }
  }
  @media print {
	          
    .dontprint {
        padding:0px;
        margin:0px;
        display:none;
    }

    .leftcontent {
        display: none;
        float:left;
        clear:right;
        width:100%;
    }

    .topimage {
        margin-left:13px;
        margin-top:0px;
        padding:0px;
    }

    .rightcontent {
        margin-left: 10px;
    }

    .toc {
        list-style-type: none;
        margin: 0px;
        padding: 0px;
    }

    .toc1 {
    }

    .toc2 {
        padding-left: 25pt;
    }

    .toc3 {
        padding-left: 50pt;
    }

    .title {
        display:none;
        background-color: #FEFADE; 
        border-top:1px solid #ddad08;
        font-weight:bold; 
        font-size:120%;
        text-align:left;
        margin-left:0;
    }

    .topimage {
        margin-left:13px;
        margin-top:0px;
        padding:0px;
    }

    body {
        font-family: arial, sans-serif;
        font-size: 83%;
    }

    .backtotop {
        display:none;
    }

    #sidenav {
        visibility:hidden;
	position:absolute;
    }
    #pagecontent {
        float:left;
	position:relative;
	top:0;
	left:-175px;
	width:100%;
    }
    #doc_title {
        border-bottom:1px solid;
	padding-bottom:2px;
    }
    pre { /* don't print scrollbars---display overflow text */
        overflow:visible;
    }
  }
</style>
<script language="JavaScript">
<!--
  function show_when_checked(cbox,divid,defaultid) {
    document.getElementById(divid).style.display=cbox.checked?"inline":"none";
    document.getElementById(defaultid).style.display=cbox.checked?"none":"inline";
  }
  var flag = new Array();
  function change(div, divid, defaultid) {
    var par = new getObj(div);
    if (flag[div]) {
      par.obj.innerHTML = "expand";
      flag[div] = 0;
    } else {
      par.obj.innerHTML = "collapse";
      flag[div] = 1;
    }
    document.getElementById(divid).style.display=flag[div]?"inline":"none";
    document.getElementById(defaultid).style.display=flag[div]?"none":"inline";
    return false;
  }

  function getObj(name) {
    var o = 'this.obj = document.';
    var s = 'this.style = document.';
    if (document.getElementById) {
      eval(o + 'getElementById(name);');
      eval(s + 'getElementById(name).style;');
    } else if (document.all) {
      eval(o + 'all[name];');
      eval(s + 'all[name].style;');
    } else if (document.layers) {
      eval(o + 'layers[name];');
      eval(s + 'layers[name];');
    }
  }



//-->
</script>
<style>
.adslotbullet {list-style-image:url(http://www.corp.google.com/~acook/gfp/mocks/v22/images/adSlot.gif);}
.placementbullet {list-style-image:url(http://www.corp.google.com/~acook/gfp/mocks/v22/images/placement.gif);}
.adproductbullet {list-style-image:url(http://www.corp.google.com/~acook/gfp/mocks/v22/images/adProduct.gif);}
</style>
<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="../../css/ie7only.css" />
  <link rel="stylesheet" type="text/css" href="../apps_ie7_only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="../../css/ie6only.css" />
  <link rel="stylesheet" type="text/css" href="../apps_ie6_only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../../css/ieonly.css" />
<![endif]-->
</head>

<body><a name="top"></a>
<div id="header">
  <div id="logo"><a href="http://code.google.com/"><img src="http://code.google.com/images/code_sm.png" border="0" alt="Return to Google Code homepage" /></a></div>
  <h1 id="doc_title">Static Demo of SAML-based SSO for Google Apps</h1>
</div>

<div class="wrapper">

  <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
  _uacct = "UA-18071-1";
  urchinTracker();
</script>

<div id="sidenav">
<ul>
  <li>
    <h1><a href="saml_reference_implementation.html">SAML SSO Reference</a></h1>
    <ul>
      <li><a href="saml_reference_implementation.html#Overview">Overview</a></li>
      <li><a href="saml_reference_implementation.html#Workflow">Workflow</a></li>
      <li><a href="saml_reference_implementation.html#Tools">Reference Tools</a></li>
    </ul>
  </li>
  <li>
    <h1>Static Demo</h1>
  </li>
  <li>
    <h1><a href="saml_reference_implementation_web.html">Web-based Reference Implementation</a></h1>
    <ul>
      <li><a href="saml_reference_implementation_web.html#samlReferenceImplementationWebUnderstandingCode">Understanding the SAML Reference Code</a></li>
      <li><a href="saml_reference_implementation_web.html#samlReferenceImplementationWebSetup">Creating a SAML-based SSO Service</a>
<ul>
      <li><a href="saml_reference_implementation_web.html#samlReferenceImplementationWebSetupInstallCode">Stage I: Installing the Code</a></li>
      <li><a href="saml_reference_implementation_web.html#samlReferenceImplementationWebSetupRouteRequests">Stage II: Send SAML Requests to your Application</a></li>
      <li><a href="saml_reference_implementation_web.html#samlReferenceImplementationWebSetupChangeDomain">Stage III: Log Users into your Domain</a></li>
</ul>
</li>
    </ul>
  </li>
  <li>
    <h1>Additional Resources</h1>
    <ul>
      <li><a href="http://www.projectliberty.org/liberty_interoperable/interoperable_products/saml_2_0_test_procedure_v1_0_interoperable_product_table">SAML v2.0 Compliant Products</a></li>
      <li><a href="../index.html">Google Apps APIs Home</a></li>
      <li><a href="../gdata_provisioning_api_v2.0_reference.html">Provisioning API</a></li>
      <li><a href="../libraries_and_samples.html">Client Libraries and Sample Code</a></li>
      <li><a href="http://code.google.com/support/bin/topic.py?topic=11279">Frequently Asked Questions</a></li>
    </ul>
  </li>
</ul>
</div>

<div id="pagecontent">


<p>This document describes the static demo of a SAML-based single sign-on (SSO) service that logs users in to Google Apps. This demo simulates the transactions that Google and a partner company would conduct to log a user into a Google Apps application, such as Gmail. The static demo demonstrates the process of logging a user with the username <i>demouser</i> into the domain <i>psosamldemo.net</i>. In the demo, Gmail represents a service that Google is hosting for the <i>psosamldemo.net</i> domain.</p>

<p>The static demo can be found <a href="./saml_static_demo/saml_demo.html">here</a>.</p>

<a name=samlReferenceImplementationStaticLayout></a><p><div class="l2">Understanding the Static Demo</div></p>

</p>
<p>The static demo displays the steps of the SAML workflow process in three windows. In addition, after you complete step 6 in the demo, a new window launches to execute the final two steps in the process.</p>

<ul>

<li>
<p>The <b>Pre-Transaction Details</b> window appears at the top of the page and contains information about the precursors to the SAML authentication process. This window displays the actions that a partner needs to take to set up the SSO service as well as the user's attempt to reach the Google-hosted service.</p>

<ol start="0">

<li>
<p>Setup operations represent the partner's efforts to establish an SSO service. These operations include setting the URL for the partner's SSO service. (Please note that for the static demo, the partner service does not actually exist. Instead, the static demo assumes that the user is successfully authenticated and generates a SAML response indicating that authentication was successful.</p>
<p>Setup operations also include the partner obtaining public and private RSA or DSA keys that will be used to encode the SAML response from the partner service to Google. For the static demo, the public and private keys are read from files included in the SAML reference package. To implement your own SAML-based SSO service, you will need to create your own RSA or DSA keys and then register the public key with Google. Google accepts either the DER-encoded public key or an X509 certificate containing a public key.</p>

</li>

<li>
<p>Step 1 displays the user's attempt to access a Google hosted service. The static demo assumes the user is trying to access a hosted Gmail account for the user <b>demouser@psosamldemo.net</b>.</p>
</li>

</ol>

<p>The screenshot below displays the <b>Pre-Transaction Details</b> window.</p>
<p><img src="saml_pre_transaction_window.gif" border="0"/></p>
</li>

<li>
<p>The <b>GOOGLE - Service Provider</b> window appears on the left side of the page below the <b>Pre-Transaction Details</b> window. This window displays actions that Google takes in the user authentication process.</p>
<ol start="2">
<li>
<p>In step 2, Google generates a SAML authentication request (AuthnRequest). By clicking the button, you instruct the static demo to display the SAML request that Google would submit to the partner's SSO service. Click the <b>Generate AuthnRequest</b> button to complete step 2.</p>
</li>
<li>
<p>In step 3, a window appears that displays the generated SAML request, allowing you to review the generated XML. A second window displays the URL to which the SAML request will be submitted. Click the <b>Submit AuthnRequest</b> button to complete step 2.</p>
</li>
</ol>
<p>The screenshot below displays the <b>GOOGLE - Service Provider</b> window.</p>
<p><img src="saml_service_provider_window.gif" border="0"/></p>
</li>

<li>
<p>The <b>PARTNER - Identity Provider</b> window appears on the right hand side of the page below the <b>Pre-Transaction Details</b> window. This window displays actions that the partner executes in the user authentication process.</p>
<ol start="4">
<li>
<p>In step 4, the partner parses and decodes the SAML request. The partner then proceeds to authenticate the user. The static demo does not actually authenticate a user. Instead, the demo parses the request and then behaves as though the user were successfully authenticated.</p>
</li>
<li>
<p>In step 5, the partner generates a SAML response. Click the <b>Generate SAML Response</b> button to complete step 5.</p>
</li>
<li>
<p>Step 6 displays the generated SAML response, which is similar to the XML that your SSO service will need to return to Google's ACS. Click the <b>Submit SAML Response</b> button to complete this step.</p>
</li>
</ol>
<p>The screenshot below displays the <b>PARTNER - Identity Provider</b> window.</p>
<p><img src="saml_identity_provider_window.gif" border="0"/></p>
</li>

<li>
<p><b>Additional steps</b> - By clicking the <b>Submit SAML Response</b> button, you will launch a new window that will display the <b>demouser@psosamldemo.net</b> Gmail account.</p>

<ol start="7">
<li>
<p>The demo will actually submit the XML request to Google, and Google will validate the SAML response using the public key specified in the setup operations.</p>
</li>
<li>
<p>Google will then log you in to Gmail and redirect you to the <i>demouser@psosamldemo.net</i> Gmail account.</p>
</li>
</ol>
<p>The screenshot below displays the hosted Gmail account.</p>
<p><img src="saml_logged_in.gif" border="0"/></p>

</li>

</ul>

<!--
<p>The static reference implementation is comprised of four files.</p>

<ul>
<li>
<p>The <b>saml_demo.html</b> file displays the URL for the SSO service. </p>
</li>
<li>
<p>The <b>service_provider.html</b> file displays a button that generates the SAML authentication request (AuthnRequest). After you click this button, the window will update to display the XML generated for the SAML request as well as the URL to which the encoded request will be submitted. Finally, it will display a button to submit the authentication request. Clicking this button will submit the request to the partner's SSO service, which is specified in the </p>
</li>
<li>
<p>The <b>identity_provider.html</b> file displays </p>
</li>
<li>
<p>The <b>identity_provider_invalid.html</b> file </p>
</li>
</ul>
-->

<hr>
<center><font size="-1">&copy; Google Inc. 2007. All Rights Reserved.</font></center>
</div></div></div></body>
</html>
