<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link href="style.css" type="text/css" rel="stylesheet"/>
</head>
<script language="JavaScript">
  function show_samlResponse(show) {
    if (show == 'yes')
      samlResponseDisplay.style.display="inline";
    else
      samlResponseDisplay.style.display="none";
  }
</script>
<body>
  <h1>PARTNER - Identity Provider</h1>
  <p><div style="padding:6px 0px;border-top:solid 1px #3366cc;border-bottom:solid 1px #3366cc"><b>Step 4: Partner Handles SAML Request, Authenticates User</b></div></p>
  <p>The following values have been parsed from the SAML request:</p>
  <p><ul>
    <li><b>Issue Instant</b> - 2006-05-02T08:49:40Z</li>
    <li><b>Provider Name</b> - google.com</li>
    <li><b>ACS URL</b> - http://www.google.com/a/psosamldemo.net/acs</li>
  </ul></p>
  <p><b>Note:</b> These are all values that you will receive from the 
    service provider in a SAML transaction.</p>
  <p><b>User Login Details</b></p> 
  <p>During this step, you also authenticate the user. The demo logs a user
     into the account <b>demouser@psosamldemo.net</b>.</p>
  <blockquote><p>Username: demouser@psosamldemo.net
  <p>Password: ******
  </blockquote>

  <p><div style="padding:6px 0px;border-top:solid 1px #3366cc;border-bottom:solid 1px #3366cc"><b>Step 5: Partner Generates SAML Response</b></div></p>
  <p>In this step, you can click the <b>Generate SAML Response</b> button, 
     prompting the demo to display a SAML response indicating that the user 
     (demouser@psosamldemo.net) is authorized to reach the Gmail service.</p>
  <p><center>
  <input type="button" value="Generate SAML Response" onclick="javascript: show_samlResponse('yes')">
  </center>
  <form name="IdentityProviderForm">	
  <p><div id="samlResponseDisplay" style="display: none">
  <p><b> Generated and Signed Response XML </b>
  <p><div class="codediv">
		
  &lt;?xml version="1.0" encoding="UTF-8"?&gt; <br>
  &lt;samlp:Response <br>
  &nbsp;	&nbsp;		xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" <br>
	&nbsp;	&nbsp;		xmlns="urn:oasis:names:tc:SAML:2.0:assertion" <br>
	&nbsp;	&nbsp;		xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" <br>
	&nbsp;	&nbsp;		ID="hedangifkfodeigidaeijpdnfjkfbnegddealebo" <br>
	&nbsp;	&nbsp;		IssueInstant="2006-08-17T10:05:29Z" <br>
	&nbsp;	&nbsp;		Version="2.0"&gt; <br>
	&nbsp;	&nbsp;		&lt;Signature xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;SignedInfo&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments" /&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1" /&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;Reference URI=""&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;					&lt;Transforms&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;						&lt;Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" /&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;					&lt;/Transforms&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;					&lt;DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" /&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;					&lt;DigestValue&gt;sJAWNV9VzT+CghjrHsJSXAY9DRk=&lt;/DigestValue&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;/Reference&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;/SignedInfo&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;SignatureValue&gt;X9Fx4pFSOlI2byrLXBw8azq26xxdqeF7w1UfQtcZ5l7HfXfkq9Tp2w==&lt;/SignatureValue&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;KeyInfo&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;KeyValue&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;					&lt;DSAKeyValue&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;						&lt;P&gt;/KaCzo4Syrom78z3EQ5SbbB4sF7ey80etKII864WF64B81uRpH5t9jQTxeEu0ImbzRMqzVDZkVG9xD7nN1kuFw==&lt;/P&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;						&lt;Q&gt;li7dzDacuo67Jg7mtqEm2TRuOMU=&lt;/Q&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;						&lt;G&gt;Z4Rxsnqc9E7pGknFFH2xqaryRPBaQ01khpMdLRQnG541Awtx/XPaF5Bpsy4pNWMOHCBiNU0NogpsQW5QvnlMpA==&lt;/G&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;						&lt;Y&gt;VMoV//Oh7VytBbZVySNmVZevV1bw7vmJwx5hHszeR25bforBFA19nk+3ehg6SgUjWiXn7HsybemjRFs5x4+XFg==&lt;/Y&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;					&lt;/DSAKeyValue&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;/KeyValue&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;/KeyInfo&gt;<br>
	&nbsp;	&nbsp;		&lt;/Signature&gt;<br>
	&nbsp;	&nbsp;		&lt;samlp:Status&gt;<br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /&gt; <br>
	&nbsp;	&nbsp;		&lt;/samlp:Status&gt; <br>
	&nbsp;	&nbsp;		&lt;Assertion ID="dojnoaponicbieffopfdecilinaepodfimmkpjij" <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			IssueInstant="2003-04-17T00:46:02Z" <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			Version="2.0"&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;Issuer&gt;https://www.opensaml.org/IDP &lt;/Issuer&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;Subject&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"&gt; demouser &lt;/NameID&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" /&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;/Subject&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;Conditions NotBefore="2003-04-17T00:46:02Z" NotOnOrAfter="2008-04-17T00:51:02Z"&gt; &lt;/Conditions&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;AuthnStatement AuthnInstant="2006-08-17T10:05:29Z"&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;AuthnContext&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;					&lt;AuthnContextClassRef&gt; urn:oasis:names:tc:SAML:2.0:ac:classes:Password &lt;/AuthnContextClassRef&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;&nbsp;	&nbsp;				&lt;/AuthnContext&gt; <br>
	&nbsp;	&nbsp;&nbsp;	&nbsp;			&lt;/AuthnStatement&gt;<br>
	&nbsp;	&nbsp;		&lt;/Assertion&gt;<br>
		&lt;/samlp:Response&gt; <br>				
		</div>
		<p>
		</form>
	<p>The SAML response contains the following variables:</p>
        <p><ul>
          <li>
	  <p><b>RESPONSE_ID</b> - A 160-bit string containing a set of randomly generated characters. The code calls the <b>Util.createID()</b> method to generate this value.</p>
	  </li>
          <li>
	  <p><b>ISSUE_INSTANT</b> - A timestamp indicating the date and time that the SAML response was generated. The code calls the <b>Util.getDateAndTime()</b> method to generate this value.</p>
	  </li>
          <li>
	  <p><b>ASSERTION_ID</b> - A 160-bit string containing a set of randomly generated characters. The code calls the <b>Util.createID()</b> method to generate this value.</p>
	  </li>
          <li>
	  <p><b>USERNAME_STRING</b> - The username for the authenticated user. Modify the <b>ProcessResponseServlet.login()</b> method to return the correct value.</p>
	  </li>
          <li>
	  <p><b>NOT_BEFORE</b> - A timestamp identifying the date and time before which the SAML response is deemed invalid. The code sets this value to the <b>IssueInstant</b> value from the SAML request.</p>
	  </li>
          <li>
	  <p><b>NOT_ON_OR_AFTER</b> - A timestamp identifying the date and time after which the SAML response is deemed invalid.</p>
	  </li>
          <li>
	  <p><b>AUTHN_INSTANT</b> - A timestamp indicating the date and time that you authenticated the user.</p>
	  </li>
	</ul></p>
		<center>
		<form name="acsForm" action="https://www.google.com/a/psosamldemo.net/acs" method="post" target="_blank">
		<div style="display: none">
			<textarea name="SAMLResponse"><?xml version="1.0" encoding="UTF-8"?><samlp:Response xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" xmlns="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" ID="hedangifkfodeigidaeijpdnfjkfbnegddealebo" IssueInstant="2006-08-17T10:05:29Z" Version="2.0">	<Signature xmlns="http://www.w3.org/2000/09/xmldsig#"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments" /><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1" /><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" /></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" /><DigestValue>sJAWNV9VzT+CghjrHsJSXAY9DRk=</DigestValue></Reference></SignedInfo><SignatureValue>X9Fx4pFSOlI2byrLXBw8azq26xxdqeF7w1UfQtcZ5l7HfXfkq9Tp2w==</SignatureValue><KeyInfo><KeyValue><DSAKeyValue><P>/KaCzo4Syrom78z3EQ5SbbB4sF7ey80etKII864WF64B81uRpH5t9jQTxeEu0ImbzRMqzVDZkVG9xD7nN1kuFw==</P><Q>li7dzDacuo67Jg7mtqEm2TRuOMU=</Q><G>Z4Rxsnqc9E7pGknFFH2xqaryRPBaQ01khpMdLRQnG541Awtx/XPaF5Bpsy4pNWMOHCBiNU0NogpsQW5QvnlMpA==</G><Y>VMoV//Oh7VytBbZVySNmVZevV1bw7vmJwx5hHszeR25bforBFA19nk+3ehg6SgUjWiXn7HsybemjRFs5x4+XFg==</Y></DSAKeyValue></KeyValue></KeyInfo></Signature><samlp:Status>		<samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" />	</samlp:Status>	<Assertion ID="dojnoaponicbieffopfdecilinaepodfimmkpjij" IssueInstant="2003-04-17T00:46:02Z" Version="2.0">		<Issuer>https://www.opensaml.org/IDP		</Issuer>		<Subject>			<NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:emailAddress">				demouser			</NameID>			<SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" />		</Subject>		<Conditions NotBefore="2003-04-17T00:46:02Z" NotOnOrAfter="2008-04-17T00:51:02Z">		</Conditions>		<AuthnStatement AuthnInstant="2006-08-17T10:05:29Z">			<AuthnContext>				<AuthnContextClassRef>					urn:oasis:names:tc:SAML:2.0:ac:classes:Password				</AuthnContextClassRef>			</AuthnContext>		</AuthnStatement>	</Assertion></samlp:Response></textarea>
			<textarea rows=10 cols=80 name="RelayState">http://mail.google.com/a/psosamldemo.net</textarea><p>
		</div>
        <input type="submit" value="Submit SAML Response">
<p><b>Note:</b> By clicking this button, you will submit a form to the ACS URL and log in to the <b>demouser@psosamldemo.net</b> Gmail account.</p>
		</form>		
		</center>
		</div>
	
</body>
</html>
